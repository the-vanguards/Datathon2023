{"cells":[{"cell_type":"markdown","source":["# bookmark"],"metadata":{"id":"SEy03x8UOheM"}},{"cell_type":"code","source":["TIME_COVERSION = 1000 * 60 * 60"],"metadata":{"id":"BsQ1W1ujiJnS","executionInfo":{"status":"ok","timestamp":1686736679694,"user_tz":-120,"elapsed":3,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":1,"outputs":[]},{"cell_type":"code","execution_count":2,"metadata":{"id":"7_25tYPLNuOp","executionInfo":{"status":"ok","timestamp":1686736679695,"user_tz":-120,"elapsed":3,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["RELOAD_PICKLES = False\n","datathon_directory = 'drive/MyDrive/datathon23'\n","pickles_directory = f'{datathon_directory}/temp_pickles/'\n","sql_script_directory = f'{datathon_directory}/sql_scripts/'\n","output_directory = f'{datathon_directory}/outputs/'"]},{"cell_type":"code","execution_count":3,"metadata":{"cellView":"form","id":"Test7oZwN4kB","executionInfo":{"status":"ok","timestamp":1686736679695,"user_tz":-120,"elapsed":3,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["#@title SQL set parameters\n","\n","# sets *your* project id\n","PROJECT_ID = \"acanakoglu\" #@param {type:\"string\"}\n","# sets default dataset for AmsterdamUMCdb\n","DATASET_PROJECT_ID = 'amsterdamumcdb'\n","# #@param {type:\"string\"}\n","DATASET_ID = 'version1_0_2'\n","# #@param {type:\"string\"}\n","LOCATION = 'eu'\n","# #@param {type:\"string\"}\n","\n","config_gbq = {'query':\n","          {'defaultDataset': {\n","              \"datasetId\": DATASET_ID,\n","              \"projectId\": DATASET_PROJECT_ID\n","              },\n","           'Location': LOCATION}\n","           }"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"_u0qJA2JNhuo","executionInfo":{"status":"ok","timestamp":1686736687285,"user_tz":-120,"elapsed":7593,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["from IPython.display import clear_output\n","import pandas as pd\n","import numpy as np\n","from tqdm import tqdm\n","import pickle\n","import re\n","\n","import os\n","from google.colab import auth\n","# get the amsterdamumcdb package from PyPI repository for use in Colab\n","!pip install amsterdamumcdb\n","import amsterdamumcdb as adb\n","\n","clear_output()\n"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"nivTqVQkMqga","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1686736693819,"user_tz":-120,"elapsed":6537,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"154cfcfb-a432-4905-99ef-e48cc06435ff"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n","Authenticated\n","sanity check    f0_\n","0    1\n"]}],"source":["import os\n","\n","from google.colab import drive\n","drive.mount('/content/drive')\n","# all libraries check this environment variable, so set it:\n","os.environ[\"GOOGLE_CLOUD_PROJECT\"] = PROJECT_ID\n","auth.authenticate_user()\n","print('Authenticated')\n","\n","\n","print('sanity check', adb.read_sql(\"SELECT 1\", config_gbq,))"]},{"cell_type":"code","source":["# df_wide = pickle.load(open('/content/drive/MyDrive/datathon23/wide_clean.pickle', 'rb'))\n","# df_wide.head()"],"metadata":{"id":"DsyjCv0RudOa","executionInfo":{"status":"ok","timestamp":1686736693819,"user_tz":-120,"elapsed":16,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":6,"outputs":[]},{"cell_type":"code","source":["# df_wide.describe()"],"metadata":{"id":"qybxaGwSudbY","executionInfo":{"status":"ok","timestamp":1686736693820,"user_tz":-120,"elapsed":16,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":7,"outputs":[]},{"cell_type":"code","execution_count":8,"metadata":{"id":"4bclKJmHMw1o","colab":{"base_uri":"https://localhost:8080/","height":224},"executionInfo":{"status":"ok","timestamp":1686736693820,"user_tz":-120,"elapsed":16,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"e709fa3c-887b-4601-c640-4ce137797f1a"},"outputs":[{"output_type":"stream","name":"stdout","text":["(16593, 7)\n"]},{"output_type":"execute_result","data":{"text/plain":["   admissionid  mechanical_ventilation_bool  mechanical_ventilation_modes  \\\n","0            0                         True  PC ; PS/CPAP; PS/CPAP (trig)   \n","1            1                         True  PS/CPAP; PC ; PS/CPAP (trig)   \n","2            2                         True                           PC    \n","3            3                         True         PS/CPAP; PC (No trig)   \n","4            4                         True             PC ; PS/CPAP; VC    \n","\n","   invasive_bool  non_invasive_bool  endotracheal_tube  tracheostomy  \n","0           True               <NA>               True          <NA>  \n","1           True               <NA>               True          <NA>  \n","2           True               <NA>               True          <NA>  \n","3           True               <NA>               True          <NA>  \n","4           True               <NA>               True          <NA>  "],"text/html":["\n","  <div id=\"df-697d2317-6782-49c5-8db8-48eb2a078dae\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>mechanical_ventilation_bool</th>\n","      <th>mechanical_ventilation_modes</th>\n","      <th>invasive_bool</th>\n","      <th>non_invasive_bool</th>\n","      <th>endotracheal_tube</th>\n","      <th>tracheostomy</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>True</td>\n","      <td>PC ; PS/CPAP; PS/CPAP (trig)</td>\n","      <td>True</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>True</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>True</td>\n","      <td>PS/CPAP; PC ; PS/CPAP (trig)</td>\n","      <td>True</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>True</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>True</td>\n","      <td>PC</td>\n","      <td>True</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>True</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>True</td>\n","      <td>PS/CPAP; PC (No trig)</td>\n","      <td>True</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>True</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>True</td>\n","      <td>PC ; PS/CPAP; VC</td>\n","      <td>True</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>True</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-697d2317-6782-49c5-8db8-48eb2a078dae')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-697d2317-6782-49c5-8db8-48eb2a078dae button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-697d2317-6782-49c5-8db8-48eb2a078dae');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":8}],"source":["pickle_file = f'{pickles_directory}/mech_vent.pickle'\n","if RELOAD_PICKLES or not os.path.isfile(pickle_file):\n","  df_pickle_temp = adb.query(\"lifesupport/mechanical_ventilation.sql\", config_gbq,)\n","  df_pickle_temp = df_pickle_temp.sort_values('admissionid').reset_index(drop=True)\n","  pickle.dump(df_pickle_temp, open(pickle_file, 'wb'))\n","else:\n","  df_pickle_temp = pickle.load(open(pickle_file, 'rb'))\n","\n","df_mech_vent = df_pickle_temp\n","del pickle_file, df_pickle_temp\n","\n","df_mech_vent = df_mech_vent.sort_values('admissionid').reset_index(drop=True)\n","print(df_mech_vent.shape)\n","df_mech_vent.head()"]},{"cell_type":"code","source":["# !head drive/MyDrive/datathon23/dfg.csv"],"metadata":{"id":"fORkeCq77dJL","executionInfo":{"status":"ok","timestamp":1686736693821,"user_tz":-120,"elapsed":10,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":9,"outputs":[]},{"cell_type":"code","execution_count":10,"metadata":{"id":"z-BnYwhQ2FWG","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1686736693821,"user_tz":-120,"elapsed":10,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"7340a84d-23b7-42b6-ce08-79d4cff19e37"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["mechanical_ventilation_bool    16593\n","invasive_bool                  16109\n","non_invasive_bool               1063\n","endotracheal_tube              13632\n","tracheostomy                    1192\n","dtype: int64"]},"metadata":{},"execution_count":10}],"source":["df_mech_vent[[x for x in df_mech_vent if df_mech_vent[x].dtype == 'boolean']].sum()"]},{"cell_type":"code","execution_count":11,"metadata":{"id":"XtwX2Mv9Mq8r","colab":{"base_uri":"https://localhost:8080/","height":358},"executionInfo":{"status":"ok","timestamp":1686736694398,"user_tz":-120,"elapsed":584,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"6ab25879-4023-4b24-c8df-129f6172afc3"},"outputs":[{"output_type":"stream","name":"stdout","text":["(23106, 19)\n"]},{"output_type":"execute_result","data":{"text/plain":["   patientid  admissionid  admissioncount location  urgency  \\\n","0          0            0               1       IC        0   \n","1          1            1               1       IC        0   \n","2          2            2               1       IC        1   \n","3          3            3               1       IC        0   \n","4          4            4               1    IC&MC        0   \n","\n","                                   origin  admittedat admissionyeargroup  \\\n","0                                    None           0          2003-2009   \n","1                                    None           0          2010-2016   \n","2  Eerste Hulp afdeling zelfde ziekenhuis           0          2010-2016   \n","3                                    None           0          2003-2009   \n","4      Verpleegafdeling zelfde ziekenhuis           0          2010-2016   \n","\n","   dischargedat  lengthofstay destination gender agegroup  dateofdeath  \\\n","0     148800000            42          16  Vrouw      80+         <NA>   \n","1      96120000            26          15    Man    60-69         <NA>   \n","2      84240000            23          15    Man    60-69         <NA>   \n","3      84900000            23          14    Man    50-59         <NA>   \n","4     180900000            50          19    Man    70-79         <NA>   \n","\n","  weightgroup  weightsource heightgroup  heightsource        specialty  \n","0       60-69  Anamnestisch     160-169  Anamnestisch  Cardiochirurgie  \n","1       70-79  Anamnestisch     170-179  Anamnestisch  Cardiochirurgie  \n","2       90-99  Anamnestisch     180-189  Anamnestisch  Cardiochirurgie  \n","3       90-99          None     180-189       Gemeten  Cardiochirurgie  \n","4       70-79  Anamnestisch     170-179  Anamnestisch  Cardiochirurgie  "],"text/html":["\n","  <div id=\"df-6ad68f4c-ebb2-4418-b09e-f1d6018a7d8e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>patientid</th>\n","      <th>admissionid</th>\n","      <th>admissioncount</th>\n","      <th>location</th>\n","      <th>urgency</th>\n","      <th>origin</th>\n","      <th>admittedat</th>\n","      <th>admissionyeargroup</th>\n","      <th>dischargedat</th>\n","      <th>lengthofstay</th>\n","      <th>destination</th>\n","      <th>gender</th>\n","      <th>agegroup</th>\n","      <th>dateofdeath</th>\n","      <th>weightgroup</th>\n","      <th>weightsource</th>\n","      <th>heightgroup</th>\n","      <th>heightsource</th>\n","      <th>specialty</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>IC</td>\n","      <td>0</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>2003-2009</td>\n","      <td>148800000</td>\n","      <td>42</td>\n","      <td>16</td>\n","      <td>Vrouw</td>\n","      <td>80+</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>60-69</td>\n","      <td>Anamnestisch</td>\n","      <td>160-169</td>\n","      <td>Anamnestisch</td>\n","      <td>Cardiochirurgie</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>IC</td>\n","      <td>0</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>2010-2016</td>\n","      <td>96120000</td>\n","      <td>26</td>\n","      <td>15</td>\n","      <td>Man</td>\n","      <td>60-69</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>70-79</td>\n","      <td>Anamnestisch</td>\n","      <td>170-179</td>\n","      <td>Anamnestisch</td>\n","      <td>Cardiochirurgie</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>IC</td>\n","      <td>1</td>\n","      <td>Eerste Hulp afdeling zelfde ziekenhuis</td>\n","      <td>0</td>\n","      <td>2010-2016</td>\n","      <td>84240000</td>\n","      <td>23</td>\n","      <td>15</td>\n","      <td>Man</td>\n","      <td>60-69</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>90-99</td>\n","      <td>Anamnestisch</td>\n","      <td>180-189</td>\n","      <td>Anamnestisch</td>\n","      <td>Cardiochirurgie</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>IC</td>\n","      <td>0</td>\n","      <td>None</td>\n","      <td>0</td>\n","      <td>2003-2009</td>\n","      <td>84900000</td>\n","      <td>23</td>\n","      <td>14</td>\n","      <td>Man</td>\n","      <td>50-59</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>90-99</td>\n","      <td>None</td>\n","      <td>180-189</td>\n","      <td>Gemeten</td>\n","      <td>Cardiochirurgie</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>1</td>\n","      <td>IC&amp;MC</td>\n","      <td>0</td>\n","      <td>Verpleegafdeling zelfde ziekenhuis</td>\n","      <td>0</td>\n","      <td>2010-2016</td>\n","      <td>180900000</td>\n","      <td>50</td>\n","      <td>19</td>\n","      <td>Man</td>\n","      <td>70-79</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>70-79</td>\n","      <td>Anamnestisch</td>\n","      <td>170-179</td>\n","      <td>Anamnestisch</td>\n","      <td>Cardiochirurgie</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6ad68f4c-ebb2-4418-b09e-f1d6018a7d8e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-6ad68f4c-ebb2-4418-b09e-f1d6018a7d8e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-6ad68f4c-ebb2-4418-b09e-f1d6018a7d8e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":11}],"source":["pickle_file = f'{datathon_directory}/admission.pkl'\n","df_admissions = pickle.load(open(pickle_file, 'rb')).sort_values('admissionid').reset_index(drop=True)\n","del pickle_file\n","print(df_admissions.shape)\n","df_admissions.head()"]},{"cell_type":"code","execution_count":12,"metadata":{"id":"AJLSbXurKhd4","executionInfo":{"status":"ok","timestamp":1686736694399,"user_tz":-120,"elapsed":4,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["DATE_COLUMNS = {'start', 'stop', 'measuredat', 'registeredat', 'updatedat'}\n","def get_items(sql, pickle_file=None,):\n","  if not pickle_file or RELOAD_PICKLES or not os.path.isfile(pickle_file):\n","    result = adb.read_sql(sql, config_gbq,)\n","\n","    columns = [x for x in result.columns if x in DATE_COLUMNS] # list(set(result.columns).intersection(DATE_COLUMNS))\n","    if 'item' in result.columns:\n","      columns.append('item')\n","    result = result.sort_values(['admissionid'] + columns).reset_index(drop=True)\n","\n","    if pickle_file:\n","      pickle.dump(result, open(pickle_file, 'wb'))\n","  else:\n","    result = pickle.load(open(pickle_file, 'rb'))\n","\n","\n","  result = pd.merge(result, df_admissions[['admissionid', 'admittedat']], how = 'left', on='admissionid')\n","  columns = [x for x in result.columns if x in DATE_COLUMNS] # list(set(result.columns).intersection(DATE_COLUMNS))\n","  # substract the value from the timestamps\n","  result[columns] = result[columns].sub(result['admittedat'],axis=0) /TIME_COVERSION\n","  result = result.drop('admittedat',axis = 1)\n","\n","  print(result.shape, 'corrected columns:', columns)\n","  display(result.head())\n","\n","  return result.copy()"]},{"cell_type":"code","source":["# asd = adb.read_sql(\"SELECT * from numericitems WHERE itemid IN (20081, 6637, 6638, 10442)\", config_gbq)\n","# asd.admissionid.unique().shape\n","\n"],"metadata":{"id":"y5ZZ1QIqaiIQ","executionInfo":{"status":"ok","timestamp":1686736694399,"user_tz":-120,"elapsed":4,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":13,"outputs":[]},{"cell_type":"code","source":["df_map = get_items(\n","    sql = open(f'{sql_script_directory}/map.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/map.pickle',\n",")"],"metadata":{"id":"B-9GWNgrLp4s","colab":{"base_uri":"https://localhost:8080/","height":355},"executionInfo":{"status":"ok","timestamp":1686736698548,"user_tz":-120,"elapsed":4152,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"da410e17-49b9-4d14-85a4-5fef903a9425"},"execution_count":14,"outputs":[{"output_type":"stream","name":"stdout","text":["(2233222, 15) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid           item tag  value  unitid  unit  \\\n","0            0    6642  ABP gemiddeld       68.0     173  mmHg   \n","1            0    6642  ABP gemiddeld       83.0     173  mmHg   \n","2            0    6642  ABP gemiddeld       75.0     173  mmHg   \n","3            0    6642  ABP gemiddeld       70.0     173  mmHg   \n","4            0    6642  ABP gemiddeld       73.0     173  mmHg   \n","\n","                comment  measuredat  registeredat           registeredby  \\\n","0  Opmerking verwijderd         5.7      5.716667  ICV_IC-Verpleegkundig   \n","1  Opmerking verwijderd         6.2      6.583333  ICV_IC-Verpleegkundig   \n","2  Opmerking verwijderd         7.2      7.266667  ICV_IC-Verpleegkundig   \n","3  Opmerking verwijderd         8.2      8.183333  ICV_IC-Verpleegkundig   \n","4  Opmerking verwijderd         9.2          9.25  ICV_IC-Verpleegkundig   \n","\n","   updatedat              updatedby  islabresult  fluidout  \n","0   5.716667  ICV_IC-Verpleegkundig            0      <NA>  \n","1   6.583333  ICV_IC-Verpleegkundig            0      <NA>  \n","2   7.266667  ICV_IC-Verpleegkundig            0      <NA>  \n","3   8.199519  ICV_IC-Verpleegkundig            0      <NA>  \n","4       9.25  ICV_IC-Verpleegkundig            0      <NA>  "],"text/html":["\n","  <div id=\"df-806ccea4-896f-4b49-8c6e-2db583f09dfe\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>tag</th>\n","      <th>value</th>\n","      <th>unitid</th>\n","      <th>unit</th>\n","      <th>comment</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","      <th>fluidout</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6642</td>\n","      <td>ABP gemiddeld</td>\n","      <td></td>\n","      <td>68.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>5.716667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>5.716667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>6642</td>\n","      <td>ABP gemiddeld</td>\n","      <td></td>\n","      <td>83.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>6.583333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.583333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>6642</td>\n","      <td>ABP gemiddeld</td>\n","      <td></td>\n","      <td>75.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>7.2</td>\n","      <td>7.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>6642</td>\n","      <td>ABP gemiddeld</td>\n","      <td></td>\n","      <td>70.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>8.2</td>\n","      <td>8.183333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>8.199519</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>6642</td>\n","      <td>ABP gemiddeld</td>\n","      <td></td>\n","      <td>73.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>9.2</td>\n","      <td>9.25</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>9.25</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-806ccea4-896f-4b49-8c6e-2db583f09dfe')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-806ccea4-896f-4b49-8c6e-2db583f09dfe button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-806ccea4-896f-4b49-8c6e-2db583f09dfe');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"markdown","source":["# bookmark2"],"metadata":{"id":"bYQa-iWgOnZp"}},{"cell_type":"code","source":["df_spo2 = get_items(\n","    sql = open(f'{sql_script_directory}/spo2.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/spo2.pickle',\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":355},"id":"8_gDGZBkPfzh","executionInfo":{"status":"ok","timestamp":1686736701806,"user_tz":-120,"elapsed":3265,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"bd096aee-76a8-4bfb-a26a-d530d4715636"},"execution_count":15,"outputs":[{"output_type":"stream","name":"stdout","text":["(2076750, 15) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid                 item tag  value  unitid  unit  \\\n","0            0    6709  Saturatie (Monitor)       96.0       0  None   \n","1            0    6709  Saturatie (Monitor)      100.0       0  None   \n","2            0    6709  Saturatie (Monitor)      100.0       0  None   \n","3            0    6709  Saturatie (Monitor)      100.0       0  None   \n","4            0    6709  Saturatie (Monitor)       99.0       0  None   \n","\n","                comment  measuredat  registeredat           registeredby  \\\n","0  Opmerking verwijderd         5.7          6.15  ICV_IC-Verpleegkundig   \n","1  Opmerking verwijderd         6.2           7.3  ICV_IC-Verpleegkundig   \n","2  Opmerking verwijderd         7.2           7.3  ICV_IC-Verpleegkundig   \n","3  Opmerking verwijderd         8.2      8.266667  ICV_IC-Verpleegkundig   \n","4  Opmerking verwijderd         9.2     10.366667  ICV_IC-Verpleegkundig   \n","\n","   updatedat              updatedby  islabresult  fluidout  \n","0       6.15  ICV_IC-Verpleegkundig            0      <NA>  \n","1        7.3  ICV_IC-Verpleegkundig            0      <NA>  \n","2        7.3  ICV_IC-Verpleegkundig            0      <NA>  \n","3   8.266667  ICV_IC-Verpleegkundig            0      <NA>  \n","4  10.366667  ICV_IC-Verpleegkundig            0      <NA>  "],"text/html":["\n","  <div id=\"df-df89335f-5fe2-414c-836d-e7379de2ef61\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>tag</th>\n","      <th>value</th>\n","      <th>unitid</th>\n","      <th>unit</th>\n","      <th>comment</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","      <th>fluidout</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6709</td>\n","      <td>Saturatie (Monitor)</td>\n","      <td></td>\n","      <td>96.0</td>\n","      <td>0</td>\n","      <td>None</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>6709</td>\n","      <td>Saturatie (Monitor)</td>\n","      <td></td>\n","      <td>100.0</td>\n","      <td>0</td>\n","      <td>None</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>6709</td>\n","      <td>Saturatie (Monitor)</td>\n","      <td></td>\n","      <td>100.0</td>\n","      <td>0</td>\n","      <td>None</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>7.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>6709</td>\n","      <td>Saturatie (Monitor)</td>\n","      <td></td>\n","      <td>100.0</td>\n","      <td>0</td>\n","      <td>None</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>8.2</td>\n","      <td>8.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>8.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>6709</td>\n","      <td>Saturatie (Monitor)</td>\n","      <td></td>\n","      <td>99.0</td>\n","      <td>0</td>\n","      <td>None</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>9.2</td>\n","      <td>10.366667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>10.366667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-df89335f-5fe2-414c-836d-e7379de2ef61')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-df89335f-5fe2-414c-836d-e7379de2ef61 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-df89335f-5fe2-414c-836d-e7379de2ef61');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_insp_time = get_items(\n","    sql = open(f'{sql_script_directory}/insp_time.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/insp_time.pickle',\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":355},"id":"QlPf8ZME_iCw","executionInfo":{"status":"ok","timestamp":1686736704550,"user_tz":-120,"elapsed":2748,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"911bbe37-43c5-4bfa-b66f-4f68087ea512"},"execution_count":16,"outputs":[{"output_type":"stream","name":"stdout","text":["(1140506, 15) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid                              item tag  value  unitid  \\\n","0            0   12576  Insp. Rise time (Set, sec) nieuw       0.23       3   \n","1            0   12576  Insp. Rise time (Set, sec) nieuw       0.23       3   \n","2            0   12576  Insp. Rise time (Set, sec) nieuw       0.23       3   \n","3            0   12576  Insp. Rise time (Set, sec) nieuw       0.23       3   \n","4            0   12576  Insp. Rise time (Set, sec) nieuw       0.23       3   \n","\n","  unit               comment  measuredat  registeredat           registeredby  \\\n","0  sec  Opmerking verwijderd         5.7          6.15  ICV_IC-Verpleegkundig   \n","1  sec  Opmerking verwijderd         6.2           7.3  ICV_IC-Verpleegkundig   \n","2  sec  Opmerking verwijderd         7.2           7.3  ICV_IC-Verpleegkundig   \n","3  sec  Opmerking verwijderd         8.2      8.266667  ICV_IC-Verpleegkundig   \n","4  sec  Opmerking verwijderd         9.2     10.366667  ICV_IC-Verpleegkundig   \n","\n","   updatedat              updatedby  islabresult  fluidout  \n","0       6.15  ICV_IC-Verpleegkundig            0      <NA>  \n","1        7.3  ICV_IC-Verpleegkundig            0      <NA>  \n","2        7.3  ICV_IC-Verpleegkundig            0      <NA>  \n","3   8.266667  ICV_IC-Verpleegkundig            0      <NA>  \n","4  10.366667  ICV_IC-Verpleegkundig            0      <NA>  "],"text/html":["\n","  <div id=\"df-fdb96b4f-7245-4e37-8397-598e381d4184\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>tag</th>\n","      <th>value</th>\n","      <th>unitid</th>\n","      <th>unit</th>\n","      <th>comment</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","      <th>fluidout</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>12576</td>\n","      <td>Insp. Rise time (Set, sec) nieuw</td>\n","      <td></td>\n","      <td>0.23</td>\n","      <td>3</td>\n","      <td>sec</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>12576</td>\n","      <td>Insp. Rise time (Set, sec) nieuw</td>\n","      <td></td>\n","      <td>0.23</td>\n","      <td>3</td>\n","      <td>sec</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>12576</td>\n","      <td>Insp. Rise time (Set, sec) nieuw</td>\n","      <td></td>\n","      <td>0.23</td>\n","      <td>3</td>\n","      <td>sec</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>7.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>12576</td>\n","      <td>Insp. Rise time (Set, sec) nieuw</td>\n","      <td></td>\n","      <td>0.23</td>\n","      <td>3</td>\n","      <td>sec</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>8.2</td>\n","      <td>8.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>8.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>12576</td>\n","      <td>Insp. Rise time (Set, sec) nieuw</td>\n","      <td></td>\n","      <td>0.23</td>\n","      <td>3</td>\n","      <td>sec</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>9.2</td>\n","      <td>10.366667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>10.366667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-fdb96b4f-7245-4e37-8397-598e381d4184')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-fdb96b4f-7245-4e37-8397-598e381d4184 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-fdb96b4f-7245-4e37-8397-598e381d4184');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_bilirubin = get_items(\n","    sql = open(f'{sql_script_directory}/bilirubin.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/bilirubin.pickle',\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":224},"id":"OFYcevpPCuxI","executionInfo":{"status":"ok","timestamp":1686736704933,"user_tz":-120,"elapsed":386,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"49405ec6-6e15-4985-cb2d-88d5aab61bdd"},"execution_count":17,"outputs":[{"output_type":"stream","name":"stdout","text":["(59106, 7) corrected columns: ['measuredat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  measuredat  itemid                item  value registeredby  \\\n","0            2  -27.016667    9945  Bilirubine (bloed)    7.0      Systeem   \n","1            4    1.833333    9945  Bilirubine (bloed)    8.0      Systeem   \n","2            4        41.8    9945  Bilirubine (bloed)    7.0      Systeem   \n","3            5 -266.016667    9945  Bilirubine (bloed)    3.0      Systeem   \n","4            5    0.933333    9945  Bilirubine (bloed)    5.0      Systeem   \n","\n","   manual_entry  \n","0         False  \n","1         False  \n","2         False  \n","3         False  \n","4         False  "],"text/html":["\n","  <div id=\"df-382b22d0-b593-4183-9255-68073110d150\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>value</th>\n","      <th>registeredby</th>\n","      <th>manual_entry</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2</td>\n","      <td>-27.016667</td>\n","      <td>9945</td>\n","      <td>Bilirubine (bloed)</td>\n","      <td>7.0</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>4</td>\n","      <td>1.833333</td>\n","      <td>9945</td>\n","      <td>Bilirubine (bloed)</td>\n","      <td>8.0</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>4</td>\n","      <td>41.8</td>\n","      <td>9945</td>\n","      <td>Bilirubine (bloed)</td>\n","      <td>7.0</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>5</td>\n","      <td>-266.016667</td>\n","      <td>9945</td>\n","      <td>Bilirubine (bloed)</td>\n","      <td>3.0</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>0.933333</td>\n","      <td>9945</td>\n","      <td>Bilirubine (bloed)</td>\n","      <td>5.0</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-382b22d0-b593-4183-9255-68073110d150')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-382b22d0-b593-4183-9255-68073110d150 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-382b22d0-b593-4183-9255-68073110d150');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_a2_gcs = get_items(\n","    sql = open(f'{sql_script_directory}/a2_gcs.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/a2_gcs.pickle',\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":224},"id":"x0YBRaBEtCuW","executionInfo":{"status":"ok","timestamp":1686736704934,"user_tz":-120,"elapsed":9,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"9b418dc1-29b7-4fb9-b034-35daf49aa4ff"},"execution_count":18,"outputs":[{"output_type":"stream","name":"stdout","text":["(19459, 8) corrected columns: ['measuredat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  measuredat  eyes_score  motor_score  verbal_score  \\\n","0            0   12.216667           4            6             5   \n","1            1   22.866667           4            6             5   \n","2            2   20.933333           4            6             5   \n","3            4  939.816667           4            6             5   \n","4            5  881.383333           4            6             5   \n","\n","          registeredby  gcs_score  priority  \n","0          ICV_Medisch         15         1  \n","1          ICV_Medisch         15         1  \n","2          ICV_Medisch         15         1  \n","3  ICV_Medisch Staflid         15         1  \n","4  ICV_Medisch Staflid         15         1  "],"text/html":["\n","  <div id=\"df-275ba5eb-c081-41a8-a7ae-018acc273c35\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat</th>\n","      <th>eyes_score</th>\n","      <th>motor_score</th>\n","      <th>verbal_score</th>\n","      <th>registeredby</th>\n","      <th>gcs_score</th>\n","      <th>priority</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>12.216667</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>ICV_Medisch</td>\n","      <td>15</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>22.866667</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>ICV_Medisch</td>\n","      <td>15</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>20.933333</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>ICV_Medisch</td>\n","      <td>15</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>939.816667</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>ICV_Medisch Staflid</td>\n","      <td>15</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>881.383333</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>ICV_Medisch Staflid</td>\n","      <td>15</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-275ba5eb-c081-41a8-a7ae-018acc273c35')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-275ba5eb-c081-41a8-a7ae-018acc273c35 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-275ba5eb-c081-41a8-a7ae-018acc273c35');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_a2_wbc = get_items(\n","    sql = open(f'{sql_script_directory}/a2_wbc.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/a2_wbc.pickle',\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":224},"id":"7ishyFHEm_gr","executionInfo":{"status":"ok","timestamp":1686736705326,"user_tz":-120,"elapsed":397,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"bc65a688-cd26-453a-a19a-b8e5af1b8549"},"execution_count":19,"outputs":[{"output_type":"stream","name":"stdout","text":["(197648, 8) corrected columns: ['measuredat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  measuredat    unit  itemid             item  value  \\\n","0            0 -271.666667  10^9/l    9965  Leuco's (bloed)    7.4   \n","1            0      -129.8  10^9/l    9965  Leuco's (bloed)    7.8   \n","2            0        -8.3  10^9/l    9965  Leuco's (bloed)    6.5   \n","3            0         6.1  10^9/l    9965  Leuco's (bloed)   14.6   \n","4            0       36.45  10^9/l    9965  Leuco's (bloed)   13.5   \n","\n","  registeredby  manual_entry  \n","0      Systeem         False  \n","1      Systeem         False  \n","2      Systeem         False  \n","3      Systeem         False  \n","4      Systeem         False  "],"text/html":["\n","  <div id=\"df-7b6035b5-134b-4148-bc1c-5cb61db9e15d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat</th>\n","      <th>unit</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>value</th>\n","      <th>registeredby</th>\n","      <th>manual_entry</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>-271.666667</td>\n","      <td>10^9/l</td>\n","      <td>9965</td>\n","      <td>Leuco's (bloed)</td>\n","      <td>7.4</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>-129.8</td>\n","      <td>10^9/l</td>\n","      <td>9965</td>\n","      <td>Leuco's (bloed)</td>\n","      <td>7.8</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>-8.3</td>\n","      <td>10^9/l</td>\n","      <td>9965</td>\n","      <td>Leuco's (bloed)</td>\n","      <td>6.5</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>6.1</td>\n","      <td>10^9/l</td>\n","      <td>9965</td>\n","      <td>Leuco's (bloed)</td>\n","      <td>14.6</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>36.45</td>\n","      <td>10^9/l</td>\n","      <td>9965</td>\n","      <td>Leuco's (bloed)</td>\n","      <td>13.5</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7b6035b5-134b-4148-bc1c-5cb61db9e15d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-7b6035b5-134b-4148-bc1c-5cb61db9e15d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-7b6035b5-134b-4148-bc1c-5cb61db9e15d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_a2_ht = get_items(\n","    sql = open(f'{sql_script_directory}/a2_ht.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/a2_ht.pickle',\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":224},"id":"Vrf-43PHc82M","executionInfo":{"status":"ok","timestamp":1686736707300,"user_tz":-120,"elapsed":1977,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"2aee6773-2a2b-4f9c-91ae-eb847e6ac71a"},"execution_count":20,"outputs":[{"output_type":"stream","name":"stdout","text":["(702411, 8) corrected columns: ['measuredat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  measuredat  unit  itemid               item  value  \\\n","0            0 -271.666667  Geen   11423         Ht (bloed)   0.40   \n","1            0      -249.8  Geen   11423         Ht (bloed)   0.36   \n","2            0      -129.8  Geen   11423         Ht (bloed)   0.39   \n","3            0        -8.3  Geen   11423         Ht (bloed)   0.39   \n","4            0         5.7  Geen   11545  Ht(v.Bgs) (bloed)   0.24   \n","\n","            registeredby  manual_entry  \n","0                Systeem         False  \n","1                Systeem         False  \n","2                Systeem         False  \n","3                Systeem         False  \n","4  ICV_IC-Verpleegkundig          True  "],"text/html":["\n","  <div id=\"df-9a8254ae-106a-47db-b293-c648c44ffe79\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat</th>\n","      <th>unit</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>value</th>\n","      <th>registeredby</th>\n","      <th>manual_entry</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>-271.666667</td>\n","      <td>Geen</td>\n","      <td>11423</td>\n","      <td>Ht (bloed)</td>\n","      <td>0.40</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>-249.8</td>\n","      <td>Geen</td>\n","      <td>11423</td>\n","      <td>Ht (bloed)</td>\n","      <td>0.36</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>-129.8</td>\n","      <td>Geen</td>\n","      <td>11423</td>\n","      <td>Ht (bloed)</td>\n","      <td>0.39</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>-8.3</td>\n","      <td>Geen</td>\n","      <td>11423</td>\n","      <td>Ht (bloed)</td>\n","      <td>0.39</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>5.7</td>\n","      <td>Geen</td>\n","      <td>11545</td>\n","      <td>Ht(v.Bgs) (bloed)</td>\n","      <td>0.24</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>True</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9a8254ae-106a-47db-b293-c648c44ffe79')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-9a8254ae-106a-47db-b293-c648c44ffe79 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-9a8254ae-106a-47db-b293-c648c44ffe79');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_a2_creatinine = get_items(\n","    sql = open(f'{sql_script_directory}/a2_creatinine.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/a2_creatinine.pickle',\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":224},"id":"AXBxZRMHX6ac","executionInfo":{"status":"ok","timestamp":1686736707683,"user_tz":-120,"elapsed":388,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"4c68f960-af9b-41bc-d95b-3916ac472a46"},"execution_count":21,"outputs":[{"output_type":"stream","name":"stdout","text":["(202700, 12) corrected columns: ['measuredat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid                item  value registeredby  measuredat  \\\n","0            0    9941  Kreatinine (bloed)   94.0      Systeem -271.666667   \n","1            0    9941  Kreatinine (bloed)   86.0      Systeem      -249.8   \n","2            0    9941  Kreatinine (bloed)   94.0      Systeem      -129.8   \n","3            0    9941  Kreatinine (bloed)   88.0      Systeem        -8.3   \n","4            0    9941  Kreatinine (bloed)   86.0      Systeem         6.1   \n","\n","     unit  manual_entry     time  baseline_creatinine  max_creatinine_7days  \\\n","0  µmol/l         False -16300.0                 86.0                  86.0   \n","1  µmol/l         False -14988.0                 86.0                  86.0   \n","2  µmol/l         False  -7788.0                 86.0                  86.0   \n","3  µmol/l         False   -498.0                 86.0                  86.0   \n","4  µmol/l         False    366.0                 86.0                  86.0   \n","\n","   acute_renal_failure  \n","0                False  \n","1                False  \n","2                False  \n","3                False  \n","4                False  "],"text/html":["\n","  <div id=\"df-48c41a78-5af3-429f-a3a8-c6e57cf7690b\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>value</th>\n","      <th>registeredby</th>\n","      <th>measuredat</th>\n","      <th>unit</th>\n","      <th>manual_entry</th>\n","      <th>time</th>\n","      <th>baseline_creatinine</th>\n","      <th>max_creatinine_7days</th>\n","      <th>acute_renal_failure</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>9941</td>\n","      <td>Kreatinine (bloed)</td>\n","      <td>94.0</td>\n","      <td>Systeem</td>\n","      <td>-271.666667</td>\n","      <td>µmol/l</td>\n","      <td>False</td>\n","      <td>-16300.0</td>\n","      <td>86.0</td>\n","      <td>86.0</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>9941</td>\n","      <td>Kreatinine (bloed)</td>\n","      <td>86.0</td>\n","      <td>Systeem</td>\n","      <td>-249.8</td>\n","      <td>µmol/l</td>\n","      <td>False</td>\n","      <td>-14988.0</td>\n","      <td>86.0</td>\n","      <td>86.0</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>9941</td>\n","      <td>Kreatinine (bloed)</td>\n","      <td>94.0</td>\n","      <td>Systeem</td>\n","      <td>-129.8</td>\n","      <td>µmol/l</td>\n","      <td>False</td>\n","      <td>-7788.0</td>\n","      <td>86.0</td>\n","      <td>86.0</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9941</td>\n","      <td>Kreatinine (bloed)</td>\n","      <td>88.0</td>\n","      <td>Systeem</td>\n","      <td>-8.3</td>\n","      <td>µmol/l</td>\n","      <td>False</td>\n","      <td>-498.0</td>\n","      <td>86.0</td>\n","      <td>86.0</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>9941</td>\n","      <td>Kreatinine (bloed)</td>\n","      <td>86.0</td>\n","      <td>Systeem</td>\n","      <td>6.1</td>\n","      <td>µmol/l</td>\n","      <td>False</td>\n","      <td>366.0</td>\n","      <td>86.0</td>\n","      <td>86.0</td>\n","      <td>False</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-48c41a78-5af3-429f-a3a8-c6e57cf7690b')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-48c41a78-5af3-429f-a3a8-c6e57cf7690b button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-48c41a78-5af3-429f-a3a8-c6e57cf7690b');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_a2_potassium = get_items(\n","    sql = open(f'{sql_script_directory}/a2_potassium.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/a2_potassium.pickle',\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":224},"id":"aL7K2csUQobe","executionInfo":{"status":"ok","timestamp":1686736709046,"user_tz":-120,"elapsed":1366,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"b5a0c1da-d5e2-4285-86f3-4866bb699b84"},"execution_count":22,"outputs":[{"output_type":"stream","name":"stdout","text":["(791488, 8) corrected columns: ['measuredat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  measuredat  itemid                 item  value    unit  \\\n","0            0 -271.666667    9927       Kalium (bloed)    4.1  mmol/l   \n","1            0      -249.8    9927       Kalium (bloed)    3.8  mmol/l   \n","2            0      -129.8    9927       Kalium (bloed)    4.3  mmol/l   \n","3            0        -8.3    9927       Kalium (bloed)    3.9  mmol/l   \n","4            0         5.7   10285  K (onv.ISE) (bloed)    4.5  mmol/l   \n","\n","            registeredby  manual_entry  \n","0                Systeem         False  \n","1                Systeem         False  \n","2                Systeem         False  \n","3                Systeem         False  \n","4  ICV_IC-Verpleegkundig          True  "],"text/html":["\n","  <div id=\"df-a762bbce-fd64-4c91-beb4-94eedb164b54\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>value</th>\n","      <th>unit</th>\n","      <th>registeredby</th>\n","      <th>manual_entry</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>-271.666667</td>\n","      <td>9927</td>\n","      <td>Kalium (bloed)</td>\n","      <td>4.1</td>\n","      <td>mmol/l</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>-249.8</td>\n","      <td>9927</td>\n","      <td>Kalium (bloed)</td>\n","      <td>3.8</td>\n","      <td>mmol/l</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>-129.8</td>\n","      <td>9927</td>\n","      <td>Kalium (bloed)</td>\n","      <td>4.3</td>\n","      <td>mmol/l</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>-8.3</td>\n","      <td>9927</td>\n","      <td>Kalium (bloed)</td>\n","      <td>3.9</td>\n","      <td>mmol/l</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>5.7</td>\n","      <td>10285</td>\n","      <td>K (onv.ISE) (bloed)</td>\n","      <td>4.5</td>\n","      <td>mmol/l</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>True</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a762bbce-fd64-4c91-beb4-94eedb164b54')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a762bbce-fd64-4c91-beb4-94eedb164b54 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a762bbce-fd64-4c91-beb4-94eedb164b54');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_a2_sodium = get_items(\n","    sql = open(f'{sql_script_directory}/a2_sodium.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/a2_sodium.pickle',\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":224},"id":"hgfPGdTdPNl4","executionInfo":{"status":"ok","timestamp":1686736710725,"user_tz":-120,"elapsed":1682,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"f5ba4850-039e-4762-fe5f-cc2732fdf2e3"},"execution_count":23,"outputs":[{"output_type":"stream","name":"stdout","text":["(782330, 8) corrected columns: ['measuredat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  measuredat  itemid                  item  value    unit  \\\n","0            0 -271.666667    9924       Natrium (bloed)  142.0  mmol/l   \n","1            0      -249.8    9924       Natrium (bloed)  138.0  mmol/l   \n","2            0      -129.8    9924       Natrium (bloed)  141.0  mmol/l   \n","3            0        -8.3    9924       Natrium (bloed)  143.0  mmol/l   \n","4            0         5.7   10284  Na (onv.ISE) (bloed)  141.0  mmol/l   \n","\n","            registeredby  manual_entry  \n","0                Systeem         False  \n","1                Systeem         False  \n","2                Systeem         False  \n","3                Systeem         False  \n","4  ICV_IC-Verpleegkundig          True  "],"text/html":["\n","  <div id=\"df-28a7e49d-6f1b-4451-8818-aa3cc6ce6603\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>value</th>\n","      <th>unit</th>\n","      <th>registeredby</th>\n","      <th>manual_entry</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>-271.666667</td>\n","      <td>9924</td>\n","      <td>Natrium (bloed)</td>\n","      <td>142.0</td>\n","      <td>mmol/l</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>-249.8</td>\n","      <td>9924</td>\n","      <td>Natrium (bloed)</td>\n","      <td>138.0</td>\n","      <td>mmol/l</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>-129.8</td>\n","      <td>9924</td>\n","      <td>Natrium (bloed)</td>\n","      <td>141.0</td>\n","      <td>mmol/l</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>-8.3</td>\n","      <td>9924</td>\n","      <td>Natrium (bloed)</td>\n","      <td>143.0</td>\n","      <td>mmol/l</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>5.7</td>\n","      <td>10284</td>\n","      <td>Na (onv.ISE) (bloed)</td>\n","      <td>141.0</td>\n","      <td>mmol/l</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>True</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-28a7e49d-6f1b-4451-8818-aa3cc6ce6603')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-28a7e49d-6f1b-4451-8818-aa3cc6ce6603 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-28a7e49d-6f1b-4451-8818-aa3cc6ce6603');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_a2_ph = get_items(\n","    sql = open(f'{sql_script_directory}/a2_ph.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/a2_ph.pickle',\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":224},"id":"yCEX3srBMDiz","executionInfo":{"status":"ok","timestamp":1686736711276,"user_tz":-120,"elapsed":557,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"5afbb45f-2a30-4e97-fe73-4690619652ba"},"execution_count":24,"outputs":[{"output_type":"stream","name":"stdout","text":["(665531, 9) corrected columns: ['measuredat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  measuredat  value  itemid        item  value_1  \\\n","0            0 -271.666667   7.45   12310  pH (bloed)     7.45   \n","1            0         5.7   7.40   12310  pH (bloed)     7.40   \n","2            0         7.2   7.40   12310  pH (bloed)     7.40   \n","3            0         9.2   7.39   12310  pH (bloed)     7.39   \n","4            0        12.2   7.41   12310  pH (bloed)     7.41   \n","\n","  specimen_source           registeredby  manual_entry  \n","0            ART.                Systeem         False  \n","1            None  ICV_IC-Verpleegkundig          True  \n","2            None  ICV_IC-Verpleegkundig          True  \n","3            None  ICV_IC-Verpleegkundig          True  \n","4            None  ICV_IC-Verpleegkundig          True  "],"text/html":["\n","  <div id=\"df-5bc64b8f-b40d-4f21-a0b4-deb0bdcc3406\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat</th>\n","      <th>value</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>value_1</th>\n","      <th>specimen_source</th>\n","      <th>registeredby</th>\n","      <th>manual_entry</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>-271.666667</td>\n","      <td>7.45</td>\n","      <td>12310</td>\n","      <td>pH (bloed)</td>\n","      <td>7.45</td>\n","      <td>ART.</td>\n","      <td>Systeem</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>5.7</td>\n","      <td>7.40</td>\n","      <td>12310</td>\n","      <td>pH (bloed)</td>\n","      <td>7.40</td>\n","      <td>None</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>7.2</td>\n","      <td>7.40</td>\n","      <td>12310</td>\n","      <td>pH (bloed)</td>\n","      <td>7.40</td>\n","      <td>None</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9.2</td>\n","      <td>7.39</td>\n","      <td>12310</td>\n","      <td>pH (bloed)</td>\n","      <td>7.39</td>\n","      <td>None</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>12.2</td>\n","      <td>7.41</td>\n","      <td>12310</td>\n","      <td>pH (bloed)</td>\n","      <td>7.41</td>\n","      <td>None</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>True</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5bc64b8f-b40d-4f21-a0b4-deb0bdcc3406')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-5bc64b8f-b40d-4f21-a0b4-deb0bdcc3406 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-5bc64b8f-b40d-4f21-a0b4-deb0bdcc3406');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_a2_oxygenation = get_items(\n","    sql = open(f'{sql_script_directory}/a2_o2.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/a2_o2.pickle',\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":224},"id":"9KAD7tyqMC1x","executionInfo":{"status":"ok","timestamp":1686736711277,"user_tz":-120,"elapsed":14,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"8450d606-8856-4799-8f48-54c4c9abf6b1"},"execution_count":25,"outputs":[{"output_type":"stream","name":"stdout","text":["(662585, 9) corrected columns: ['measuredat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid   PaO2  PaCO2 specimen_source  manual_entry  measuredat  FiO2  \\\n","0            0   71.0   41.0            ART.         False -271.666667   NaN   \n","1            0   90.0   39.0            None          True         5.7  50.0   \n","2            0  149.0   37.0            None          True         7.2  51.0   \n","3            0  104.0   36.0            None          True         9.2  41.0   \n","4            0   32.0   43.0            None          True        10.2  41.0   \n","\n","   FiO2_time_difference  priority  \n","0                  <NA>         1  \n","1                     0         1  \n","2                     0         1  \n","3                     0         1  \n","4                     0         1  "],"text/html":["\n","  <div id=\"df-5ec12e90-6419-403e-a450-5b8500257986\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>PaO2</th>\n","      <th>PaCO2</th>\n","      <th>specimen_source</th>\n","      <th>manual_entry</th>\n","      <th>measuredat</th>\n","      <th>FiO2</th>\n","      <th>FiO2_time_difference</th>\n","      <th>priority</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>71.0</td>\n","      <td>41.0</td>\n","      <td>ART.</td>\n","      <td>False</td>\n","      <td>-271.666667</td>\n","      <td>NaN</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>90.0</td>\n","      <td>39.0</td>\n","      <td>None</td>\n","      <td>True</td>\n","      <td>5.7</td>\n","      <td>50.0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>149.0</td>\n","      <td>37.0</td>\n","      <td>None</td>\n","      <td>True</td>\n","      <td>7.2</td>\n","      <td>51.0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>104.0</td>\n","      <td>36.0</td>\n","      <td>None</td>\n","      <td>True</td>\n","      <td>9.2</td>\n","      <td>41.0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>32.0</td>\n","      <td>43.0</td>\n","      <td>None</td>\n","      <td>True</td>\n","      <td>10.2</td>\n","      <td>41.0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5ec12e90-6419-403e-a450-5b8500257986')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-5ec12e90-6419-403e-a450-5b8500257986 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-5ec12e90-6419-403e-a450-5b8500257986');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_a2_mean_abp = get_items(\n","    sql = open(f'{sql_script_directory}/a2_mean_abp.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/a2_mean_abp.pickle',\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":355},"id":"dKhXgsYs44_4","executionInfo":{"status":"ok","timestamp":1686736715919,"user_tz":-120,"elapsed":4650,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"73515e1e-de01-4d68-9f00-0eac1894199b"},"execution_count":26,"outputs":[{"output_type":"stream","name":"stdout","text":["(2233222, 15) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid           item tag  value  unitid  unit  \\\n","0            0    6642  ABP gemiddeld       68.0     173  mmHg   \n","1            0    6642  ABP gemiddeld       83.0     173  mmHg   \n","2            0    6642  ABP gemiddeld       75.0     173  mmHg   \n","3            0    6642  ABP gemiddeld       70.0     173  mmHg   \n","4            0    6642  ABP gemiddeld       73.0     173  mmHg   \n","\n","                comment  measuredat  registeredat           registeredby  \\\n","0  Opmerking verwijderd         5.7      5.716667  ICV_IC-Verpleegkundig   \n","1  Opmerking verwijderd         6.2      6.583333  ICV_IC-Verpleegkundig   \n","2  Opmerking verwijderd         7.2      7.266667  ICV_IC-Verpleegkundig   \n","3  Opmerking verwijderd         8.2      8.183333  ICV_IC-Verpleegkundig   \n","4  Opmerking verwijderd         9.2          9.25  ICV_IC-Verpleegkundig   \n","\n","   updatedat              updatedby  islabresult  fluidout  \n","0   5.716667  ICV_IC-Verpleegkundig            0      <NA>  \n","1   6.583333  ICV_IC-Verpleegkundig            0      <NA>  \n","2   7.266667  ICV_IC-Verpleegkundig            0      <NA>  \n","3   8.199519  ICV_IC-Verpleegkundig            0      <NA>  \n","4       9.25  ICV_IC-Verpleegkundig            0      <NA>  "],"text/html":["\n","  <div id=\"df-d9fd9773-e886-4bac-aaab-0b21f00baa69\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>tag</th>\n","      <th>value</th>\n","      <th>unitid</th>\n","      <th>unit</th>\n","      <th>comment</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","      <th>fluidout</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6642</td>\n","      <td>ABP gemiddeld</td>\n","      <td></td>\n","      <td>68.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>5.716667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>5.716667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>6642</td>\n","      <td>ABP gemiddeld</td>\n","      <td></td>\n","      <td>83.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>6.583333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.583333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>6642</td>\n","      <td>ABP gemiddeld</td>\n","      <td></td>\n","      <td>75.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>7.2</td>\n","      <td>7.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>6642</td>\n","      <td>ABP gemiddeld</td>\n","      <td></td>\n","      <td>70.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>8.2</td>\n","      <td>8.183333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>8.199519</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>6642</td>\n","      <td>ABP gemiddeld</td>\n","      <td></td>\n","      <td>73.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>9.2</td>\n","      <td>9.25</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>9.25</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d9fd9773-e886-4bac-aaab-0b21f00baa69')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d9fd9773-e886-4bac-aaab-0b21f00baa69 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d9fd9773-e886-4bac-aaab-0b21f00baa69');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_a2_temperature = get_items(\n","    sql = open(f'{sql_script_directory}/a2_temperature.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/a2_temperature.pickle',\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":268},"id":"HSMQexT4zN5g","executionInfo":{"status":"ok","timestamp":1686736717531,"user_tz":-120,"elapsed":1614,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"77302810-2f4e-4b39-e80f-df6c3be7d57d"},"execution_count":27,"outputs":[{"output_type":"stream","name":"stdout","text":["(866517, 15) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid        item tag  value  unitid unit  \\\n","0            0    8658  Temp Bloed       35.9      59   °C   \n","1            0   13063   Temp Huid       28.6      59   °C   \n","2            0    8658  Temp Bloed       35.9      59   °C   \n","3            0   13063   Temp Huid       28.7      59   °C   \n","4            0    8658  Temp Bloed       35.9      59   °C   \n","\n","                comment  measuredat  registeredat           registeredby  \\\n","0  Opmerking verwijderd         5.7      5.716667  ICV_IC-Verpleegkundig   \n","1  Opmerking verwijderd         5.7      8.216667  ICV_IC-Verpleegkundig   \n","2  Opmerking verwijderd         6.2      6.583333  ICV_IC-Verpleegkundig   \n","3  Opmerking verwijderd         6.2      8.166667  ICV_IC-Verpleegkundig   \n","4  Opmerking verwijderd         7.2      7.266667  ICV_IC-Verpleegkundig   \n","\n","   updatedat              updatedby  islabresult  fluidout  \n","0   5.716667  ICV_IC-Verpleegkundig            0      <NA>  \n","1   8.230571  ICV_IC-Verpleegkundig            0      <NA>  \n","2   6.583333  ICV_IC-Verpleegkundig            0      <NA>  \n","3   8.182168  ICV_IC-Verpleegkundig            0      <NA>  \n","4   7.266667  ICV_IC-Verpleegkundig            0      <NA>  "],"text/html":["\n","  <div id=\"df-2622eb98-b1df-41b9-b655-3921355c9ac0\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>tag</th>\n","      <th>value</th>\n","      <th>unitid</th>\n","      <th>unit</th>\n","      <th>comment</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","      <th>fluidout</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>8658</td>\n","      <td>Temp Bloed</td>\n","      <td></td>\n","      <td>35.9</td>\n","      <td>59</td>\n","      <td>°C</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>5.716667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>5.716667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>13063</td>\n","      <td>Temp Huid</td>\n","      <td></td>\n","      <td>28.6</td>\n","      <td>59</td>\n","      <td>°C</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>8.216667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>8.230571</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>8658</td>\n","      <td>Temp Bloed</td>\n","      <td></td>\n","      <td>35.9</td>\n","      <td>59</td>\n","      <td>°C</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>6.583333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.583333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>13063</td>\n","      <td>Temp Huid</td>\n","      <td></td>\n","      <td>28.7</td>\n","      <td>59</td>\n","      <td>°C</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>8.166667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>8.182168</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>8658</td>\n","      <td>Temp Bloed</td>\n","      <td></td>\n","      <td>35.9</td>\n","      <td>59</td>\n","      <td>°C</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>7.2</td>\n","      <td>7.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2622eb98-b1df-41b9-b655-3921355c9ac0')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-2622eb98-b1df-41b9-b655-3921355c9ac0 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-2622eb98-b1df-41b9-b655-3921355c9ac0');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":[],"metadata":{"id":"UAFfsHA5ziBF","executionInfo":{"status":"ok","timestamp":1686736717532,"user_tz":-120,"elapsed":21,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":27,"outputs":[]},{"cell_type":"code","source":["df_plt = get_items(\n","    sql = open(f'{sql_script_directory}/plt.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/plt.pickle',\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":224},"id":"3_2JIf92zBqR","executionInfo":{"status":"ok","timestamp":1686736717532,"user_tz":-120,"elapsed":21,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"22f2327c-effd-4bae-b79a-60689b827191"},"execution_count":28,"outputs":[{"output_type":"stream","name":"stdout","text":["(221653, 15) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid               item  tag  value  unitid    unit  \\\n","0            0    9964  Thrombo's (bloed)  NUL  259.0     101  10^9/l   \n","1            0    9964  Thrombo's (bloed)  NUL  297.0     101  10^9/l   \n","2            0    9964  Thrombo's (bloed)  NUL  150.0     101  10^9/l   \n","3            0    9964  Thrombo's (bloed)  NUL  171.0     101  10^9/l   \n","4            0    9964  Thrombo's (bloed)  NUL  206.0     101  10^9/l   \n","\n","                comment  measuredat  registeredat registeredby  updatedat  \\\n","0  Opmerking verwijderd -271.666667   -271.666667      Systeem   0.087825   \n","1  Opmerking verwijderd        -8.3          -8.3      Systeem   0.088446   \n","2  Opmerking verwijderd    4.716667      4.716667      Systeem  17.476669   \n","3  Opmerking verwijderd         6.1           6.1      Systeem  17.476729   \n","4  Opmerking verwijderd   12.683333     12.683333      Systeem  17.477623   \n","\n","  updatedby  islabresult  fluidout  \n","0   Systeem            1      <NA>  \n","1   Systeem            1      <NA>  \n","2   Systeem            1      <NA>  \n","3   Systeem            1      <NA>  \n","4   Systeem            1      <NA>  "],"text/html":["\n","  <div id=\"df-8e16d9d2-1f51-472c-9c79-954de38df3eb\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>tag</th>\n","      <th>value</th>\n","      <th>unitid</th>\n","      <th>unit</th>\n","      <th>comment</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","      <th>fluidout</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>9964</td>\n","      <td>Thrombo's (bloed)</td>\n","      <td>NUL</td>\n","      <td>259.0</td>\n","      <td>101</td>\n","      <td>10^9/l</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>-271.666667</td>\n","      <td>-271.666667</td>\n","      <td>Systeem</td>\n","      <td>0.087825</td>\n","      <td>Systeem</td>\n","      <td>1</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>9964</td>\n","      <td>Thrombo's (bloed)</td>\n","      <td>NUL</td>\n","      <td>297.0</td>\n","      <td>101</td>\n","      <td>10^9/l</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>-8.3</td>\n","      <td>-8.3</td>\n","      <td>Systeem</td>\n","      <td>0.088446</td>\n","      <td>Systeem</td>\n","      <td>1</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>9964</td>\n","      <td>Thrombo's (bloed)</td>\n","      <td>NUL</td>\n","      <td>150.0</td>\n","      <td>101</td>\n","      <td>10^9/l</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>4.716667</td>\n","      <td>4.716667</td>\n","      <td>Systeem</td>\n","      <td>17.476669</td>\n","      <td>Systeem</td>\n","      <td>1</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9964</td>\n","      <td>Thrombo's (bloed)</td>\n","      <td>NUL</td>\n","      <td>171.0</td>\n","      <td>101</td>\n","      <td>10^9/l</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.1</td>\n","      <td>6.1</td>\n","      <td>Systeem</td>\n","      <td>17.476729</td>\n","      <td>Systeem</td>\n","      <td>1</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>9964</td>\n","      <td>Thrombo's (bloed)</td>\n","      <td>NUL</td>\n","      <td>206.0</td>\n","      <td>101</td>\n","      <td>10^9/l</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>12.683333</td>\n","      <td>12.683333</td>\n","      <td>Systeem</td>\n","      <td>17.477623</td>\n","      <td>Systeem</td>\n","      <td>1</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8e16d9d2-1f51-472c-9c79-954de38df3eb')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-8e16d9d2-1f51-472c-9c79-954de38df3eb button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-8e16d9d2-1f51-472c-9c79-954de38df3eb');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_plt = get_items(\n","    sql = open(f'{sql_script_directory}/plt.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/plt.pickle',\n",")"],"metadata":{"id":"4jIKHAtCYRNJ","colab":{"base_uri":"https://localhost:8080/","height":224},"executionInfo":{"status":"ok","timestamp":1686736717533,"user_tz":-120,"elapsed":15,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"7c3909b4-9667-425d-d41d-14928131ec0a"},"execution_count":29,"outputs":[{"output_type":"stream","name":"stdout","text":["(221653, 15) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid               item  tag  value  unitid    unit  \\\n","0            0    9964  Thrombo's (bloed)  NUL  259.0     101  10^9/l   \n","1            0    9964  Thrombo's (bloed)  NUL  297.0     101  10^9/l   \n","2            0    9964  Thrombo's (bloed)  NUL  150.0     101  10^9/l   \n","3            0    9964  Thrombo's (bloed)  NUL  171.0     101  10^9/l   \n","4            0    9964  Thrombo's (bloed)  NUL  206.0     101  10^9/l   \n","\n","                comment  measuredat  registeredat registeredby  updatedat  \\\n","0  Opmerking verwijderd -271.666667   -271.666667      Systeem   0.087825   \n","1  Opmerking verwijderd        -8.3          -8.3      Systeem   0.088446   \n","2  Opmerking verwijderd    4.716667      4.716667      Systeem  17.476669   \n","3  Opmerking verwijderd         6.1           6.1      Systeem  17.476729   \n","4  Opmerking verwijderd   12.683333     12.683333      Systeem  17.477623   \n","\n","  updatedby  islabresult  fluidout  \n","0   Systeem            1      <NA>  \n","1   Systeem            1      <NA>  \n","2   Systeem            1      <NA>  \n","3   Systeem            1      <NA>  \n","4   Systeem            1      <NA>  "],"text/html":["\n","  <div id=\"df-fa5e3560-1c1d-4e01-8fb6-26a88d805904\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>tag</th>\n","      <th>value</th>\n","      <th>unitid</th>\n","      <th>unit</th>\n","      <th>comment</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","      <th>fluidout</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>9964</td>\n","      <td>Thrombo's (bloed)</td>\n","      <td>NUL</td>\n","      <td>259.0</td>\n","      <td>101</td>\n","      <td>10^9/l</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>-271.666667</td>\n","      <td>-271.666667</td>\n","      <td>Systeem</td>\n","      <td>0.087825</td>\n","      <td>Systeem</td>\n","      <td>1</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>9964</td>\n","      <td>Thrombo's (bloed)</td>\n","      <td>NUL</td>\n","      <td>297.0</td>\n","      <td>101</td>\n","      <td>10^9/l</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>-8.3</td>\n","      <td>-8.3</td>\n","      <td>Systeem</td>\n","      <td>0.088446</td>\n","      <td>Systeem</td>\n","      <td>1</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>9964</td>\n","      <td>Thrombo's (bloed)</td>\n","      <td>NUL</td>\n","      <td>150.0</td>\n","      <td>101</td>\n","      <td>10^9/l</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>4.716667</td>\n","      <td>4.716667</td>\n","      <td>Systeem</td>\n","      <td>17.476669</td>\n","      <td>Systeem</td>\n","      <td>1</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9964</td>\n","      <td>Thrombo's (bloed)</td>\n","      <td>NUL</td>\n","      <td>171.0</td>\n","      <td>101</td>\n","      <td>10^9/l</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.1</td>\n","      <td>6.1</td>\n","      <td>Systeem</td>\n","      <td>17.476729</td>\n","      <td>Systeem</td>\n","      <td>1</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>9964</td>\n","      <td>Thrombo's (bloed)</td>\n","      <td>NUL</td>\n","      <td>206.0</td>\n","      <td>101</td>\n","      <td>10^9/l</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>12.683333</td>\n","      <td>12.683333</td>\n","      <td>Systeem</td>\n","      <td>17.477623</td>\n","      <td>Systeem</td>\n","      <td>1</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-fa5e3560-1c1d-4e01-8fb6-26a88d805904')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-fa5e3560-1c1d-4e01-8fb6-26a88d805904 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-fa5e3560-1c1d-4e01-8fb6-26a88d805904');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_dbp = get_items(\n","    sql = open(f'{sql_script_directory}/dbp.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/dbp.pickle',\n",")"],"metadata":{"id":"u5j3gj6iQmI5","colab":{"base_uri":"https://localhost:8080/","height":355},"executionInfo":{"status":"ok","timestamp":1686736722238,"user_tz":-120,"elapsed":4715,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"4dd65915-0b14-405a-baa1-87f21eb1b766"},"execution_count":30,"outputs":[{"output_type":"stream","name":"stdout","text":["(2233449, 15) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid             item tag  value  unitid  unit  \\\n","0            0    6643  ABP diastolisch       49.0     173  mmHg   \n","1            0    6643  ABP diastolisch       59.0     173  mmHg   \n","2            0    6643  ABP diastolisch       55.0     173  mmHg   \n","3            0    6643  ABP diastolisch       51.0     173  mmHg   \n","4            0    6643  ABP diastolisch       52.0     173  mmHg   \n","\n","                comment  measuredat  registeredat           registeredby  \\\n","0  Opmerking verwijderd         5.7      5.716667  ICV_IC-Verpleegkundig   \n","1  Opmerking verwijderd         6.2      6.583333  ICV_IC-Verpleegkundig   \n","2  Opmerking verwijderd         7.2      7.266667  ICV_IC-Verpleegkundig   \n","3  Opmerking verwijderd         8.2      8.183333  ICV_IC-Verpleegkundig   \n","4  Opmerking verwijderd         9.2          9.25  ICV_IC-Verpleegkundig   \n","\n","   updatedat              updatedby  islabresult  fluidout  \n","0   5.716667  ICV_IC-Verpleegkundig            0      <NA>  \n","1   6.583333  ICV_IC-Verpleegkundig            0      <NA>  \n","2   7.266667  ICV_IC-Verpleegkundig            0      <NA>  \n","3   8.198934  ICV_IC-Verpleegkundig            0      <NA>  \n","4       9.25  ICV_IC-Verpleegkundig            0      <NA>  "],"text/html":["\n","  <div id=\"df-812c6717-cdc8-4491-ae08-7155ad597b6b\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>tag</th>\n","      <th>value</th>\n","      <th>unitid</th>\n","      <th>unit</th>\n","      <th>comment</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","      <th>fluidout</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6643</td>\n","      <td>ABP diastolisch</td>\n","      <td></td>\n","      <td>49.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>5.716667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>5.716667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>6643</td>\n","      <td>ABP diastolisch</td>\n","      <td></td>\n","      <td>59.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>6.583333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.583333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>6643</td>\n","      <td>ABP diastolisch</td>\n","      <td></td>\n","      <td>55.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>7.2</td>\n","      <td>7.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>6643</td>\n","      <td>ABP diastolisch</td>\n","      <td></td>\n","      <td>51.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>8.2</td>\n","      <td>8.183333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>8.198934</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>6643</td>\n","      <td>ABP diastolisch</td>\n","      <td></td>\n","      <td>52.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>9.2</td>\n","      <td>9.25</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>9.25</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-812c6717-cdc8-4491-ae08-7155ad597b6b')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-812c6717-cdc8-4491-ae08-7155ad597b6b button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-812c6717-cdc8-4491-ae08-7155ad597b6b');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_sbp = get_items(\n","    sql = open(f'{sql_script_directory}/sbp.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/sbp.pickle',\n",")"],"metadata":{"id":"BT4lQSMeQAhy","colab":{"base_uri":"https://localhost:8080/","height":355},"executionInfo":{"status":"ok","timestamp":1686736726261,"user_tz":-120,"elapsed":4035,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"554867b4-767f-43a1-e8ce-a4529387f7a3"},"execution_count":31,"outputs":[{"output_type":"stream","name":"stdout","text":["(2235252, 15) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid            item tag  value  unitid  unit  \\\n","0            0    6641  ABP systolisch      102.0     173  mmHg   \n","1            0    6641  ABP systolisch      123.0     173  mmHg   \n","2            0    6641  ABP systolisch      112.0     173  mmHg   \n","3            0    6641  ABP systolisch      106.0     173  mmHg   \n","4            0    6641  ABP systolisch      115.0     173  mmHg   \n","\n","                comment  measuredat  registeredat           registeredby  \\\n","0  Opmerking verwijderd         5.7      5.716667  ICV_IC-Verpleegkundig   \n","1  Opmerking verwijderd         6.2      6.583333  ICV_IC-Verpleegkundig   \n","2  Opmerking verwijderd         7.2      7.266667  ICV_IC-Verpleegkundig   \n","3  Opmerking verwijderd         8.2      8.183333  ICV_IC-Verpleegkundig   \n","4  Opmerking verwijderd         9.2          9.25  ICV_IC-Verpleegkundig   \n","\n","   updatedat              updatedby  islabresult  fluidout  \n","0   5.716667  ICV_IC-Verpleegkundig            0      <NA>  \n","1   6.583333  ICV_IC-Verpleegkundig            0      <NA>  \n","2   7.266667  ICV_IC-Verpleegkundig            0      <NA>  \n","3     8.1983  ICV_IC-Verpleegkundig            0      <NA>  \n","4       9.25  ICV_IC-Verpleegkundig            0      <NA>  "],"text/html":["\n","  <div id=\"df-b699898d-cfaf-49f5-a295-612e06019a42\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>tag</th>\n","      <th>value</th>\n","      <th>unitid</th>\n","      <th>unit</th>\n","      <th>comment</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","      <th>fluidout</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6641</td>\n","      <td>ABP systolisch</td>\n","      <td></td>\n","      <td>102.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>5.716667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>5.716667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>6641</td>\n","      <td>ABP systolisch</td>\n","      <td></td>\n","      <td>123.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>6.583333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.583333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>6641</td>\n","      <td>ABP systolisch</td>\n","      <td></td>\n","      <td>112.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>7.2</td>\n","      <td>7.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>6641</td>\n","      <td>ABP systolisch</td>\n","      <td></td>\n","      <td>106.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>8.2</td>\n","      <td>8.183333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>8.1983</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>6641</td>\n","      <td>ABP systolisch</td>\n","      <td></td>\n","      <td>115.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>9.2</td>\n","      <td>9.25</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>9.25</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b699898d-cfaf-49f5-a295-612e06019a42')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-b699898d-cfaf-49f5-a295-612e06019a42 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b699898d-cfaf-49f5-a295-612e06019a42');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_hr = get_items(\n","    sql = open(f'{sql_script_directory}/hr.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/hr.pickle',\n",")"],"metadata":{"id":"qFUNzJtdOmw5","colab":{"base_uri":"https://localhost:8080/","height":355},"executionInfo":{"status":"ok","timestamp":1686736730485,"user_tz":-120,"elapsed":4237,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"b8cbf4c2-7d0a-4d89-f261-7a4432909e23"},"execution_count":32,"outputs":[{"output_type":"stream","name":"stdout","text":["(2218626, 15) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid            item tag  value  unitid  unit  \\\n","0            0    6640  Hartfrequentie       83.0      15  /min   \n","1            0    6640  Hartfrequentie       84.0      15  /min   \n","2            0    6640  Hartfrequentie       82.0      15  /min   \n","3            0    6640  Hartfrequentie       78.0      15  /min   \n","4            0    6640  Hartfrequentie       73.0      15  /min   \n","\n","                comment  measuredat  registeredat           registeredby  \\\n","0  Opmerking verwijderd         5.7      5.716667  ICV_IC-Verpleegkundig   \n","1  Opmerking verwijderd         6.2      6.583333  ICV_IC-Verpleegkundig   \n","2  Opmerking verwijderd         7.2      7.266667  ICV_IC-Verpleegkundig   \n","3  Opmerking verwijderd         8.2      8.183333  ICV_IC-Verpleegkundig   \n","4  Opmerking verwijderd         9.2          9.25  ICV_IC-Verpleegkundig   \n","\n","   updatedat              updatedby  islabresult  fluidout  \n","0   5.716667  ICV_IC-Verpleegkundig            0      <NA>  \n","1   6.583333  ICV_IC-Verpleegkundig            0      <NA>  \n","2   7.266667  ICV_IC-Verpleegkundig            0      <NA>  \n","3   8.186074  ICV_IC-Verpleegkundig            0      <NA>  \n","4       9.25  ICV_IC-Verpleegkundig            0      <NA>  "],"text/html":["\n","  <div id=\"df-f193753a-54e8-4c58-b114-a0975e52774d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>tag</th>\n","      <th>value</th>\n","      <th>unitid</th>\n","      <th>unit</th>\n","      <th>comment</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","      <th>fluidout</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6640</td>\n","      <td>Hartfrequentie</td>\n","      <td></td>\n","      <td>83.0</td>\n","      <td>15</td>\n","      <td>/min</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>5.716667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>5.716667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>6640</td>\n","      <td>Hartfrequentie</td>\n","      <td></td>\n","      <td>84.0</td>\n","      <td>15</td>\n","      <td>/min</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>6.583333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.583333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>6640</td>\n","      <td>Hartfrequentie</td>\n","      <td></td>\n","      <td>82.0</td>\n","      <td>15</td>\n","      <td>/min</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>7.2</td>\n","      <td>7.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>6640</td>\n","      <td>Hartfrequentie</td>\n","      <td></td>\n","      <td>78.0</td>\n","      <td>15</td>\n","      <td>/min</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>8.2</td>\n","      <td>8.183333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>8.186074</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>6640</td>\n","      <td>Hartfrequentie</td>\n","      <td></td>\n","      <td>73.0</td>\n","      <td>15</td>\n","      <td>/min</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>9.2</td>\n","      <td>9.25</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>9.25</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f193753a-54e8-4c58-b114-a0975e52774d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-f193753a-54e8-4c58-b114-a0975e52774d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-f193753a-54e8-4c58-b114-a0975e52774d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_insp_p = get_items(\n","    sql = open(f'{sql_script_directory}/insp_p.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/insp_p.pickle',\n",")"],"metadata":{"id":"f7_WpPiqJWHP","colab":{"base_uri":"https://localhost:8080/","height":355},"executionInfo":{"status":"ok","timestamp":1686736732693,"user_tz":-120,"elapsed":2233,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"79ff7c26-4604-414f-afc0-21e063d97eda"},"execution_count":33,"outputs":[{"output_type":"stream","name":"stdout","text":["(1418391, 15) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid                 item tag  value  unitid   unit  \\\n","0            0   12285  PC boven PEEP (Set)       12.0     175  cmH2O   \n","1            0   12285  PC boven PEEP (Set)       12.0     175  cmH2O   \n","2            0   12285  PC boven PEEP (Set)       12.0     175  cmH2O   \n","3            0   12285  PC boven PEEP (Set)       12.0     175  cmH2O   \n","4            0   12285  PC boven PEEP (Set)       12.0     175  cmH2O   \n","\n","                comment  measuredat  registeredat           registeredby  \\\n","0  Opmerking verwijderd         5.7          6.15  ICV_IC-Verpleegkundig   \n","1  Opmerking verwijderd         6.2           7.3  ICV_IC-Verpleegkundig   \n","2  Opmerking verwijderd         7.2           7.3  ICV_IC-Verpleegkundig   \n","3  Opmerking verwijderd         8.2      8.266667  ICV_IC-Verpleegkundig   \n","4  Opmerking verwijderd         9.2     10.366667  ICV_IC-Verpleegkundig   \n","\n","   updatedat              updatedby  islabresult  fluidout  \n","0       6.15  ICV_IC-Verpleegkundig            0      <NA>  \n","1        7.3  ICV_IC-Verpleegkundig            0      <NA>  \n","2        7.3  ICV_IC-Verpleegkundig            0      <NA>  \n","3   8.266667  ICV_IC-Verpleegkundig            0      <NA>  \n","4  10.366667  ICV_IC-Verpleegkundig            0      <NA>  "],"text/html":["\n","  <div id=\"df-7b4c53a2-2d58-4fa9-8ee8-1f7ced606a56\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>tag</th>\n","      <th>value</th>\n","      <th>unitid</th>\n","      <th>unit</th>\n","      <th>comment</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","      <th>fluidout</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>12285</td>\n","      <td>PC boven PEEP (Set)</td>\n","      <td></td>\n","      <td>12.0</td>\n","      <td>175</td>\n","      <td>cmH2O</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>12285</td>\n","      <td>PC boven PEEP (Set)</td>\n","      <td></td>\n","      <td>12.0</td>\n","      <td>175</td>\n","      <td>cmH2O</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>12285</td>\n","      <td>PC boven PEEP (Set)</td>\n","      <td></td>\n","      <td>12.0</td>\n","      <td>175</td>\n","      <td>cmH2O</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>7.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>12285</td>\n","      <td>PC boven PEEP (Set)</td>\n","      <td></td>\n","      <td>12.0</td>\n","      <td>175</td>\n","      <td>cmH2O</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>8.2</td>\n","      <td>8.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>8.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>12285</td>\n","      <td>PC boven PEEP (Set)</td>\n","      <td></td>\n","      <td>12.0</td>\n","      <td>175</td>\n","      <td>cmH2O</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>9.2</td>\n","      <td>10.366667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>10.366667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7b4c53a2-2d58-4fa9-8ee8-1f7ced606a56')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-7b4c53a2-2d58-4fa9-8ee8-1f7ced606a56 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-7b4c53a2-2d58-4fa9-8ee8-1f7ced606a56');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_gcs = get_items(\n","    sql = open(f'{sql_script_directory}/gcs.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/gcs.pickle',\n",")"],"metadata":{"id":"4fYnsUd-ePiK","colab":{"base_uri":"https://localhost:8080/","height":340},"executionInfo":{"status":"ok","timestamp":1686736732695,"user_tz":-120,"elapsed":63,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"d7cf0887-8f5f-4349-9c91-77b9c210b7bc"},"execution_count":34,"outputs":[{"output_type":"stream","name":"stdout","text":["(75797, 11) corrected columns: ['measuredat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  measuredat    time  eyes_score  motor_score  verbal_score  \\\n","0            0   12.216667   733.0           4            6             5   \n","1            0   12.233333   734.0           4            6             5   \n","2            1   22.866667  1372.0           4            6             5   \n","3            2    2.983333   179.0           4            6             5   \n","4            2   20.933333  1256.0           4            6             5   \n","\n","            registeredby  gcs_score      sedatives_given  \\\n","0            ICV_Medisch         15  Propofol (Diprivan)   \n","1            ICV_Medisch         15  Propofol (Diprivan)   \n","2            ICV_Medisch         15                 None   \n","3  ICV_IC-Verpleegkundig         15  Propofol (Diprivan)   \n","4            ICV_Medisch         15                 None   \n","\n","   sedatives_started_minutes_before  sedatives_stopped_minutes_before  \n","0                             400.0                             -37.0  \n","1                             401.0                             -36.0  \n","2                               NaN                               NaN  \n","3                             157.0                              46.0  \n","4                               NaN                               NaN  "],"text/html":["\n","  <div id=\"df-41c5ba54-7a5d-44ee-b6d2-6a9ff105ad98\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat</th>\n","      <th>time</th>\n","      <th>eyes_score</th>\n","      <th>motor_score</th>\n","      <th>verbal_score</th>\n","      <th>registeredby</th>\n","      <th>gcs_score</th>\n","      <th>sedatives_given</th>\n","      <th>sedatives_started_minutes_before</th>\n","      <th>sedatives_stopped_minutes_before</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>12.216667</td>\n","      <td>733.0</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>ICV_Medisch</td>\n","      <td>15</td>\n","      <td>Propofol (Diprivan)</td>\n","      <td>400.0</td>\n","      <td>-37.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>12.233333</td>\n","      <td>734.0</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>ICV_Medisch</td>\n","      <td>15</td>\n","      <td>Propofol (Diprivan)</td>\n","      <td>401.0</td>\n","      <td>-36.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>1</td>\n","      <td>22.866667</td>\n","      <td>1372.0</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>ICV_Medisch</td>\n","      <td>15</td>\n","      <td>None</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2</td>\n","      <td>2.983333</td>\n","      <td>179.0</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>15</td>\n","      <td>Propofol (Diprivan)</td>\n","      <td>157.0</td>\n","      <td>46.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2</td>\n","      <td>20.933333</td>\n","      <td>1256.0</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>ICV_Medisch</td>\n","      <td>15</td>\n","      <td>None</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-41c5ba54-7a5d-44ee-b6d2-6a9ff105ad98')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-41c5ba54-7a5d-44ee-b6d2-6a9ff105ad98 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-41c5ba54-7a5d-44ee-b6d2-6a9ff105ad98');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["df_reason_for_admission = get_items(\n","    sql = open(f'{sql_script_directory}/reason_for_admission.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/reason_for_admission.pickle',\n",")\n","# df_reason_for_admission.to_csv(f\"{output_directory}/admission_reason.csv\", index=None)\n"],"metadata":{"id":"oYGlkHJ5YJ2U","colab":{"base_uri":"https://localhost:8080/","height":444},"executionInfo":{"status":"ok","timestamp":1686736732699,"user_tz":-120,"elapsed":55,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"839f8df3-5372-4dea-84dc-85b83928d564"},"execution_count":35,"outputs":[{"output_type":"stream","name":"stdout","text":["(23106, 16) corrected columns: []\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  diagnosis_type                                    diagnosis  \\\n","0            0      Legacy ICU                                         CABG   \n","1            1      Legacy ICU                                      Bentall   \n","2            2  NICE APACHE IV           CABG with aortic valve replacement   \n","3            3            None                                         None   \n","4            4  NICE APACHE IV  CABG alone, coronary artery bypass grafting   \n","\n","   diagnosis_id     diagnosis_subgroup  diagnosis_subgroup_id  \\\n","0             1  CABG en Klepchirurgie                      1   \n","1             5        Aorta chirurgie                      3   \n","2           237  CABG en Klepchirurgie                      1   \n","3          <NA>                   None                   <NA>   \n","4           233  CABG en Klepchirurgie                      1   \n","\n","                 diagnosis_group  diagnosis_group_id  surgical  \\\n","0                Thoraxchirurgie                   1         1   \n","1                Thoraxchirurgie                   1         1   \n","2  Post-operative cardiovascular                 237         1   \n","3                           None                <NA>      <NA>   \n","4  Post-operative cardiovascular                 233         1   \n","\n","   sepsis_at_admission  sepsis_antibiotics_bool sepsis_antibiotics_given  \\\n","0                 <NA>                     <NA>                     None   \n","1                    0                     <NA>                     None   \n","2                    0                     <NA>                     None   \n","3                 <NA>                     <NA>                     None   \n","4                    0                     <NA>                     None   \n","\n","   other_antibiotics_bool           other_antibiotics_given  \\\n","0                       1               Cefazoline (Kefzol)   \n","1                       1  Cefazoline (Kefzol); Vancomycine   \n","2                       1  Cefazoline (Kefzol); Vancomycine   \n","3                       1               Cefazoline (Kefzol)   \n","4                       1               Cefazoline (Kefzol)   \n","\n","   sepsis_cultures_bool sepsis_cultures_drawn  \n","0                  <NA>                  None  \n","1                  <NA>                  None  \n","2                  <NA>                  None  \n","3                  <NA>                  None  \n","4                  <NA>                  None  "],"text/html":["\n","  <div id=\"df-57a905c4-4d6f-4ed8-a789-33555300a596\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>diagnosis_type</th>\n","      <th>diagnosis</th>\n","      <th>diagnosis_id</th>\n","      <th>diagnosis_subgroup</th>\n","      <th>diagnosis_subgroup_id</th>\n","      <th>diagnosis_group</th>\n","      <th>diagnosis_group_id</th>\n","      <th>surgical</th>\n","      <th>sepsis_at_admission</th>\n","      <th>sepsis_antibiotics_bool</th>\n","      <th>sepsis_antibiotics_given</th>\n","      <th>other_antibiotics_bool</th>\n","      <th>other_antibiotics_given</th>\n","      <th>sepsis_cultures_bool</th>\n","      <th>sepsis_cultures_drawn</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>Legacy ICU</td>\n","      <td>CABG</td>\n","      <td>1</td>\n","      <td>CABG en Klepchirurgie</td>\n","      <td>1</td>\n","      <td>Thoraxchirurgie</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>None</td>\n","      <td>1</td>\n","      <td>Cefazoline (Kefzol)</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>Legacy ICU</td>\n","      <td>Bentall</td>\n","      <td>5</td>\n","      <td>Aorta chirurgie</td>\n","      <td>3</td>\n","      <td>Thoraxchirurgie</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>None</td>\n","      <td>1</td>\n","      <td>Cefazoline (Kefzol); Vancomycine</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>NICE APACHE IV</td>\n","      <td>CABG with aortic valve replacement</td>\n","      <td>237</td>\n","      <td>CABG en Klepchirurgie</td>\n","      <td>1</td>\n","      <td>Post-operative cardiovascular</td>\n","      <td>237</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>None</td>\n","      <td>1</td>\n","      <td>Cefazoline (Kefzol); Vancomycine</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>None</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>None</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>None</td>\n","      <td>1</td>\n","      <td>Cefazoline (Kefzol)</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>NICE APACHE IV</td>\n","      <td>CABG alone, coronary artery bypass grafting</td>\n","      <td>233</td>\n","      <td>CABG en Klepchirurgie</td>\n","      <td>1</td>\n","      <td>Post-operative cardiovascular</td>\n","      <td>233</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>None</td>\n","      <td>1</td>\n","      <td>Cefazoline (Kefzol)</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>None</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-57a905c4-4d6f-4ed8-a789-33555300a596')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-57a905c4-4d6f-4ed8-a789-33555300a596 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-57a905c4-4d6f-4ed8-a789-33555300a596');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["# set(df_reason_for_admission.diagnosis_group)"],"metadata":{"id":"4bhHDCLr9Tuf","executionInfo":{"status":"ok","timestamp":1686736732700,"user_tz":-120,"elapsed":48,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":36,"outputs":[]},{"cell_type":"code","execution_count":37,"metadata":{"id":"K9abqL_SKhhp","colab":{"base_uri":"https://localhost:8080/","height":224},"executionInfo":{"status":"ok","timestamp":1686736732701,"user_tz":-120,"elapsed":48,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"f5a1f683-6f94-4c3c-dfff-b02e0ec1e6cb"},"outputs":[{"output_type":"stream","name":"stdout","text":["(16980, 6) corrected columns: ['start', 'stop']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid  item     start      stop  duration\n","0            0   12634  Tube       5.7      19.2       810\n","1            1   12634  Tube  0.583333  7.333333       405\n","2            2   12634  Tube      0.15  2.766667       157\n","3            3   12634  Tube       1.9       8.9       420\n","4            4   12634  Tube  1.916667       9.8       473"],"text/html":["\n","  <div id=\"df-ba7923eb-e5d5-404c-8101-7bfc3a5d8e4f\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>start</th>\n","      <th>stop</th>\n","      <th>duration</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>12634</td>\n","      <td>Tube</td>\n","      <td>5.7</td>\n","      <td>19.2</td>\n","      <td>810</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>12634</td>\n","      <td>Tube</td>\n","      <td>0.583333</td>\n","      <td>7.333333</td>\n","      <td>405</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>12634</td>\n","      <td>Tube</td>\n","      <td>0.15</td>\n","      <td>2.766667</td>\n","      <td>157</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>12634</td>\n","      <td>Tube</td>\n","      <td>1.9</td>\n","      <td>8.9</td>\n","      <td>420</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>12634</td>\n","      <td>Tube</td>\n","      <td>1.916667</td>\n","      <td>9.8</td>\n","      <td>473</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ba7923eb-e5d5-404c-8101-7bfc3a5d8e4f')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-ba7923eb-e5d5-404c-8101-7bfc3a5d8e4f button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-ba7923eb-e5d5-404c-8101-7bfc3a5d8e4f');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}],"source":["df_tube_or_tracheostoma = get_items(\n","    sql = open(f'{sql_script_directory}/tube_or_tracheostoma.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/tube_or_tracheostoma.pickle',\n",")"]},{"cell_type":"code","execution_count":38,"metadata":{"id":"nJEIQ6iKdcAi","colab":{"base_uri":"https://localhost:8080/","height":224},"executionInfo":{"status":"ok","timestamp":1686736732705,"user_tz":-120,"elapsed":45,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"62f490e6-475d-4111-90d6-a185240c2158"},"outputs":[{"output_type":"stream","name":"stdout","text":["(1783, 6) corrected columns: ['start', 'stop']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid                   item       start        stop  \\\n","0           66   10740  Beademen non-invasief   58.566667   61.566667   \n","1           78   10740  Beademen non-invasief        0.15   28.066667   \n","2           94   10740  Beademen non-invasief  230.766667  259.433333   \n","3          105   10740  Beademen non-invasief   16.916667   27.533333   \n","4          134   10740  Beademen non-invasief    1.983333         8.7   \n","\n","   duration  \n","0       180  \n","1      1675  \n","2      1720  \n","3       637  \n","4       403  "],"text/html":["\n","  <div id=\"df-9e973d72-eab5-4da5-ab29-335fa258eefe\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>start</th>\n","      <th>stop</th>\n","      <th>duration</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>66</td>\n","      <td>10740</td>\n","      <td>Beademen non-invasief</td>\n","      <td>58.566667</td>\n","      <td>61.566667</td>\n","      <td>180</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>78</td>\n","      <td>10740</td>\n","      <td>Beademen non-invasief</td>\n","      <td>0.15</td>\n","      <td>28.066667</td>\n","      <td>1675</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>94</td>\n","      <td>10740</td>\n","      <td>Beademen non-invasief</td>\n","      <td>230.766667</td>\n","      <td>259.433333</td>\n","      <td>1720</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>105</td>\n","      <td>10740</td>\n","      <td>Beademen non-invasief</td>\n","      <td>16.916667</td>\n","      <td>27.533333</td>\n","      <td>637</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>134</td>\n","      <td>10740</td>\n","      <td>Beademen non-invasief</td>\n","      <td>1.983333</td>\n","      <td>8.7</td>\n","      <td>403</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9e973d72-eab5-4da5-ab29-335fa258eefe')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-9e973d72-eab5-4da5-ab29-335fa258eefe button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-9e973d72-eab5-4da5-ab29-335fa258eefe');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}],"source":["df_niv = get_items(\n","    sql = open(f'{sql_script_directory}/niv.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/niv.pickle',\n",")"]},{"cell_type":"code","execution_count":39,"metadata":{"id":"ry5UGLTPEHp2","colab":{"base_uri":"https://localhost:8080/","height":224},"executionInfo":{"status":"ok","timestamp":1686736735389,"user_tz":-120,"elapsed":2720,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"0169ac42-35df-4d25-d9bb-06c28a412bda"},"outputs":[{"output_type":"stream","name":"stdout","text":["(1343642, 11) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid                   item  valueid value  measuredat  \\\n","0            0   12290  Ventilatie Mode (Set)        2   PC          5.7   \n","1            0   12290  Ventilatie Mode (Set)        2   PC          6.2   \n","2            0   12290  Ventilatie Mode (Set)        2   PC          7.2   \n","3            0   12290  Ventilatie Mode (Set)        2   PC          8.2   \n","4            0   12290  Ventilatie Mode (Set)        2   PC          9.2   \n","\n","   registeredat           registeredby  updatedat              updatedby  \\\n","0          6.15  ICV_IC-Verpleegkundig       6.15  ICV_IC-Verpleegkundig   \n","1           7.3  ICV_IC-Verpleegkundig        7.3  ICV_IC-Verpleegkundig   \n","2           7.3  ICV_IC-Verpleegkundig        7.3  ICV_IC-Verpleegkundig   \n","3      8.266667  ICV_IC-Verpleegkundig   8.266667  ICV_IC-Verpleegkundig   \n","4     10.366667  ICV_IC-Verpleegkundig  10.366667  ICV_IC-Verpleegkundig   \n","\n","   islabresult  \n","0            0  \n","1            0  \n","2            0  \n","3            0  \n","4            0  "],"text/html":["\n","  <div id=\"df-4a1e77e8-ccef-41d2-8e49-2de4e3faa4bc\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>valueid</th>\n","      <th>value</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>12290</td>\n","      <td>Ventilatie Mode (Set)</td>\n","      <td>2</td>\n","      <td>PC</td>\n","      <td>5.7</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>12290</td>\n","      <td>Ventilatie Mode (Set)</td>\n","      <td>2</td>\n","      <td>PC</td>\n","      <td>6.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>12290</td>\n","      <td>Ventilatie Mode (Set)</td>\n","      <td>2</td>\n","      <td>PC</td>\n","      <td>7.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>12290</td>\n","      <td>Ventilatie Mode (Set)</td>\n","      <td>2</td>\n","      <td>PC</td>\n","      <td>8.2</td>\n","      <td>8.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>8.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>12290</td>\n","      <td>Ventilatie Mode (Set)</td>\n","      <td>2</td>\n","      <td>PC</td>\n","      <td>9.2</td>\n","      <td>10.366667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>10.366667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-4a1e77e8-ccef-41d2-8e49-2de4e3faa4bc')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-4a1e77e8-ccef-41d2-8e49-2de4e3faa4bc button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-4a1e77e8-ccef-41d2-8e49-2de4e3faa4bc');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}],"source":["df_iv = get_items(\n","    sql = open(f'{sql_script_directory}/iv.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/iv.pickle',\n",")"]},{"cell_type":"code","execution_count":40,"metadata":{"id":"y0XC80fZa1mJ","colab":{"base_uri":"https://localhost:8080/","height":355},"executionInfo":{"status":"ok","timestamp":1686736738311,"user_tz":-120,"elapsed":2930,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"25bb33bf-f4b2-456a-874a-d2d0671df94c"},"outputs":[{"output_type":"stream","name":"stdout","text":["(1436369, 15) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid        item tag  value  unitid   unit  \\\n","0            0   12284  PEEP (Set)        7.0     175  cmH2O   \n","1            0   12284  PEEP (Set)        7.0     175  cmH2O   \n","2            0   12284  PEEP (Set)        7.0     175  cmH2O   \n","3            0   12284  PEEP (Set)        7.0     175  cmH2O   \n","4            0   12284  PEEP (Set)        7.0     175  cmH2O   \n","\n","                comment  measuredat  registeredat           registeredby  \\\n","0  Opmerking verwijderd         5.7          6.15  ICV_IC-Verpleegkundig   \n","1  Opmerking verwijderd         6.2           7.3  ICV_IC-Verpleegkundig   \n","2  Opmerking verwijderd         7.2           7.3  ICV_IC-Verpleegkundig   \n","3  Opmerking verwijderd         8.2      8.266667  ICV_IC-Verpleegkundig   \n","4  Opmerking verwijderd         9.2     10.366667  ICV_IC-Verpleegkundig   \n","\n","   updatedat              updatedby  islabresult  fluidout  \n","0       6.15  ICV_IC-Verpleegkundig            0      <NA>  \n","1        7.3  ICV_IC-Verpleegkundig            0      <NA>  \n","2        7.3  ICV_IC-Verpleegkundig            0      <NA>  \n","3   8.266667  ICV_IC-Verpleegkundig            0      <NA>  \n","4  10.366667  ICV_IC-Verpleegkundig            0      <NA>  "],"text/html":["\n","  <div id=\"df-86003431-2e5b-4686-84f1-a3e00c0beaf1\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>tag</th>\n","      <th>value</th>\n","      <th>unitid</th>\n","      <th>unit</th>\n","      <th>comment</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","      <th>fluidout</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>12284</td>\n","      <td>PEEP (Set)</td>\n","      <td></td>\n","      <td>7.0</td>\n","      <td>175</td>\n","      <td>cmH2O</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>12284</td>\n","      <td>PEEP (Set)</td>\n","      <td></td>\n","      <td>7.0</td>\n","      <td>175</td>\n","      <td>cmH2O</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>12284</td>\n","      <td>PEEP (Set)</td>\n","      <td></td>\n","      <td>7.0</td>\n","      <td>175</td>\n","      <td>cmH2O</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>7.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>12284</td>\n","      <td>PEEP (Set)</td>\n","      <td></td>\n","      <td>7.0</td>\n","      <td>175</td>\n","      <td>cmH2O</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>8.2</td>\n","      <td>8.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>8.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>12284</td>\n","      <td>PEEP (Set)</td>\n","      <td></td>\n","      <td>7.0</td>\n","      <td>175</td>\n","      <td>cmH2O</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>9.2</td>\n","      <td>10.366667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>10.366667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-86003431-2e5b-4686-84f1-a3e00c0beaf1')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-86003431-2e5b-4686-84f1-a3e00c0beaf1 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-86003431-2e5b-4686-84f1-a3e00c0beaf1');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}],"source":["df_peep = get_items(\n","    sql = open(f'{sql_script_directory}/peep.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/peep.pickle',\n",")"]},{"cell_type":"code","source":["df_peak = get_items(\n","    sql = open(f'{sql_script_directory}/peak.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/peak.pickle',\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":268},"id":"HZfAXP2z4-LQ","executionInfo":{"status":"ok","timestamp":1686736740901,"user_tz":-120,"elapsed":2601,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"eeffb3b5-7fd5-400e-b2ff-8932192e44b8"},"execution_count":41,"outputs":[{"output_type":"stream","name":"stdout","text":["(1406777, 15) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid       item tag  value  unitid   unit  \\\n","0            0   12281  Piek druk       19.0     175  cmH2O   \n","1            0   12281  Piek druk       19.0     175  cmH2O   \n","2            0   12281  Piek druk       19.0     175  cmH2O   \n","3            0   12281  Piek druk       19.0     175  cmH2O   \n","4            0   12281  Piek druk       19.0     175  cmH2O   \n","\n","                comment  measuredat  registeredat           registeredby  \\\n","0  Opmerking verwijderd         5.7          6.15  ICV_IC-Verpleegkundig   \n","1  Opmerking verwijderd         6.2           7.3  ICV_IC-Verpleegkundig   \n","2  Opmerking verwijderd         7.2           7.3  ICV_IC-Verpleegkundig   \n","3  Opmerking verwijderd         8.2      8.266667  ICV_IC-Verpleegkundig   \n","4  Opmerking verwijderd         9.2     10.366667  ICV_IC-Verpleegkundig   \n","\n","   updatedat              updatedby  islabresult  fluidout  \n","0       6.15  ICV_IC-Verpleegkundig            0      <NA>  \n","1        7.3  ICV_IC-Verpleegkundig            0      <NA>  \n","2        7.3  ICV_IC-Verpleegkundig            0      <NA>  \n","3   8.266667  ICV_IC-Verpleegkundig            0      <NA>  \n","4  10.366667  ICV_IC-Verpleegkundig            0      <NA>  "],"text/html":["\n","  <div id=\"df-a97dea0c-d15d-485c-8779-169b554e179b\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>tag</th>\n","      <th>value</th>\n","      <th>unitid</th>\n","      <th>unit</th>\n","      <th>comment</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","      <th>fluidout</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>12281</td>\n","      <td>Piek druk</td>\n","      <td></td>\n","      <td>19.0</td>\n","      <td>175</td>\n","      <td>cmH2O</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>12281</td>\n","      <td>Piek druk</td>\n","      <td></td>\n","      <td>19.0</td>\n","      <td>175</td>\n","      <td>cmH2O</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>12281</td>\n","      <td>Piek druk</td>\n","      <td></td>\n","      <td>19.0</td>\n","      <td>175</td>\n","      <td>cmH2O</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>7.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>12281</td>\n","      <td>Piek druk</td>\n","      <td></td>\n","      <td>19.0</td>\n","      <td>175</td>\n","      <td>cmH2O</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>8.2</td>\n","      <td>8.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>8.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>12281</td>\n","      <td>Piek druk</td>\n","      <td></td>\n","      <td>19.0</td>\n","      <td>175</td>\n","      <td>cmH2O</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>9.2</td>\n","      <td>10.366667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>10.366667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a97dea0c-d15d-485c-8779-169b554e179b')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a97dea0c-d15d-485c-8779-169b554e179b button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a97dea0c-d15d-485c-8779-169b554e179b');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","execution_count":42,"metadata":{"id":"WAX7iyegyp7k","colab":{"base_uri":"https://localhost:8080/","height":355},"executionInfo":{"status":"ok","timestamp":1686736744552,"user_tz":-120,"elapsed":3655,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"a862caaf-f0a1-4cf5-c0e9-be6c37a32146"},"outputs":[{"output_type":"stream","name":"stdout","text":["(2048461, 16) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid       item tag  value  unitid  unit  \\\n","0            0   12266  Ademfreq.       13.0      15  /min   \n","1            0   12266  Ademfreq.       13.0      15  /min   \n","2            0   12266  Ademfreq.       13.0      15  /min   \n","3            0   12266  Ademfreq.       13.0      15  /min   \n","4            0   12266  Ademfreq.       13.0      15  /min   \n","\n","                comment  measuredat  registeredat           registeredby  \\\n","0  Opmerking verwijderd         5.7          6.15  ICV_IC-Verpleegkundig   \n","1  Opmerking verwijderd         6.2           7.3  ICV_IC-Verpleegkundig   \n","2  Opmerking verwijderd         7.2           7.3  ICV_IC-Verpleegkundig   \n","3  Opmerking verwijderd         8.2      8.266667  ICV_IC-Verpleegkundig   \n","4  Opmerking verwijderd         9.2     10.366667  ICV_IC-Verpleegkundig   \n","\n","   updatedat              updatedby  islabresult  fluidout  priority  \n","0       6.15  ICV_IC-Verpleegkundig            0      <NA>         1  \n","1        7.3  ICV_IC-Verpleegkundig            0      <NA>         1  \n","2        7.3  ICV_IC-Verpleegkundig            0      <NA>         1  \n","3   8.266667  ICV_IC-Verpleegkundig            0      <NA>         1  \n","4  10.366667  ICV_IC-Verpleegkundig            0      <NA>         1  "],"text/html":["\n","  <div id=\"df-bc376654-ef72-4fc9-a351-d5c6874e8b4c\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>tag</th>\n","      <th>value</th>\n","      <th>unitid</th>\n","      <th>unit</th>\n","      <th>comment</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","      <th>fluidout</th>\n","      <th>priority</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>12266</td>\n","      <td>Ademfreq.</td>\n","      <td></td>\n","      <td>13.0</td>\n","      <td>15</td>\n","      <td>/min</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>12266</td>\n","      <td>Ademfreq.</td>\n","      <td></td>\n","      <td>13.0</td>\n","      <td>15</td>\n","      <td>/min</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>12266</td>\n","      <td>Ademfreq.</td>\n","      <td></td>\n","      <td>13.0</td>\n","      <td>15</td>\n","      <td>/min</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>7.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>12266</td>\n","      <td>Ademfreq.</td>\n","      <td></td>\n","      <td>13.0</td>\n","      <td>15</td>\n","      <td>/min</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>8.2</td>\n","      <td>8.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>8.266667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>12266</td>\n","      <td>Ademfreq.</td>\n","      <td></td>\n","      <td>13.0</td>\n","      <td>15</td>\n","      <td>/min</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>9.2</td>\n","      <td>10.366667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>10.366667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-bc376654-ef72-4fc9-a351-d5c6874e8b4c')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-bc376654-ef72-4fc9-a351-d5c6874e8b4c button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-bc376654-ef72-4fc9-a351-d5c6874e8b4c');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}],"source":["df_rr = get_items(\n","    sql = open(f'{sql_script_directory}/rr.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/rr.pickle',\n",")"]},{"cell_type":"code","execution_count":43,"metadata":{"id":"O2fkyWvwzVq-","colab":{"base_uri":"https://localhost:8080/","height":355},"executionInfo":{"status":"ok","timestamp":1686736749083,"user_tz":-120,"elapsed":4537,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"23e35274-4e34-4d24-d72b-f33afdf478a9"},"outputs":[{"output_type":"stream","name":"stdout","text":["(2606236, 15) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid                item tag  value  unitid unit  \\\n","0            0   12275   Exp. tidal volume      443.0       6   ml   \n","1            0   12277  Insp. tidal volume      425.0       6   ml   \n","2            0   12275   Exp. tidal volume      469.0       6   ml   \n","3            0   12277  Insp. tidal volume      450.0       6   ml   \n","4            0   12275   Exp. tidal volume      483.0       6   ml   \n","\n","                comment  measuredat  registeredat           registeredby  \\\n","0  Opmerking verwijderd         5.7          6.15  ICV_IC-Verpleegkundig   \n","1  Opmerking verwijderd         5.7          6.15  ICV_IC-Verpleegkundig   \n","2  Opmerking verwijderd         6.2           7.3  ICV_IC-Verpleegkundig   \n","3  Opmerking verwijderd         6.2           7.3  ICV_IC-Verpleegkundig   \n","4  Opmerking verwijderd         7.2           7.3  ICV_IC-Verpleegkundig   \n","\n","   updatedat              updatedby  islabresult  fluidout  \n","0       6.15  ICV_IC-Verpleegkundig            0      <NA>  \n","1       6.15  ICV_IC-Verpleegkundig            0      <NA>  \n","2        7.3  ICV_IC-Verpleegkundig            0      <NA>  \n","3        7.3  ICV_IC-Verpleegkundig            0      <NA>  \n","4        7.3  ICV_IC-Verpleegkundig            0      <NA>  "],"text/html":["\n","  <div id=\"df-eaa81d0f-3779-4803-8aab-bb1f1bd3f9c0\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>tag</th>\n","      <th>value</th>\n","      <th>unitid</th>\n","      <th>unit</th>\n","      <th>comment</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","      <th>fluidout</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>12275</td>\n","      <td>Exp. tidal volume</td>\n","      <td></td>\n","      <td>443.0</td>\n","      <td>6</td>\n","      <td>ml</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>12277</td>\n","      <td>Insp. tidal volume</td>\n","      <td></td>\n","      <td>425.0</td>\n","      <td>6</td>\n","      <td>ml</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>12275</td>\n","      <td>Exp. tidal volume</td>\n","      <td></td>\n","      <td>469.0</td>\n","      <td>6</td>\n","      <td>ml</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>12277</td>\n","      <td>Insp. tidal volume</td>\n","      <td></td>\n","      <td>450.0</td>\n","      <td>6</td>\n","      <td>ml</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>12275</td>\n","      <td>Exp. tidal volume</td>\n","      <td></td>\n","      <td>483.0</td>\n","      <td>6</td>\n","      <td>ml</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>7.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-eaa81d0f-3779-4803-8aab-bb1f1bd3f9c0')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-eaa81d0f-3779-4803-8aab-bb1f1bd3f9c0 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-eaa81d0f-3779-4803-8aab-bb1f1bd3f9c0');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}],"source":["df_tidal = get_items(\n","    sql = open(f'{sql_script_directory}/tidal.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/tidal.pickle',\n",")"]},{"cell_type":"code","execution_count":44,"metadata":{"id":"X1RBSJJq0PVy","colab":{"base_uri":"https://localhost:8080/","height":355},"executionInfo":{"status":"ok","timestamp":1686736753934,"user_tz":-120,"elapsed":4866,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"f6de7347-917f-4207-bb41-359a9f5978a7"},"outputs":[{"output_type":"stream","name":"stdout","text":["(2579975, 15) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid                 item tag  value  unitid   unit  \\\n","0            0   12273   Exp. minuut volume        5.8      26  l/min   \n","1            0   12276  Insp. Minuut volume        5.7      26  l/min   \n","2            0   12273   Exp. minuut volume        6.0      26  l/min   \n","3            0   12276  Insp. Minuut volume        5.9      26  l/min   \n","4            0   12273   Exp. minuut volume        6.2      26  l/min   \n","\n","                comment  measuredat  registeredat           registeredby  \\\n","0  Opmerking verwijderd         5.7          6.15  ICV_IC-Verpleegkundig   \n","1  Opmerking verwijderd         5.7          6.15  ICV_IC-Verpleegkundig   \n","2  Opmerking verwijderd         6.2           7.3  ICV_IC-Verpleegkundig   \n","3  Opmerking verwijderd         6.2           7.3  ICV_IC-Verpleegkundig   \n","4  Opmerking verwijderd         7.2           7.3  ICV_IC-Verpleegkundig   \n","\n","   updatedat              updatedby  islabresult  fluidout  \n","0       6.15  ICV_IC-Verpleegkundig            0      <NA>  \n","1       6.15  ICV_IC-Verpleegkundig            0      <NA>  \n","2        7.3  ICV_IC-Verpleegkundig            0      <NA>  \n","3        7.3  ICV_IC-Verpleegkundig            0      <NA>  \n","4        7.3  ICV_IC-Verpleegkundig            0      <NA>  "],"text/html":["\n","  <div id=\"df-a24f3104-23b5-4da8-ae67-14d389a4d7ea\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>tag</th>\n","      <th>value</th>\n","      <th>unitid</th>\n","      <th>unit</th>\n","      <th>comment</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","      <th>fluidout</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>12273</td>\n","      <td>Exp. minuut volume</td>\n","      <td></td>\n","      <td>5.8</td>\n","      <td>26</td>\n","      <td>l/min</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>12276</td>\n","      <td>Insp. Minuut volume</td>\n","      <td></td>\n","      <td>5.7</td>\n","      <td>26</td>\n","      <td>l/min</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.15</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>12273</td>\n","      <td>Exp. minuut volume</td>\n","      <td></td>\n","      <td>6.0</td>\n","      <td>26</td>\n","      <td>l/min</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>12276</td>\n","      <td>Insp. Minuut volume</td>\n","      <td></td>\n","      <td>5.9</td>\n","      <td>26</td>\n","      <td>l/min</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>12273</td>\n","      <td>Exp. minuut volume</td>\n","      <td></td>\n","      <td>6.2</td>\n","      <td>26</td>\n","      <td>l/min</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>7.2</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>7.3</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a24f3104-23b5-4da8-ae67-14d389a4d7ea')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a24f3104-23b5-4da8-ae67-14d389a4d7ea button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a24f3104-23b5-4da8-ae67-14d389a4d7ea');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}],"source":["df_minute_vol = get_items(\n","    sql = open(f'{sql_script_directory}/minute_vol.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/minute_vol.pickle',\n",")"]},{"cell_type":"code","execution_count":45,"metadata":{"id":"vxLVIn1P0alp","colab":{"base_uri":"https://localhost:8080/","height":355},"executionInfo":{"status":"ok","timestamp":1686736754874,"user_tz":-120,"elapsed":952,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"fb08f696-ed1a-4088-9026-98f8e06b71cb"},"outputs":[{"output_type":"stream","name":"stdout","text":["(667443, 15) corrected columns: ['measuredat', 'registeredat', 'updatedat']\n"]},{"output_type":"display_data","data":{"text/plain":["   admissionid  itemid                        item tag  value  unitid  unit  \\\n","0            0    6707  End tidal CO2 concentratie       34.0     173  mmHg   \n","1            0    6707  End tidal CO2 concentratie       34.0     173  mmHg   \n","2            0    6707  End tidal CO2 concentratie       35.0     173  mmHg   \n","3            0    6707  End tidal CO2 concentratie       35.0     173  mmHg   \n","4            0    6707  End tidal CO2 concentratie       36.0     173  mmHg   \n","\n","                comment  measuredat  registeredat           registeredby  \\\n","0  Opmerking verwijderd         5.7      6.166667  ICV_IC-Verpleegkundig   \n","1  Opmerking verwijderd         6.2     10.366667  ICV_IC-Verpleegkundig   \n","2  Opmerking verwijderd         8.2     10.366667  ICV_IC-Verpleegkundig   \n","3  Opmerking verwijderd        10.2     10.366667  ICV_IC-Verpleegkundig   \n","4  Opmerking verwijderd        12.2     12.633333  ICV_IC-Verpleegkundig   \n","\n","   updatedat              updatedby  islabresult  fluidout  \n","0   6.171843  ICV_IC-Verpleegkundig            0      <NA>  \n","1   10.38058  ICV_IC-Verpleegkundig            0      <NA>  \n","2  10.381208  ICV_IC-Verpleegkundig            0      <NA>  \n","3  10.381659  ICV_IC-Verpleegkundig            0      <NA>  \n","4  12.643613  ICV_IC-Verpleegkundig            0      <NA>  "],"text/html":["\n","  <div id=\"df-bb6c62f4-fe60-4450-a438-2fcbae3ec36d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>itemid</th>\n","      <th>item</th>\n","      <th>tag</th>\n","      <th>value</th>\n","      <th>unitid</th>\n","      <th>unit</th>\n","      <th>comment</th>\n","      <th>measuredat</th>\n","      <th>registeredat</th>\n","      <th>registeredby</th>\n","      <th>updatedat</th>\n","      <th>updatedby</th>\n","      <th>islabresult</th>\n","      <th>fluidout</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6707</td>\n","      <td>End tidal CO2 concentratie</td>\n","      <td></td>\n","      <td>34.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>5.7</td>\n","      <td>6.166667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>6.171843</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>6707</td>\n","      <td>End tidal CO2 concentratie</td>\n","      <td></td>\n","      <td>34.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>6.2</td>\n","      <td>10.366667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>10.38058</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>6707</td>\n","      <td>End tidal CO2 concentratie</td>\n","      <td></td>\n","      <td>35.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>8.2</td>\n","      <td>10.366667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>10.381208</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>6707</td>\n","      <td>End tidal CO2 concentratie</td>\n","      <td></td>\n","      <td>35.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>10.2</td>\n","      <td>10.366667</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>10.381659</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>6707</td>\n","      <td>End tidal CO2 concentratie</td>\n","      <td></td>\n","      <td>36.0</td>\n","      <td>173</td>\n","      <td>mmHg</td>\n","      <td>Opmerking verwijderd</td>\n","      <td>12.2</td>\n","      <td>12.633333</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>12.643613</td>\n","      <td>ICV_IC-Verpleegkundig</td>\n","      <td>0</td>\n","      <td>&lt;NA&gt;</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-bb6c62f4-fe60-4450-a438-2fcbae3ec36d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-bb6c62f4-fe60-4450-a438-2fcbae3ec36d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-bb6c62f4-fe60-4450-a438-2fcbae3ec36d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}],"source":["df_end_tidal_co2 = get_items(\n","    sql = open(f'{sql_script_directory}/end_tidal_co2.sql', 'r').read(),\n","    pickle_file = f'{pickles_directory}/end_tidal_co2.pickle',\n",")"]},{"cell_type":"code","source":[],"metadata":{"id":"8gKV92HIMf0m","executionInfo":{"status":"ok","timestamp":1686736754875,"user_tz":-120,"elapsed":6,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":45,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"z4lpIt5tMf3U","executionInfo":{"status":"ok","timestamp":1686736754876,"user_tz":-120,"elapsed":6,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":45,"outputs":[]},{"cell_type":"markdown","source":["# bookmark4"],"metadata":{"id":"DfNoMqhaRWGo"}},{"cell_type":"code","source":["temp =[]\n","\n","for x in [x for x in globals().keys() if x.startswith('df_')]:\n","  # print(x)\n","  temp_df = globals()[x]\n","  # print(temp_df.columns)\n","  inner_l = [x]\n","  inner_l.append(temp_df.shape[0])\n","  if 'admissionid' in temp_df.columns and 'measuredat' in temp_df.columns:\n","    # print('xxx', x)\n","    asd = temp_df[['admissionid', 'measuredat']]\n","    asd = asd.drop_duplicates()\n","    inner_l.append(asd.shape[0])\n","    asd = asd.astype(int).drop_duplicates()\n","    inner_l.append(asd.shape[0])\n","  else:\n","    inner_l.append(np.nan)\n","    inner_l.append(np.nan)\n","\n","  if 'unit' in temp_df.columns:\n","    inner_l.append(', '.join(temp_df['unit'].drop_duplicates()))\n","  else:\n","    inner_l.append(np.nan)\n","\n","  inner_l.append(', '.join(temp_df.columns))\n","  temp.append(inner_l)\n","pd.DataFrame(temp, columns=['df_name', 'len', 'not_dup', 'not_dup_int', 'unit', 'columns',]).sort_values('df_name')"],"metadata":{"id":"SCShYvUD8_w0","colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"ok","timestamp":1686736763526,"user_tz":-120,"elapsed":8656,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"45b9d2c4-ddca-4207-eb89-f201bd65b020"},"execution_count":46,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                    df_name      len    not_dup  not_dup_int  \\\n","9          df_a2_creatinine   202700   202217.0     200729.0   \n","6                 df_a2_gcs    19459    19459.0      19459.0   \n","8                  df_a2_ht   702411   689348.0     611126.0   \n","14           df_a2_mean_abp  2233222  2221737.0    2163222.0   \n","13        df_a2_oxygenation   662585   662585.0     637080.0   \n","12                 df_a2_ph   665531   665177.0     638972.0   \n","10          df_a2_potassium   791488   774588.0     694441.0   \n","11             df_a2_sodium   782330   765623.0     685428.0   \n","15        df_a2_temperature   866517   829297.0     813387.0   \n","7                 df_a2_wbc   197648   197170.0     195528.0   \n","1             df_admissions    23106        NaN          NaN   \n","5              df_bilirubin    59106    58942.0      58658.0   \n","17                   df_dbp  2233449  2221985.0    2163489.0   \n","31         df_end_tidal_co2   667443   667282.0     661754.0   \n","21                   df_gcs    75797    75797.0      68635.0   \n","19                    df_hr  2218626  2218624.0    2176422.0   \n","20                df_insp_p  1418391  1265228.0    1214307.0   \n","4              df_insp_time  1140506  1140506.0    1117032.0   \n","25                    df_iv  1343642  1343193.0    1313309.0   \n","2                    df_map  2233222  2221737.0    2163222.0   \n","0              df_mech_vent    16593        NaN          NaN   \n","30            df_minute_vol  2579975  1283161.0    1252291.0   \n","24                   df_niv     1783        NaN          NaN   \n","27                  df_peak  1406777  1357765.0    1326902.0   \n","26                  df_peep  1436369  1362467.0    1330474.0   \n","16                   df_plt   221653   221162.0     216846.0   \n","22  df_reason_for_admission    23106        NaN          NaN   \n","28                    df_rr  2048461  2048461.0    1982108.0   \n","18                   df_sbp  2235252  2222485.0    2163832.0   \n","3                   df_spo2  2076750  2076750.0    2026188.0   \n","29                 df_tidal  2606236  1311020.0    1280002.0   \n","23  df_tube_or_tracheostoma    16980        NaN          NaN   \n","\n","                unit                                            columns  \n","9       µmol/l, µmol  admissionid, itemid, item, value, registeredby...  \n","6                NaN  admissionid, measuredat, eyes_score, motor_sco...  \n","8            Geen, l  admissionid, measuredat, unit, itemid, item, v...  \n","14              mmHg  admissionid, itemid, item, tag, value, unitid,...  \n","13               NaN  admissionid, PaO2, PaCO2, specimen_source, man...  \n","12               NaN  admissionid, measuredat, value, itemid, item, ...  \n","10            mmol/l  admissionid, measuredat, itemid, item, value, ...  \n","11            mmol/l  admissionid, measuredat, itemid, item, value, ...  \n","15                °C  admissionid, itemid, item, tag, value, unitid,...  \n","7             10^9/l  admissionid, measuredat, unit, itemid, item, v...  \n","1                NaN  patientid, admissionid, admissioncount, locati...  \n","5                NaN  admissionid, measuredat, itemid, item, value, ...  \n","17              mmHg  admissionid, itemid, item, tag, value, unitid,...  \n","31  mmHg, None, Geen  admissionid, itemid, item, tag, value, unitid,...  \n","21               NaN  admissionid, measuredat, time, eyes_score, mot...  \n","19              /min  admissionid, itemid, item, tag, value, unitid,...  \n","20             cmH2O  admissionid, itemid, item, tag, value, unitid,...  \n","4                sec  admissionid, itemid, item, tag, value, unitid,...  \n","25               NaN  admissionid, itemid, item, valueid, value, mea...  \n","2               mmHg  admissionid, itemid, item, tag, value, unitid,...  \n","0                NaN  admissionid, mechanical_ventilation_bool, mech...  \n","30             l/min  admissionid, itemid, item, tag, value, unitid,...  \n","24               NaN   admissionid, itemid, item, start, stop, duration  \n","27       cmH2O, mbar  admissionid, itemid, item, tag, value, unitid,...  \n","26       cmH2O, mbar  admissionid, itemid, item, tag, value, unitid,...  \n","16            10^9/l  admissionid, itemid, item, tag, value, unitid,...  \n","22               NaN  admissionid, diagnosis_type, diagnosis, diagno...  \n","28        /min, None  admissionid, itemid, item, tag, value, unitid,...  \n","18              mmHg  admissionid, itemid, item, tag, value, unitid,...  \n","3               None  admissionid, itemid, item, tag, value, unitid,...  \n","29                ml  admissionid, itemid, item, tag, value, unitid,...  \n","23               NaN   admissionid, itemid, item, start, stop, duration  "],"text/html":["\n","  <div id=\"df-035cbb9a-882c-4431-a979-b6abb0d6e524\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>df_name</th>\n","      <th>len</th>\n","      <th>not_dup</th>\n","      <th>not_dup_int</th>\n","      <th>unit</th>\n","      <th>columns</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>9</th>\n","      <td>df_a2_creatinine</td>\n","      <td>202700</td>\n","      <td>202217.0</td>\n","      <td>200729.0</td>\n","      <td>µmol/l, µmol</td>\n","      <td>admissionid, itemid, item, value, registeredby...</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>df_a2_gcs</td>\n","      <td>19459</td>\n","      <td>19459.0</td>\n","      <td>19459.0</td>\n","      <td>NaN</td>\n","      <td>admissionid, measuredat, eyes_score, motor_sco...</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>df_a2_ht</td>\n","      <td>702411</td>\n","      <td>689348.0</td>\n","      <td>611126.0</td>\n","      <td>Geen, l</td>\n","      <td>admissionid, measuredat, unit, itemid, item, v...</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>df_a2_mean_abp</td>\n","      <td>2233222</td>\n","      <td>2221737.0</td>\n","      <td>2163222.0</td>\n","      <td>mmHg</td>\n","      <td>admissionid, itemid, item, tag, value, unitid,...</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>df_a2_oxygenation</td>\n","      <td>662585</td>\n","      <td>662585.0</td>\n","      <td>637080.0</td>\n","      <td>NaN</td>\n","      <td>admissionid, PaO2, PaCO2, specimen_source, man...</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>df_a2_ph</td>\n","      <td>665531</td>\n","      <td>665177.0</td>\n","      <td>638972.0</td>\n","      <td>NaN</td>\n","      <td>admissionid, measuredat, value, itemid, item, ...</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>df_a2_potassium</td>\n","      <td>791488</td>\n","      <td>774588.0</td>\n","      <td>694441.0</td>\n","      <td>mmol/l</td>\n","      <td>admissionid, measuredat, itemid, item, value, ...</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>df_a2_sodium</td>\n","      <td>782330</td>\n","      <td>765623.0</td>\n","      <td>685428.0</td>\n","      <td>mmol/l</td>\n","      <td>admissionid, measuredat, itemid, item, value, ...</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>df_a2_temperature</td>\n","      <td>866517</td>\n","      <td>829297.0</td>\n","      <td>813387.0</td>\n","      <td>°C</td>\n","      <td>admissionid, itemid, item, tag, value, unitid,...</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>df_a2_wbc</td>\n","      <td>197648</td>\n","      <td>197170.0</td>\n","      <td>195528.0</td>\n","      <td>10^9/l</td>\n","      <td>admissionid, measuredat, unit, itemid, item, v...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>df_admissions</td>\n","      <td>23106</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>patientid, admissionid, admissioncount, locati...</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>df_bilirubin</td>\n","      <td>59106</td>\n","      <td>58942.0</td>\n","      <td>58658.0</td>\n","      <td>NaN</td>\n","      <td>admissionid, measuredat, itemid, item, value, ...</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>df_dbp</td>\n","      <td>2233449</td>\n","      <td>2221985.0</td>\n","      <td>2163489.0</td>\n","      <td>mmHg</td>\n","      <td>admissionid, itemid, item, tag, value, unitid,...</td>\n","    </tr>\n","    <tr>\n","      <th>31</th>\n","      <td>df_end_tidal_co2</td>\n","      <td>667443</td>\n","      <td>667282.0</td>\n","      <td>661754.0</td>\n","      <td>mmHg, None, Geen</td>\n","      <td>admissionid, itemid, item, tag, value, unitid,...</td>\n","    </tr>\n","    <tr>\n","      <th>21</th>\n","      <td>df_gcs</td>\n","      <td>75797</td>\n","      <td>75797.0</td>\n","      <td>68635.0</td>\n","      <td>NaN</td>\n","      <td>admissionid, measuredat, time, eyes_score, mot...</td>\n","    </tr>\n","    <tr>\n","      <th>19</th>\n","      <td>df_hr</td>\n","      <td>2218626</td>\n","      <td>2218624.0</td>\n","      <td>2176422.0</td>\n","      <td>/min</td>\n","      <td>admissionid, itemid, item, tag, value, unitid,...</td>\n","    </tr>\n","    <tr>\n","      <th>20</th>\n","      <td>df_insp_p</td>\n","      <td>1418391</td>\n","      <td>1265228.0</td>\n","      <td>1214307.0</td>\n","      <td>cmH2O</td>\n","      <td>admissionid, itemid, item, tag, value, unitid,...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>df_insp_time</td>\n","      <td>1140506</td>\n","      <td>1140506.0</td>\n","      <td>1117032.0</td>\n","      <td>sec</td>\n","      <td>admissionid, itemid, item, tag, value, unitid,...</td>\n","    </tr>\n","    <tr>\n","      <th>25</th>\n","      <td>df_iv</td>\n","      <td>1343642</td>\n","      <td>1343193.0</td>\n","      <td>1313309.0</td>\n","      <td>NaN</td>\n","      <td>admissionid, itemid, item, valueid, value, mea...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>df_map</td>\n","      <td>2233222</td>\n","      <td>2221737.0</td>\n","      <td>2163222.0</td>\n","      <td>mmHg</td>\n","      <td>admissionid, itemid, item, tag, value, unitid,...</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>df_mech_vent</td>\n","      <td>16593</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>admissionid, mechanical_ventilation_bool, mech...</td>\n","    </tr>\n","    <tr>\n","      <th>30</th>\n","      <td>df_minute_vol</td>\n","      <td>2579975</td>\n","      <td>1283161.0</td>\n","      <td>1252291.0</td>\n","      <td>l/min</td>\n","      <td>admissionid, itemid, item, tag, value, unitid,...</td>\n","    </tr>\n","    <tr>\n","      <th>24</th>\n","      <td>df_niv</td>\n","      <td>1783</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>admissionid, itemid, item, start, stop, duration</td>\n","    </tr>\n","    <tr>\n","      <th>27</th>\n","      <td>df_peak</td>\n","      <td>1406777</td>\n","      <td>1357765.0</td>\n","      <td>1326902.0</td>\n","      <td>cmH2O, mbar</td>\n","      <td>admissionid, itemid, item, tag, value, unitid,...</td>\n","    </tr>\n","    <tr>\n","      <th>26</th>\n","      <td>df_peep</td>\n","      <td>1436369</td>\n","      <td>1362467.0</td>\n","      <td>1330474.0</td>\n","      <td>cmH2O, mbar</td>\n","      <td>admissionid, itemid, item, tag, value, unitid,...</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>df_plt</td>\n","      <td>221653</td>\n","      <td>221162.0</td>\n","      <td>216846.0</td>\n","      <td>10^9/l</td>\n","      <td>admissionid, itemid, item, tag, value, unitid,...</td>\n","    </tr>\n","    <tr>\n","      <th>22</th>\n","      <td>df_reason_for_admission</td>\n","      <td>23106</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>admissionid, diagnosis_type, diagnosis, diagno...</td>\n","    </tr>\n","    <tr>\n","      <th>28</th>\n","      <td>df_rr</td>\n","      <td>2048461</td>\n","      <td>2048461.0</td>\n","      <td>1982108.0</td>\n","      <td>/min, None</td>\n","      <td>admissionid, itemid, item, tag, value, unitid,...</td>\n","    </tr>\n","    <tr>\n","      <th>18</th>\n","      <td>df_sbp</td>\n","      <td>2235252</td>\n","      <td>2222485.0</td>\n","      <td>2163832.0</td>\n","      <td>mmHg</td>\n","      <td>admissionid, itemid, item, tag, value, unitid,...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>df_spo2</td>\n","      <td>2076750</td>\n","      <td>2076750.0</td>\n","      <td>2026188.0</td>\n","      <td>None</td>\n","      <td>admissionid, itemid, item, tag, value, unitid,...</td>\n","    </tr>\n","    <tr>\n","      <th>29</th>\n","      <td>df_tidal</td>\n","      <td>2606236</td>\n","      <td>1311020.0</td>\n","      <td>1280002.0</td>\n","      <td>ml</td>\n","      <td>admissionid, itemid, item, tag, value, unitid,...</td>\n","    </tr>\n","    <tr>\n","      <th>23</th>\n","      <td>df_tube_or_tracheostoma</td>\n","      <td>16980</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>admissionid, itemid, item, start, stop, duration</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-035cbb9a-882c-4431-a979-b6abb0d6e524')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-035cbb9a-882c-4431-a979-b6abb0d6e524 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-035cbb9a-882c-4431-a979-b6abb0d6e524');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":46}]},{"cell_type":"code","source":["df_tube_or_tracheostoma2 = df_tube_or_tracheostoma.copy()\n","# df_tube_or_tracheostoma2 = df_tube_or_tracheostoma2.head(1000).copy()\n","df_tube_or_tracheostoma2['start2'] = df_tube_or_tracheostoma2['start'].round(0).astype(int)\n","df_tube_or_tracheostoma2['stop2'] = df_tube_or_tracheostoma2['stop'].round(0).astype(int)\n","\n","df_tube_or_tracheostoma2['measuredat2'] = df_tube_or_tracheostoma2.apply(lambda row: np.arange(row['start2'], row['stop2']+1), axis=1)\n","df_tube_or_tracheostoma2 = df_tube_or_tracheostoma2.explode('measuredat2')\n","df_tube_or_tracheostoma2 = df_tube_or_tracheostoma2[['admissionid','measuredat2', 'item']].drop_duplicates()\n","df_tube_or_tracheostoma2 = df_tube_or_tracheostoma2.groupby(['admissionid','measuredat2'])['item'].agg(sorted).apply(', '.join)\n","df_tube_or_tracheostoma2 = df_tube_or_tracheostoma2.reset_index()\n","df_tube_or_tracheostoma2['tube'] = df_tube_or_tracheostoma2.item.str.contains('Tube') & (~df_tube_or_tracheostoma2.item.str.contains('Tracheostoma') )\n","df_tube_or_tracheostoma2['tracheostoma'] = df_tube_or_tracheostoma2.item.str.contains('Tracheostoma')\n","df_tube_or_tracheostoma2['entubated'] = True\n","df_tube_or_tracheostoma2 = df_tube_or_tracheostoma2[['admissionid', 'measuredat2', 'entubated', 'tube', 'tracheostoma']].copy()\n","df_tube_or_tracheostoma2.head()"],"metadata":{"id":"hqaJnJ8QUloV","colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1686736802334,"user_tz":-120,"elapsed":38818,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"5f9f86ea-6022-4a0b-f5f0-33a8302ff6fd"},"execution_count":47,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  entubated  tube  tracheostoma\n","0            0            6       True  True         False\n","1            0            7       True  True         False\n","2            0            8       True  True         False\n","3            0            9       True  True         False\n","4            0           10       True  True         False"],"text/html":["\n","  <div id=\"df-166cdf7e-3f88-447c-9bf6-af888ef550b0\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>entubated</th>\n","      <th>tube</th>\n","      <th>tracheostoma</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>True</td>\n","      <td>True</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>True</td>\n","      <td>True</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>True</td>\n","      <td>True</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>True</td>\n","      <td>True</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>10</td>\n","      <td>True</td>\n","      <td>True</td>\n","      <td>False</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-166cdf7e-3f88-447c-9bf6-af888ef550b0')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-166cdf7e-3f88-447c-9bf6-af888ef550b0 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-166cdf7e-3f88-447c-9bf6-af888ef550b0');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":47}]},{"cell_type":"code","source":["df_iv2 = df_iv[['admissionid', 'measuredat','item', 'value']].copy()\n","# df_iv2 = df_iv2.head(1000).copy()\n","\n","df_iv2['item'] = df_iv2['item'].str.strip()\n","df_iv2['value'] = df_iv2['value'].str.strip()\n","df_iv2['measuredat2'] = df_iv2['measuredat'].round(0).astype(int)\n","df_iv2['vent_model_mode'] = df_iv2[['measuredat','item', 'value']].apply(tuple, axis=1)\n","\n","\n","df_iv2 = df_iv2.groupby(['admissionid', 'measuredat2'],as_index=False)[['item', 'value', 'vent_model_mode']].agg(lambda x:np.array(sorted(set(x))))\n","df_iv2.columns = ['admissionid', 'measuredat2', 'iv_model', 'iv_mode', 'iv_model_mode']\n","df_iv2['is_iv'] = True\n","df_iv2['iv_model'] = df_iv2['iv_model'].apply(', '.join)\n","df_iv2['iv_mode'] = df_iv2['iv_mode'].apply(', '.join)\n","# df_iv2 = df_iv2[['admissionid', 'measuredat2', 'is_iv', 'iv_model', 'iv_mode', 'iv_model_mode']].copy()\n","df_iv2 = df_iv2[['admissionid', 'measuredat2', 'is_iv', 'iv_model', 'iv_mode']].copy()\n","\n","df_iv2.head()"],"metadata":{"id":"QZ7YMC6qO1tL","colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1686736922502,"user_tz":-120,"elapsed":120175,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"390e42d4-70ae-44f5-8d6b-9bdec0023cbe"},"execution_count":48,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  is_iv               iv_model iv_mode\n","0            0            6   True  Ventilatie Mode (Set)      PC\n","1            0            7   True  Ventilatie Mode (Set)      PC\n","2            0            8   True  Ventilatie Mode (Set)      PC\n","3            0            9   True  Ventilatie Mode (Set)      PC\n","4            0           10   True  Ventilatie Mode (Set)      PC"],"text/html":["\n","  <div id=\"df-85aef14a-1be0-415c-9c02-c595edc86c53\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>is_iv</th>\n","      <th>iv_model</th>\n","      <th>iv_mode</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>True</td>\n","      <td>Ventilatie Mode (Set)</td>\n","      <td>PC</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>True</td>\n","      <td>Ventilatie Mode (Set)</td>\n","      <td>PC</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>True</td>\n","      <td>Ventilatie Mode (Set)</td>\n","      <td>PC</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>True</td>\n","      <td>Ventilatie Mode (Set)</td>\n","      <td>PC</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>10</td>\n","      <td>True</td>\n","      <td>Ventilatie Mode (Set)</td>\n","      <td>PC</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-85aef14a-1be0-415c-9c02-c595edc86c53')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-85aef14a-1be0-415c-9c02-c595edc86c53 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-85aef14a-1be0-415c-9c02-c595edc86c53');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":48}]},{"cell_type":"code","source":["def hourly_avg(df_in, column_name=None, keep_items=False, value_column = 'value'):\n","  if keep_items:\n","    df_res = df_in[['admissionid', 'measuredat',value_column,'item',]].copy()\n","    df_res.columns = ['admissionid', 'measuredat','value','item']\n","  else:\n","    df_res = df_in[['admissionid', 'measuredat',value_column,]].copy()\n","    df_res.columns = ['admissionid', 'measuredat','value']\n","\n","\n","  if not column_name and value_column:\n","    column_name = value_column\n","\n","  # df_res = df_res.head(1000).copy()\n","  if keep_items:\n","    df_res['item'] = df_res['item'].str.strip()\n","\n","  df_res['measuredat2'] = (df_res['measuredat']).round(0).astype(int)\n","  if keep_items:\n","    df_res['merged'] = df_res[['measuredat','item', 'value']].apply(tuple, axis=1)\n","\n","  if keep_items:\n","    df_res = df_res.groupby(['admissionid', 'measuredat2'],as_index=False)[['value','merged']].agg({'value': 'mean', 'merged': lambda x:np.array(sorted(set(x)))})\n","  else:\n","    df_res = df_res.groupby(['admissionid', 'measuredat2'],as_index=False)[['value']].mean()\n","\n","  if column_name:\n","    columns = ['admissionid', 'measuredat2', column_name]\n","    if keep_items:\n","      columns.append(column_name + '_items')\n","    df_res.columns = columns\n","\n","  return df_res\n","# df_rr2 = hourly_avg(df_rr, 'rr',True)\n","# df_rr2.head()"],"metadata":{"id":"6r6Al-ePalNH","executionInfo":{"status":"ok","timestamp":1686736922502,"user_tz":-120,"elapsed":6,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":49,"outputs":[]},{"cell_type":"code","source":["df_bilirubin2 = hourly_avg(df_bilirubin, 'bilirubin')\n","df_bilirubin2.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"xqzpnyCbDlDb","executionInfo":{"status":"ok","timestamp":1686736922503,"user_tz":-120,"elapsed":6,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"faf81ce6-d7f9-4629-92c1-2f528d749c56"},"execution_count":50,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  bilirubin\n","0            2          -27        7.0\n","1            4            2        8.0\n","2            4           42        7.0\n","3            5         -266        3.0\n","4            5            1        5.0"],"text/html":["\n","  <div id=\"df-dba86fd2-e640-481a-9caa-fda1307dd46e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>bilirubin</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2</td>\n","      <td>-27</td>\n","      <td>7.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>4</td>\n","      <td>2</td>\n","      <td>8.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>4</td>\n","      <td>42</td>\n","      <td>7.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>5</td>\n","      <td>-266</td>\n","      <td>3.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>1</td>\n","      <td>5.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-dba86fd2-e640-481a-9caa-fda1307dd46e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-dba86fd2-e640-481a-9caa-fda1307dd46e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-dba86fd2-e640-481a-9caa-fda1307dd46e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":50}]},{"cell_type":"code","source":["df_insp_time2 = hourly_avg(df_insp_time, 'insp_time')\n","df_insp_time2.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"918v4wqB_s2Q","executionInfo":{"status":"ok","timestamp":1686736923535,"user_tz":-120,"elapsed":1037,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"43f76745-7fd3-4c81-b9ed-8f75c7e5777f"},"execution_count":51,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  insp_time\n","0            0            6       0.23\n","1            0            7       0.23\n","2            0            8       0.23\n","3            0            9       0.23\n","4            0           10       0.23"],"text/html":["\n","  <div id=\"df-8f7a27e8-9f95-45a9-bccc-ef5177a170b6\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>insp_time</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>0.23</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>0.23</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>0.23</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>0.23</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>10</td>\n","      <td>0.23</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8f7a27e8-9f95-45a9-bccc-ef5177a170b6')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-8f7a27e8-9f95-45a9-bccc-ef5177a170b6 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-8f7a27e8-9f95-45a9-bccc-ef5177a170b6');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":51}]},{"cell_type":"code","source":["df_tidal2 = hourly_avg(df_tidal, 'tidal')\n","df_tidal2.head()"],"metadata":{"id":"9QbyR1MYgeWq","colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1686736924360,"user_tz":-120,"elapsed":828,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"1b323f87-f280-431a-c67b-86b8ba224fca"},"execution_count":52,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2   tidal\n","0            0            6  446.75\n","1            0            7  476.50\n","2            0            8  479.00\n","3            0            9  476.00\n","4            0           10  469.00"],"text/html":["\n","  <div id=\"df-9adf5aca-f790-4d36-8767-40dffa61c646\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>tidal</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>446.75</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>476.50</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>479.00</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>476.00</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>10</td>\n","      <td>469.00</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9adf5aca-f790-4d36-8767-40dffa61c646')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-9adf5aca-f790-4d36-8767-40dffa61c646 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-9adf5aca-f790-4d36-8767-40dffa61c646');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":52}]},{"cell_type":"code","source":["df_tidal[df_tidal.value > 2_000].updatedby.value_counts()\n","# set(df_tidal.updatedby)\n","# df_tidal.updatedby.value_counts()\n","df_tidal.registeredby.value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"VB6cVOkdz3fj","executionInfo":{"status":"ok","timestamp":1686736924722,"user_tz":-120,"elapsed":370,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"8c73ffa4-f8d4-46a4-ecbd-db6337ec90b8"},"execution_count":53,"outputs":[{"output_type":"execute_result","data":{"text/plain":["ICV_IC-Verpleegkundig             2558712\n","ICV_Medisch                         19180\n","ICV_Physician assistant             17261\n","ICV_MC-Verpleegkundig                4610\n","ICV_Medisch Staflid                  3222\n","ANES_Anesthesiologie                 2053\n","Uitzendkrachten                       249\n","FYS_Fysiotherapie                     170\n","NEU_Neurologie                        134\n","HLK_Heelkunde                         124\n","INW_Inwendige geneeskunde             105\n","ICV_Administratief                     77\n","HEM_Hematologie                        74\n","ICV_Coassistent                        63\n","Consulent                              63\n","Technisch                              49\n","LON_Longziekten                        20\n","NCH_Neurochirurgie                     19\n","V&G_Verloskunde & gyneacologie         14\n","ICV_Research                           12\n","SEH_Spoed eisende hulp                  8\n","PSY_Psychiatrische dienst               6\n","ICV_Familiebegeleiding                  6\n","KNF_Klinische neurofysiologie           3\n","MMI_Medische microbiologie              2\n","Name: registeredby, dtype: int64"]},"metadata":{},"execution_count":53}]},{"cell_type":"code","source":["df_minute_vol2 = hourly_avg(df_minute_vol, 'minute_vol')\n","df_minute_vol2.head()"],"metadata":{"id":"Q-xi1d33ggNU","colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1686736925461,"user_tz":-120,"elapsed":742,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"aa008d47-24fa-44a3-c6e2-a4d0256b2cb5"},"execution_count":54,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  minute_vol\n","0            0            6        5.85\n","1            0            7        6.15\n","2            0            8        6.20\n","3            0            9        6.20\n","4            0           10        6.10"],"text/html":["\n","  <div id=\"df-099462ae-8920-415b-9a8c-70c0fc310f2d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>minute_vol</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>5.85</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>6.15</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>6.20</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>6.20</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>10</td>\n","      <td>6.10</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-099462ae-8920-415b-9a8c-70c0fc310f2d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-099462ae-8920-415b-9a8c-70c0fc310f2d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-099462ae-8920-415b-9a8c-70c0fc310f2d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":54}]},{"cell_type":"code","source":["df_peep2 = df_peep.copy()\n","df_peep2.loc[df_peep2['unit'] == 'mbar', 'value'] *= 1.01972\n","df_peep2.loc[df_peep2['unit'] == 'mbar', 'unit'] = 'cmho2'\n","df_peep2 = hourly_avg(df_peep2, 'peep')\n","df_peep2.head()"],"metadata":{"id":"EoiljrTyKYr2","colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1686736926287,"user_tz":-120,"elapsed":830,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"c3c018d3-f2f3-4da8-b39b-a08894c44037"},"execution_count":55,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  peep\n","0            0            6   7.0\n","1            0            7   7.0\n","2            0            8   7.0\n","3            0            9   7.0\n","4            0           10   7.0"],"text/html":["\n","  <div id=\"df-16183ecf-1f08-4d86-8bf2-1d0b7d08dddd\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>peep</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>7.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>7.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>7.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>7.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>10</td>\n","      <td>7.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-16183ecf-1f08-4d86-8bf2-1d0b7d08dddd')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-16183ecf-1f08-4d86-8bf2-1d0b7d08dddd button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-16183ecf-1f08-4d86-8bf2-1d0b7d08dddd');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":55}]},{"cell_type":"code","source":["df_peak2 = df_peak.copy()\n","df_peak2.loc[df_peak2['unit'] == 'mbar', 'value'] *= 1.01972\n","df_peak2.loc[df_peak2['unit'] == 'mbar', 'unit'] = 'cmho2'\n","df_peak2 = hourly_avg(df_peak2, 'peak')\n","df_peak2.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"h6dA6KC65NSk","executionInfo":{"status":"ok","timestamp":1686736927539,"user_tz":-120,"elapsed":1256,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"e526cb71-2275-4b0f-9f0c-1a8241d8e622"},"execution_count":56,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  peak\n","0            0            6  19.0\n","1            0            7  19.0\n","2            0            8  19.0\n","3            0            9  19.0\n","4            0           10  19.0"],"text/html":["\n","  <div id=\"df-79e5195c-be55-4a5f-a680-4096183f0871\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>peak</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>19.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>19.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>19.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>19.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>10</td>\n","      <td>19.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-79e5195c-be55-4a5f-a680-4096183f0871')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-79e5195c-be55-4a5f-a680-4096183f0871 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-79e5195c-be55-4a5f-a680-4096183f0871');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":56}]},{"cell_type":"code","source":["df_gcs2 = df_gcs.copy()\n","df_gcs2['value'] = df_gcs2['gcs_score']\n","df_gcs2['item'] = 'gcs_score'\n","df_gcs2 = hourly_avg(df_gcs2, 'gcs')\n","df_gcs2"],"metadata":{"id":"gx80TrhWgQgv","colab":{"base_uri":"https://localhost:8080/","height":423},"executionInfo":{"status":"ok","timestamp":1686736927540,"user_tz":-120,"elapsed":7,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"cc57b20a-d233-4dbb-82ba-0f1780156b69"},"execution_count":57,"outputs":[{"output_type":"execute_result","data":{"text/plain":["       admissionid  measuredat2   gcs\n","0                0           12  15.0\n","1                1           23  15.0\n","2                2            3  15.0\n","3                2           21  15.0\n","4                4            2   3.0\n","...            ...          ...   ...\n","68674        23552           10  14.0\n","68675        23552           12  14.0\n","68676        23552           14  15.0\n","68677        23552           16  15.0\n","68678        23552           18  15.0\n","\n","[68679 rows x 3 columns]"],"text/html":["\n","  <div id=\"df-720faf7c-30d1-440b-b0c6-67f12004ccee\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>gcs</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>12</td>\n","      <td>15.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>23</td>\n","      <td>15.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>15.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2</td>\n","      <td>21</td>\n","      <td>15.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>2</td>\n","      <td>3.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>68674</th>\n","      <td>23552</td>\n","      <td>10</td>\n","      <td>14.0</td>\n","    </tr>\n","    <tr>\n","      <th>68675</th>\n","      <td>23552</td>\n","      <td>12</td>\n","      <td>14.0</td>\n","    </tr>\n","    <tr>\n","      <th>68676</th>\n","      <td>23552</td>\n","      <td>14</td>\n","      <td>15.0</td>\n","    </tr>\n","    <tr>\n","      <th>68677</th>\n","      <td>23552</td>\n","      <td>16</td>\n","      <td>15.0</td>\n","    </tr>\n","    <tr>\n","      <th>68678</th>\n","      <td>23552</td>\n","      <td>18</td>\n","      <td>15.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>68679 rows × 3 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-720faf7c-30d1-440b-b0c6-67f12004ccee')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-720faf7c-30d1-440b-b0c6-67f12004ccee button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-720faf7c-30d1-440b-b0c6-67f12004ccee');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":57}]},{"cell_type":"code","source":["df_spo2_2 = hourly_avg(df_spo2, 'spo2')\n","df_spo2_2 = df_spo2_2[df_spo2_2.spo2 <=100]\n","df_spo2_2.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"ORYsZMb7W1ry","executionInfo":{"status":"ok","timestamp":1686741707124,"user_tz":-120,"elapsed":1294,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"c19da839-a867-4904-e533-2ea488809de5"},"execution_count":114,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2   spo2\n","0            0            6   98.0\n","1            0            7  100.0\n","2            0            8  100.0\n","3            0            9   99.0\n","4            0           10   99.0"],"text/html":["\n","  <div id=\"df-186f6079-2fb6-423f-8b02-61701109bac3\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>spo2</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>98.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>100.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>100.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>99.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>10</td>\n","      <td>99.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-186f6079-2fb6-423f-8b02-61701109bac3')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-186f6079-2fb6-423f-8b02-61701109bac3 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-186f6079-2fb6-423f-8b02-61701109bac3');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":114}]},{"cell_type":"code","source":["df_insp_p2.head()"],"metadata":{"id":"-TdoeZ1FJ6zC","colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1686739582149,"user_tz":-120,"elapsed":615,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"ed1d1bbc-4cd8-4fe9-9e52-bc7cf62709f2"},"execution_count":110,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  insp_p\n","0            0            6    12.0\n","1            0            7    12.0\n","2            0            8    12.0\n","3            0            9    12.0\n","4            0           10    12.0"],"text/html":["\n","  <div id=\"df-c2788c82-788e-4407-867a-1e2126006257\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>insp_p</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>12.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>12.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>12.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>12.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>10</td>\n","      <td>12.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c2788c82-788e-4407-867a-1e2126006257')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c2788c82-788e-4407-867a-1e2126006257 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c2788c82-788e-4407-867a-1e2126006257');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":110}]},{"cell_type":"code","source":["df_map2 = hourly_avg(df_map, 'map')\n","df_map2.head()"],"metadata":{"id":"PdpmcCBVL4QD","colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1686736929779,"user_tz":-120,"elapsed":1500,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"2a2e6496-1bca-4c30-ea05-c6930d7987ca"},"execution_count":59,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2   map\n","0            0            6  75.5\n","1            0            7  75.0\n","2            0            8  70.0\n","3            0            9  73.0\n","4            0           10  81.0"],"text/html":["\n","  <div id=\"df-d0cb9d0a-20fd-4b61-a2ac-ff6afeadbb18\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>map</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>75.5</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>75.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>70.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>73.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>10</td>\n","      <td>81.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d0cb9d0a-20fd-4b61-a2ac-ff6afeadbb18')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d0cb9d0a-20fd-4b61-a2ac-ff6afeadbb18 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d0cb9d0a-20fd-4b61-a2ac-ff6afeadbb18');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":59}]},{"cell_type":"code","source":["heart_rate = df_hr.copy()\n","heart_rate.loc[(heart_rate['value'] > 300), 'value'] = np.NaN\n","heart_rate = heart_rate[~heart_rate.value.isna()]\n","heart_rate = hourly_avg(heart_rate)\n","\n","#calculate the heart rate score\n","heart_rate['a2_heart_rate_score'] = 0\n","heart_rate.loc[(heart_rate['value'] >= 180), 'a2_heart_rate_score'] = 4\n","heart_rate.loc[(heart_rate['value'] >= 140) & (heart_rate['value'] < 180), 'a2_heart_rate_score'] = 3\n","heart_rate.loc[(heart_rate['value'] >= 110) & (heart_rate['value'] < 140), 'a2_heart_rate_score'] = 2\n","heart_rate.loc[(heart_rate['value'] >= 70) & (heart_rate['value'] < 110), 'a2_heart_rate_score'] = 0\n","heart_rate.loc[(heart_rate['value'] >= 55) & (heart_rate['value'] < 70), 'a2_heart_rate_score'] = 2\n","heart_rate.loc[(heart_rate['value'] >= 40) & (heart_rate['value'] < 55), 'a2_heart_rate_score'] = 3\n","heart_rate.loc[(heart_rate['value'] < 40), 'a2_heart_rate_score'] = 4\n","\n","df_a2_heart_rate2 = heart_rate\n","df_a2_heart_rate2 = df_a2_heart_rate2.rename(columns={'value':'a2_heart_rate'})\n","del heart_rate\n","df_a2_heart_rate2.head()"],"metadata":{"id":"gpw65iEGPDU0","colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1686736931221,"user_tz":-120,"elapsed":1445,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"9025da67-f652-44d9-8115-12ca8f006f1d"},"execution_count":60,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  a2_heart_rate  a2_heart_rate_score\n","0            0            6           83.5                    0\n","1            0            7           82.0                    0\n","2            0            8           78.0                    0\n","3            0            9           73.0                    0\n","4            0           10           77.0                    0"],"text/html":["\n","  <div id=\"df-a6432ce1-4642-4e6a-829b-92fbe40716c7\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>a2_heart_rate</th>\n","      <th>a2_heart_rate_score</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>83.5</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>82.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>78.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>73.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>10</td>\n","      <td>77.0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a6432ce1-4642-4e6a-829b-92fbe40716c7')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a6432ce1-4642-4e6a-829b-92fbe40716c7 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a6432ce1-4642-4e6a-829b-92fbe40716c7');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":60}]},{"cell_type":"code","source":["df_sbp2 = hourly_avg(df_sbp, 'sbp')\n","df_sbp2.head()"],"metadata":{"id":"58Yg5nZyRkLk","colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1686736932082,"user_tz":-120,"elapsed":863,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"958ff738-531f-4b94-e378-36724c979708"},"execution_count":61,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2    sbp\n","0            0            6  112.5\n","1            0            7  112.0\n","2            0            8  106.0\n","3            0            9  115.0\n","4            0           10  123.0"],"text/html":["\n","  <div id=\"df-9efa335f-8730-40b7-80d4-c3ecd5ce7520\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>sbp</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>112.5</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>112.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>106.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>115.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>10</td>\n","      <td>123.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9efa335f-8730-40b7-80d4-c3ecd5ce7520')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-9efa335f-8730-40b7-80d4-c3ecd5ce7520 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-9efa335f-8730-40b7-80d4-c3ecd5ce7520');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":61}]},{"cell_type":"code","source":["df_dbp2 = hourly_avg(df_dbp, 'dbp')\n","df_dbp2.head()"],"metadata":{"id":"4R-pPS4JRk5v","colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1686736932922,"user_tz":-120,"elapsed":843,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"1a2976a4-086b-4315-9e6f-f912921768e5"},"execution_count":62,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2   dbp\n","0            0            6  54.0\n","1            0            7  55.0\n","2            0            8  51.0\n","3            0            9  52.0\n","4            0           10  57.0"],"text/html":["\n","  <div id=\"df-b5cce7fc-f03b-47c4-a1b4-a65112f367ee\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>dbp</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>54.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>55.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>51.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>52.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>10</td>\n","      <td>57.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b5cce7fc-f03b-47c4-a1b4-a65112f367ee')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-b5cce7fc-f03b-47c4-a1b4-a65112f367ee button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b5cce7fc-f03b-47c4-a1b4-a65112f367ee');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":62}]},{"cell_type":"code","source":["df_plt2 = hourly_avg(df_plt, 'plt')\n","df_plt2.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"LUhqDvZxzqf5","executionInfo":{"status":"ok","timestamp":1686736932923,"user_tz":-120,"elapsed":10,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"ee0c2068-a52f-447d-993b-abc4f11e98aa"},"execution_count":63,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2    plt\n","0            0         -272  259.0\n","1            0           -8  297.0\n","2            0            5  150.0\n","3            0            6  171.0\n","4            0           13  206.0"],"text/html":["\n","  <div id=\"df-95958467-334e-4938-ac2b-edbb6036a2d7\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>plt</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>-272</td>\n","      <td>259.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>-8</td>\n","      <td>297.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>5</td>\n","      <td>150.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>171.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>13</td>\n","      <td>206.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-95958467-334e-4938-ac2b-edbb6036a2d7')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-95958467-334e-4938-ac2b-edbb6036a2d7 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-95958467-334e-4938-ac2b-edbb6036a2d7');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":63}]},{"cell_type":"code","source":["temperature = df_a2_temperature.copy()\n","temperature.loc[temperature['value'] > 100, 'value'] = temperature['value']/10\n","#remove extreme outliers, most likely data entry errors or measurement errors (i.e. ambient temperature due to displaced\n","# sensor)\n","temperature.loc[(temperature['value'] > 43), 'value'] = np.NaN\n","temperature.loc[(temperature['value'] <= 30), 'value'] = np.NaN\n","temperature = temperature[~temperature.value.isna()]\n","temperature = hourly_avg(temperature)\n","\n","#calculate the temperature score\n","temperature['a2_temperature_score'] = 0\n","temperature.loc[(temperature['value'] >= 41), 'a2_temperature_score'] = 4\n","temperature.loc[(temperature['value'] >= 39) & (temperature['value'] < 41), 'a2_temperature_score'] = 3\n","temperature.loc[(temperature['value'] >= 38.5) & (temperature['value'] < 39), 'a2_temperature_score'] = 1\n","temperature.loc[(temperature['value'] >= 36) & (temperature['value'] < 38.5), 'a2_temperature_score'] = 0\n","temperature.loc[(temperature['value'] >= 34) & (temperature['value'] < 36), 'a2_temperature_score'] = 1\n","temperature.loc[(temperature['value'] >= 32) & (temperature['value'] < 34), 'a2_temperature_score'] = 2\n","temperature.loc[(temperature['value'] >= 30) & (temperature['value'] < 32), 'a2_temperature_score'] = 3\n","temperature.loc[(temperature['value'] < 30), 'a2_temperature_score'] = 4\n","\n","df_a2_temperature2 = temperature\n","df_a2_temperature2 = df_a2_temperature2.rename(columns={'value':'a2_temperature'})\n","del temperature\n","df_a2_temperature2.head()"],"metadata":{"id":"dLyPokBSYZ-5","colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1686736933965,"user_tz":-120,"elapsed":1050,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"ba424936-8bf0-49c1-bf01-cec49f0dac84"},"execution_count":64,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  a2_temperature  a2_temperature_score\n","0            0            6           35.90                     1\n","1            0            7           35.90                     1\n","2            0            8           35.65                     1\n","3            0            9           35.45                     1\n","4            0           10           35.55                     1"],"text/html":["\n","  <div id=\"df-100258d0-7e7e-470e-b27a-58f26c8b5c0c\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>a2_temperature</th>\n","      <th>a2_temperature_score</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>35.90</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>35.90</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>35.65</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>35.45</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>10</td>\n","      <td>35.55</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-100258d0-7e7e-470e-b27a-58f26c8b5c0c')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-100258d0-7e7e-470e-b27a-58f26c8b5c0c button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-100258d0-7e7e-470e-b27a-58f26c8b5c0c');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":64}]},{"cell_type":"code","source":["mean_abp  = df_a2_mean_abp.copy()\n","#remove extreme outliers, most likely data entry errors or measurement errors\n","mean_abp.loc[(mean_abp['value'] > 165), 'value'] = np.NaN\n","mean_abp.loc[(mean_abp['value'] <= 30), 'value'] = np.NaN\n","mean_abp = mean_abp[~mean_abp.value.isna()]\n","mean_abp = hourly_avg(mean_abp)\n","\n","#calculate the mean arterial pressure score\n","mean_abp['a2_mean_abp_score'] = 0\n","mean_abp.loc[(mean_abp['value'] >= 160), 'a2_mean_abp_score'] = 4\n","mean_abp.loc[(mean_abp['value'] >= 130) & (mean_abp['value'] < 160), 'a2_mean_abp_score'] = 3\n","mean_abp.loc[(mean_abp['value'] >= 110) & (mean_abp['value'] < 130), 'a2_mean_abp_score'] = 2\n","mean_abp.loc[(mean_abp['value'] >= 70) & (mean_abp['value'] < 110), 'a2_mean_abp_score'] = 0\n","mean_abp.loc[(mean_abp['value'] >= 50) & (mean_abp['value'] < 70), 'a2_mean_abp_score'] = 2\n","mean_abp.loc[(mean_abp['value'] < 50), 'a2_mean_abp_score'] = 4\n","\n","df_a2_mean_abp2 = mean_abp\n","df_a2_mean_abp2 = df_a2_mean_abp2.rename(columns={'value':'a2_mean_abp'})\n","del mean_abp\n","df_a2_mean_abp2.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"Q1o5xetg5hjK","executionInfo":{"status":"ok","timestamp":1686736936896,"user_tz":-120,"elapsed":2933,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"8a684a0a-3e5e-46cf-84c6-12ca25e94047"},"execution_count":65,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  a2_mean_abp  a2_mean_abp_score\n","0            0            6         75.5                  0\n","1            0            7         75.0                  0\n","2            0            8         70.0                  0\n","3            0            9         73.0                  0\n","4            0           10         81.0                  0"],"text/html":["\n","  <div id=\"df-0dff1b92-9551-46c1-be32-bea78e6cb22c\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>a2_mean_abp</th>\n","      <th>a2_mean_abp_score</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>75.5</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>75.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>70.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>73.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>10</td>\n","      <td>81.0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-0dff1b92-9551-46c1-be32-bea78e6cb22c')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-0dff1b92-9551-46c1-be32-bea78e6cb22c button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-0dff1b92-9551-46c1-be32-bea78e6cb22c');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":65}]},{"cell_type":"code","source":["resp_rate = df_rr.copy()\n","#remove extreme outliers, most likely data entry errors or measurement errors\n","#specifically for the Evita ventilator '0' was given in 'standby'; additionally 0 is often reported by the patient monitor\n","resp_rate.loc[resp_rate['value'] > 60, 'value'] = np.NaN\n","resp_rate.loc[resp_rate['value'] <= 0, 'value'] = np.NaN\n","resp_rate = resp_rate[~resp_rate.value.isna()]\n","resp_rate = hourly_avg(resp_rate)\n","\n","#calculate the respiratory rate score\n","resp_rate['a2_resp_rate_score'] = 0\n","resp_rate.loc[(resp_rate['value'] >= 50), 'a2_resp_rate_score'] = 4\n","resp_rate.loc[(resp_rate['value'] >= 35) & (resp_rate['value'] < 50), 'a2_resp_rate_score'] = 3\n","resp_rate.loc[(resp_rate['value'] >= 25) & (resp_rate['value'] < 35), 'a2_resp_rate_score'] = 1\n","resp_rate.loc[(resp_rate['value'] >= 12) & (resp_rate['value'] < 25), 'a2_resp_rate_score'] = 0\n","resp_rate.loc[(resp_rate['value'] >= 10) & (resp_rate['value'] < 12), 'a2_resp_rate_score'] = 1\n","resp_rate.loc[(resp_rate['value'] >= 6) & (resp_rate['value'] < 10), 'a2_resp_rate_score'] = 2\n","resp_rate.loc[(resp_rate['value'] < 6), 'a2_resp_rate_score'] = 4\n","\n","\n","df_rr2 = resp_rate\n","df_rr2 = df_rr2.rename(columns={'value':'a2_resp_rate'})\n","del resp_rate\n","df_rr2.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"A5KhhtuGCKK2","executionInfo":{"status":"ok","timestamp":1686736939218,"user_tz":-120,"elapsed":2324,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"b329fe63-e492-4fdb-ca67-a816dbdbd145"},"execution_count":66,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  a2_resp_rate  a2_resp_rate_score\n","0            0            6          13.0                   0\n","1            0            7          13.0                   0\n","2            0            8          13.0                   0\n","3            0            9          13.0                   0\n","4            0           10          13.0                   0"],"text/html":["\n","  <div id=\"df-d1b18e9a-638f-44bc-8f2e-332c7940f732\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>a2_resp_rate</th>\n","      <th>a2_resp_rate_score</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>13.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>13.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>13.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>13.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>10</td>\n","      <td>13.0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d1b18e9a-638f-44bc-8f2e-332c7940f732')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d1b18e9a-638f-44bc-8f2e-332c7940f732 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d1b18e9a-638f-44bc-8f2e-332c7940f732');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":66}]},{"cell_type":"code","source":["oxygenation = df_a2_oxygenation.copy()\n","#remove lower outliers, most likely incorrectly labeled as 'arterial' instead of '(mixed/central) venous'\n","oxygenation.loc[oxygenation['PaO2'] < 50, 'PaO2'] = np.NaN\n","oxygenation = oxygenation.dropna(subset=['PaO2'])\n","#drop row without PaCO2 measurement - probably temporary measurement error\n","oxygenation = oxygenation.dropna(subset=['PaCO2'])\n","#remove outliers, but only when manually entered, since labs are considered accurate\n","oxygenation.loc[(oxygenation['PaCO2'] > 100) & (oxygenation['manual_entry'] == True), 'PaCO2'] = np.NaN\n","oxygenation.loc[(oxygenation['PaCO2'] < 15) & (oxygenation['manual_entry'] == True), 'PaCO2'] = np.NaN\n","oxygenation = oxygenation.dropna(subset=['PaCO2'])\n","\n","#remove impossible FiO2 outliers (i.e. > 100% or <21%)\n","oxygenation.loc[(oxygenation['FiO2'] > 100), 'FiO2'] = np.NaN\n","oxygenation.loc[(oxygenation['FiO2'] < 20), 'FiO2'] = np.NaN\n","\n","# The equation for calculating the A–aDO2 gradient is:\n","# https://en.wikipedia.org/wiki/Alveolar%E2%80%93arterial_gradient\n","\n","\n","temp_oxygenation = []\n","for col in ['PaO2', 'PaCO2', 'FiO2']:\n","  temp_oxygenation.append(hourly_avg(oxygenation, value_column=col).set_index(['admissionid', 'measuredat2']))\n","oxygenation = pd.concat(temp_oxygenation,axis=1).reset_index()\n","del temp_oxygenation\n","\n","#Patm = 760 mmHg, PH2O = 47 mmHg\n","oxygenation['AaDO2'] = ((oxygenation['FiO2'] / 100) * (760 - 47) - (oxygenation['PaCO2']/ 0.8)) - oxygenation['PaO2']\n","\n","\n","#calculate the oxygenation score\n","oxygenation['a2_oxygenation_score'] = 0\n","oxygenation.loc[(oxygenation['FiO2'] > 50) & (oxygenation['AaDO2'] >= 500), 'a2_oxygenation_score'] = 4\n","oxygenation.loc[(oxygenation['FiO2'] > 50) & (oxygenation['AaDO2'] >= 350) & (oxygenation['AaDO2'] < 500), 'a2_oxygenation_score'] = 3\n","oxygenation.loc[(oxygenation['FiO2'] > 50) & (oxygenation['AaDO2'] >= 200) & (oxygenation['AaDO2'] < 350), 'a2_oxygenation_score'] = 2\n","oxygenation.loc[(oxygenation['FiO2'] > 50) & (oxygenation['AaDO2'] < 200), 'a2_oxygenation_score'] = 0\n","oxygenation.loc[((oxygenation['FiO2'] < 50) | (oxygenation['FiO2'].isna())) & (oxygenation['PaO2'] > 70), 'a2_oxygenation_score'] = 0\n","oxygenation.loc[((oxygenation['FiO2'] < 50) | (oxygenation['FiO2'].isna())) & (oxygenation['PaO2'] > 60) & (oxygenation['PaO2'] <= 70), 'a2_oxygenation_score'] = 1\n","oxygenation.loc[((oxygenation['FiO2'] < 50) | (oxygenation['FiO2'].isna())) & (oxygenation['PaO2'] >= 55) & (oxygenation['PaO2'] <= 60), 'a2_oxygenation_score'] = 3\n","oxygenation.loc[((oxygenation['FiO2'] < 50) | (oxygenation['FiO2'].isna())) & (oxygenation['PaO2'] < 55), 'a2_oxygenation_score'] = 4\n","oxygenation = oxygenation.sort_values(['admissionid', 'measuredat2'])\n","\n","\n","df_a2_oxygenation2 = oxygenation\n","del oxygenation\n","df_a2_oxygenation2.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"qy-t3DnxNT1R","executionInfo":{"status":"ok","timestamp":1686736941127,"user_tz":-120,"elapsed":1911,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"31c76070-e5f8-4d73-fea1-772737c79c60"},"execution_count":67,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2   PaO2  PaCO2  FiO2   AaDO2  a2_oxygenation_score\n","0            0         -272   71.0   41.0   NaN     NaN                     0\n","1            0            6   90.0   39.0  50.0  217.75                     0\n","2            0            7  149.0   37.0  51.0  168.38                     0\n","3            0            9  104.0   36.0  41.0  143.33                     0\n","4            0           12  105.0   37.0  41.0  141.08                     0"],"text/html":["\n","  <div id=\"df-d8904a20-e569-4a78-8b0a-fec184280daf\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>PaO2</th>\n","      <th>PaCO2</th>\n","      <th>FiO2</th>\n","      <th>AaDO2</th>\n","      <th>a2_oxygenation_score</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>-272</td>\n","      <td>71.0</td>\n","      <td>41.0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>90.0</td>\n","      <td>39.0</td>\n","      <td>50.0</td>\n","      <td>217.75</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>149.0</td>\n","      <td>37.0</td>\n","      <td>51.0</td>\n","      <td>168.38</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>104.0</td>\n","      <td>36.0</td>\n","      <td>41.0</td>\n","      <td>143.33</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>12</td>\n","      <td>105.0</td>\n","      <td>37.0</td>\n","      <td>41.0</td>\n","      <td>141.08</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d8904a20-e569-4a78-8b0a-fec184280daf')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d8904a20-e569-4a78-8b0a-fec184280daf button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d8904a20-e569-4a78-8b0a-fec184280daf');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":67}]},{"cell_type":"code","source":["pH = df_a2_ph.copy()\n","#remove extreme outliers, most likely data entry errors (manual_entry = True)\n","pH.loc[(pH['value'] < 6.8) & (pH['manual_entry'] == True), 'value'] = np.NaN\n","pH.loc[(pH['value'] > 7.6) & (pH['manual_entry'] == True), 'value'] = np.NaN\n","pH = pH.dropna(subset=['value'])\n","\n","pH = hourly_avg(pH)\n","\n","\n","#calculate the pH score\n","pH['a2_pH_score'] = 0\n","pH.loc[(pH['value'] >= 7.7), 'a2_pH_score'] = 4\n","pH.loc[(pH['value'] >= 7.6) & (pH['value'] < 7.7), 'a2_pH_score'] = 3\n","pH.loc[(pH['value'] >= 7.5) & (pH['value'] < 7.6), 'a2_pH_score'] = 1\n","pH.loc[(pH['value'] >= 7.33) & (pH['value'] < 7.5), 'a2_pH_score'] = 0\n","pH.loc[(pH['value'] >= 7.25) & (pH['value'] < 7.33), 'a2_pH_score'] = 2\n","pH.loc[(pH['value'] >= 7.15) & (pH['value'] < 7.25), 'a2_pH_score'] = 3\n","pH.loc[(pH['value'] < 7.15), 'a2_pH_score'] = 4\n","\n","\n","df_a2_ph2 = pH\n","df_a2_ph2 = df_a2_ph2.rename(columns={'value':'a2_pH'})\n","del pH\n","df_a2_ph2.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"zFOd_3SqNTW6","executionInfo":{"status":"ok","timestamp":1686736941541,"user_tz":-120,"elapsed":416,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"02aaf3e1-dd21-4504-be60-b550573e51ba"},"execution_count":68,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  a2_pH  a2_pH_score\n","0            0         -272   7.45            0\n","1            0            6   7.40            0\n","2            0            7   7.40            0\n","3            0            9   7.39            0\n","4            0           12   7.41            0"],"text/html":["\n","  <div id=\"df-5fe700de-22da-48bb-b69f-e8298b0820a1\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>a2_pH</th>\n","      <th>a2_pH_score</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>-272</td>\n","      <td>7.45</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>7.40</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>7.40</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>9</td>\n","      <td>7.39</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>12</td>\n","      <td>7.41</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5fe700de-22da-48bb-b69f-e8298b0820a1')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-5fe700de-22da-48bb-b69f-e8298b0820a1 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-5fe700de-22da-48bb-b69f-e8298b0820a1');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":68}]},{"cell_type":"code","source":["sodium = df_a2_sodium.copy()\n","#remove extreme outliers, most likely data entry errors (manual_entry = True)\n","#remove extreme outliers, most likely data entry errors (manual_entry = True)\n","sodium.loc[(sodium['value'] > 165) & (sodium['manual_entry'] == True), 'value'] = np.NaN\n","sodium.loc[(sodium['value'] < 95) & (sodium['manual_entry'] == True), 'value'] = np.NaN\n","sodium = sodium.dropna(subset=['value'])\n","\n","\n","sodium = hourly_avg(sodium)\n","\n","\n","#calculate the sodium score\n","sodium['a2_sodium_score'] = 0\n","sodium.loc[(sodium['value'] >= 180), 'a2_sodium_score'] = 4\n","sodium.loc[(sodium['value'] >= 160) & (sodium['value'] < 180), 'a2_sodium_score'] = 3\n","sodium.loc[(sodium['value'] >= 155) & (sodium['value'] < 160), 'a2_sodium_score'] = 2\n","sodium.loc[(sodium['value'] >= 150) & (sodium['value'] < 155), 'a2_sodium_score'] = 1\n","sodium.loc[(sodium['value'] >= 130) & (sodium['value'] < 150), 'a2_sodium_score'] = 0\n","sodium.loc[(sodium['value'] >= 120) & (sodium['value'] < 130), 'a2_sodium_score'] = 2\n","sodium.loc[(sodium['value'] > 111) & (sodium['value'] < 120), 'a2_sodium_score'] = 3\n","sodium.loc[(sodium['value'] <= 110), 'a2_sodium_score'] = 4\n","\n","df_a2_sodium2 = sodium\n","df_a2_sodium2 = df_a2_sodium2.rename(columns={'value':'a2_sodium'})\n","del sodium\n","df_a2_sodium2.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"_7gBOpx1PrCd","executionInfo":{"status":"ok","timestamp":1686736941778,"user_tz":-120,"elapsed":241,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"b85811bb-253d-4a93-ea62-094c8a63194d"},"execution_count":69,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  a2_sodium  a2_sodium_score\n","0            0         -272      142.0                0\n","1            0         -250      138.0                0\n","2            0         -130      141.0                0\n","3            0           -8      143.0                0\n","4            0            6      143.0                0"],"text/html":["\n","  <div id=\"df-ae5b9d1a-3d07-4ccd-94b3-f87d374337bf\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>a2_sodium</th>\n","      <th>a2_sodium_score</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>-272</td>\n","      <td>142.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>-250</td>\n","      <td>138.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>-130</td>\n","      <td>141.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>-8</td>\n","      <td>143.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>143.0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ae5b9d1a-3d07-4ccd-94b3-f87d374337bf')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-ae5b9d1a-3d07-4ccd-94b3-f87d374337bf button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-ae5b9d1a-3d07-4ccd-94b3-f87d374337bf');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":69}]},{"cell_type":"code","source":["potassium = df_a2_potassium.copy()\n","#remove extreme outliers, most likely data entry errors (manual_entry = True)\n","potassium.loc[(potassium['value'] > 8) & (potassium['manual_entry'] == True), 'value'] = np.NaN\n","potassium.loc[(potassium['value'] < 2) & (potassium['manual_entry'] == True), 'value'] = np.NaN\n","potassium.loc[(potassium['value'] <= 2.2) & (potassium['manual_entry'] == False), 'value'] = np.NaN\n","potassium.loc[(potassium['value'] > 10) & (potassium['manual_entry'] == False), 'value'] = np.NaN\n","potassium = potassium.dropna(subset=['value'])\n","\n","potassium = hourly_avg(potassium)\n","\n","\n","#calculate the potassium score\n","potassium['a2_potassium_score'] = 0\n","potassium.loc[(potassium['value'] >= 7), 'a2_potassium_score'] = 4\n","potassium.loc[(potassium['value'] >= 6) & (potassium['value'] < 7), 'a2_potassium_score'] = 3\n","potassium.loc[(potassium['value'] >= 5.5) & (potassium['value'] < 6), 'a2_potassium_score'] = 1\n","potassium.loc[(potassium['value'] >= 3.5) & (potassium['value'] < 5.5), 'a2_potassium_score'] = 0\n","potassium.loc[(potassium['value'] >= 3) & (potassium['value'] < 3.5), 'a2_potassium_score'] = 1\n","potassium.loc[(potassium['value'] >= 2.5) & (potassium['value'] < 3), 'a2_potassium_score'] = 2\n","potassium.loc[(potassium['value'] < 2.5), 'a2_potassium_score'] = 4\n","\n","\n","df_a2_potassium2 = potassium\n","df_a2_potassium2 = df_a2_potassium2.rename(columns={'value':'a2_potassium'})\n","del potassium\n","df_a2_potassium2.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"ZuWK3ZXUQNlC","executionInfo":{"status":"ok","timestamp":1686736942382,"user_tz":-120,"elapsed":607,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"4ee1b81f-8a7a-488e-efc8-9efabac8ef86"},"execution_count":70,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  a2_potassium  a2_potassium_score\n","0            0         -272          4.10                   0\n","1            0         -250          3.80                   0\n","2            0         -130          4.30                   0\n","3            0           -8          3.90                   0\n","4            0            6          4.55                   0"],"text/html":["\n","  <div id=\"df-59edef31-c96c-4d5f-ae32-1c6064ad2fec\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>a2_potassium</th>\n","      <th>a2_potassium_score</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>-272</td>\n","      <td>4.10</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>-250</td>\n","      <td>3.80</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>-130</td>\n","      <td>4.30</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>-8</td>\n","      <td>3.90</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>4.55</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-59edef31-c96c-4d5f-ae32-1c6064ad2fec')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-59edef31-c96c-4d5f-ae32-1c6064ad2fec button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-59edef31-c96c-4d5f-ae32-1c6064ad2fec');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":70}]},{"cell_type":"code","source":["creatinine = df_a2_creatinine.copy()\n","#remove extreme outliers, most likely data entry errors (manual_entry = True)\n","creatinine.loc[(creatinine['value'] < 30) & (creatinine['manual_entry'] == True), 'value'] = np.NaN\n","creatinine = creatinine.dropna(subset=['value'])\n","\n","#conversion umol/l to mg/dl\n","#creatinine molar mass: 113.120 g·mol−1\n","creatinine['value_non_si'] = (creatinine['value']/10e6)*(10e3/10)*113.120\n","creatinine.head()\n","acute_renal_failure_adm_ids = creatinine[creatinine['acute_renal_failure']]['admissionid'].unique()\n","\n","creatinine = hourly_avg(creatinine, 'value_non_si')\n","\n","\n","#calculate the creatinine score\n","\n","#if acute renal failure (AKI definition), double the points\n","creatinine['score_multiplier'] = 1\n","creatinine.loc[creatinine.admissionid.isin(acute_renal_failure_adm_ids), 'score_multiplier'] = 2\n","\n","creatinine['a2_creatinine_score'] = 0\n","creatinine.loc[(creatinine['value_non_si'] >= 3.5), 'a2_creatinine_score'] = 4 * creatinine['score_multiplier']\n","creatinine.loc[(creatinine['value_non_si'] >= 2) & (creatinine['value_non_si'] < 3.5), 'a2_creatinine_score'] = 3 * creatinine['score_multiplier']\n","creatinine.loc[(creatinine['value_non_si'] >= 1.5) & (creatinine['value_non_si'] < 2), 'a2_creatinine_score'] = 2 * creatinine['score_multiplier']\n","creatinine.loc[(creatinine['value_non_si'] >= 0.6) & (creatinine['value_non_si'] < 1.5), 'a2_creatinine_score'] = 0\n","creatinine.loc[(creatinine['value_non_si'] < 0.6), 'a2_creatinine_score'] = 2 * creatinine['score_multiplier']\n","\n","\n","df_a2_creatinine2 = creatinine\n","df_a2_creatinine2 = df_a2_creatinine2.rename(columns={'value_non_si':'a2_creatinine_mg_per_dl'})\n","df_a2_creatinine2 = df_a2_creatinine2.drop(columns='score_multiplier')\n","del creatinine\n","df_a2_creatinine2.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"2DBPzb1nQNni","executionInfo":{"status":"ok","timestamp":1686736942945,"user_tz":-120,"elapsed":566,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"0196b73d-c636-4c8a-a9a5-ae0b4a07a819"},"execution_count":71,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  a2_creatinine_mg_per_dl  a2_creatinine_score\n","0            0         -272                     94.0                    4\n","1            0         -250                     86.0                    4\n","2            0         -130                     94.0                    4\n","3            0           -8                     88.0                    4\n","4            0            6                     86.0                    4"],"text/html":["\n","  <div id=\"df-2d077374-3280-48bb-849c-f2852fbbe1c7\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>a2_creatinine_mg_per_dl</th>\n","      <th>a2_creatinine_score</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>-272</td>\n","      <td>94.0</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>-250</td>\n","      <td>86.0</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>-130</td>\n","      <td>94.0</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>-8</td>\n","      <td>88.0</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>86.0</td>\n","      <td>4</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2d077374-3280-48bb-849c-f2852fbbe1c7')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-2d077374-3280-48bb-849c-f2852fbbe1c7 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-2d077374-3280-48bb-849c-f2852fbbe1c7');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":71}]},{"cell_type":"code","source":["ht = df_a2_ht.copy()\n","\n","#manually entered values in (0-100%) % instead of fraction (0-1)\n","ht.loc[(ht['value'] > 1) & (ht['manual_entry'] == True), 'value'] = ht.loc[\n","    (ht['value'] > 1) & (ht['manual_entry'] == True), 'value']/100\n","#remove extreme outliers, most likely sample collection error (near transfusion site)\n","ht.loc[(ht['value'] < .1), 'value'] = np.NaN\n","ht.loc[(ht['value'] > .67), 'value'] = np.NaN\n","ht = ht.dropna(subset=['value'])\n","\n","\n","ht = hourly_avg(ht)\n","\n","\n","#calculate the hematocrit score\n","ht['a2_ht_score'] = 0\n","ht.loc[(ht['value'] >= 0.60), 'a2_ht_score'] = 4\n","ht.loc[(ht['value'] >= 0.50) & (ht['value'] < 0.60), 'a2_ht_score'] = 2\n","ht.loc[(ht['value'] >= 0.46) & (ht['value'] < 0.50), 'a2_ht_score'] = 1\n","ht.loc[(ht['value'] >= 0.30) & (ht['value'] < 0.46), 'a2_ht_score'] = 0\n","ht.loc[(ht['value'] >= 0.20) & (ht['value'] < 0.30), 'a2_ht_score'] = 2\n","ht.loc[(ht['value'] < 0.20), 'a2_ht_score'] = 4\n","\n","df_a2_ht2 = ht\n","df_a2_ht2 = df_a2_ht2.rename(columns={'value':'a2_ht'})\n","del ht\n","df_a2_ht2.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"mr-r-HKHXUiZ","executionInfo":{"status":"ok","timestamp":1686736943623,"user_tz":-120,"elapsed":684,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"a51696f3-ee95-4d5f-e3b2-c9c4a875869f"},"execution_count":72,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  a2_ht  a2_ht_score\n","0            0         -272   0.40            0\n","1            0         -250   0.36            0\n","2            0         -130   0.39            0\n","3            0           -8   0.39            0\n","4            0            6   0.23            2"],"text/html":["\n","  <div id=\"df-015d1861-93f1-4af7-82b5-baa3cd1aa154\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>a2_ht</th>\n","      <th>a2_ht_score</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>-272</td>\n","      <td>0.40</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>-250</td>\n","      <td>0.36</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>-130</td>\n","      <td>0.39</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>-8</td>\n","      <td>0.39</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>0.23</td>\n","      <td>2</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-015d1861-93f1-4af7-82b5-baa3cd1aa154')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-015d1861-93f1-4af7-82b5-baa3cd1aa154 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-015d1861-93f1-4af7-82b5-baa3cd1aa154');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":72}]},{"cell_type":"code","source":["wbc = df_a2_wbc.copy()\n","\n","#separator error: e.g. 117 > 11.7\n","wbc.loc[(wbc['value'] > 70) & (wbc['manual_entry'] == True), 'value'] = wbc.loc[\n","    (wbc['value'] > 70) & (wbc['manual_entry'] == True), 'value']/10\n","\n","wbc = hourly_avg(wbc)\n","\n","#calculate the WBC score\n","wbc['a2_wbc_score'] = 0\n","wbc.loc[(wbc['value'] >= 40), 'a2_wbc_score'] = 4\n","wbc.loc[(wbc['value'] >= 20) & (wbc['value'] < 40), 'a2_wbc_score'] = 2\n","wbc.loc[(wbc['value'] >= 15) & (wbc['value'] < 20), 'a2_wbc_score'] = 1\n","wbc.loc[(wbc['value'] >= 3) & (wbc['value'] < 15), 'a2_wbc_score'] = 0\n","wbc.loc[(wbc['value'] >= 1) & (wbc['value'] < 3), 'a2_wbc_score'] = 2\n","wbc.loc[(wbc['value'] < 1), 'a2_wbc_score'] = 4\n","\n","\n","\n","df_a2_wbc2 = wbc\n","df_a2_wbc2 = df_a2_wbc2.rename(columns={'value':'a2_ht'})\n","del wbc\n","df_a2_wbc2.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"IC5BAtb4XUpL","executionInfo":{"status":"ok","timestamp":1686736943624,"user_tz":-120,"elapsed":243,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"da428dfe-4c8e-4932-a7df-93076cf6c76e"},"execution_count":73,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  a2_ht  a2_wbc_score\n","0            0         -272    7.4             0\n","1            0         -130    7.8             0\n","2            0           -8    6.5             0\n","3            0            6   14.6             0\n","4            0           36   13.5             0"],"text/html":["\n","  <div id=\"df-e0a3c391-759e-43cb-89ea-a319329dad5e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>a2_ht</th>\n","      <th>a2_wbc_score</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>-272</td>\n","      <td>7.4</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>-130</td>\n","      <td>7.8</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>-8</td>\n","      <td>6.5</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>14.6</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>36</td>\n","      <td>13.5</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e0a3c391-759e-43cb-89ea-a319329dad5e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-e0a3c391-759e-43cb-89ea-a319329dad5e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-e0a3c391-759e-43cb-89ea-a319329dad5e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":73}]},{"cell_type":"markdown","source":["# bookmark3"],"metadata":{"id":"TpLczcN8PANS"}},{"cell_type":"code","source":["gcs = df_a2_gcs.copy()\n","\n","gcs['gcs'] = gcs['gcs_score']\n","\n","gcs = hourly_avg(gcs, value_column='gcs')\n","\n","gcs['a2_gcs_score'] = 15 - gcs['gcs']\n","\n","\n","df_a2_gcs2 = gcs\n","# df_gcs2 = df_gcs2.rename(columns={'value':'a2_ht'})\n","del gcs\n","df_a2_gcs2.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"J9ZYyAHVtN8_","executionInfo":{"status":"ok","timestamp":1686736943625,"user_tz":-120,"elapsed":243,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"583ed596-4d0c-4745-a059-d47a2cc6b2fa"},"execution_count":74,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2   gcs  a2_gcs_score\n","0            0           12  15.0           0.0\n","1            1           23  15.0           0.0\n","2            2           21  15.0           0.0\n","3            4          940  15.0           0.0\n","4            5          881  15.0           0.0"],"text/html":["\n","  <div id=\"df-761a4f33-f0b2-49a7-9f51-0591100e8e14\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>gcs</th>\n","      <th>a2_gcs_score</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>12</td>\n","      <td>15.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>23</td>\n","      <td>15.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>21</td>\n","      <td>15.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>940</td>\n","      <td>15.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>881</td>\n","      <td>15.0</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-761a4f33-f0b2-49a7-9f51-0591100e8e14')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-761a4f33-f0b2-49a7-9f51-0591100e8e14 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-761a4f33-f0b2-49a7-9f51-0591100e8e14');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":74}]},{"cell_type":"code","source":["admissions=df_admissions.copy()\n","#calculate the age score\n","admissions['a2_age_score'] = 0\n","\n","#since whe are using generalized ages in the database, it doesn't perfectly with the APACHE groups, so use an average\n","#of the definitions in APACHE II\n","admissions.loc[(admissions['agegroup'] == '80+'), 'a2_age_score'] = 6\n","admissions.loc[(admissions['agegroup'] == '70-79'), 'a2_age_score'] = (5+6)/2\n","admissions.loc[(admissions['agegroup'] == '60-69'), 'a2_age_score'] = (3+5)/2\n","admissions.loc[(admissions['agegroup'] == '50-59'), 'a2_age_score'] = (2+3)/2\n","admissions.loc[(admissions['agegroup'] == '40-49'), 'a2_age_score'] = (0+2)/2\n","admissions.loc[(admissions['agegroup'] == '18-39'), 'a2_age_score'] = 0\n","\n","# admissions"],"metadata":{"id":"9WLqiXbsujWz","executionInfo":{"status":"ok","timestamp":1686736943625,"user_tz":-120,"elapsed":240,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":75,"outputs":[]},{"cell_type":"code","source":["[x for x in globals() if x.startswith(\"df_\") and x.endswith(\"2\") and sum(['score' in y for y in globals()[x]] ) ]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"1aFBBGKNXUcz","executionInfo":{"status":"ok","timestamp":1686736943626,"user_tz":-120,"elapsed":240,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"fcb16bc2-bb71-4b55-b2db-0b35acd290c8"},"execution_count":76,"outputs":[{"output_type":"execute_result","data":{"text/plain":["['df_a2_heart_rate2',\n"," 'df_a2_temperature2',\n"," 'df_a2_mean_abp2',\n"," 'df_rr2',\n"," 'df_a2_oxygenation2',\n"," 'df_a2_ph2',\n"," 'df_a2_sodium2',\n"," 'df_a2_potassium2',\n"," 'df_a2_creatinine2',\n"," 'df_a2_ht2',\n"," 'df_a2_wbc2',\n"," 'df_a2_gcs2']"]},"metadata":{},"execution_count":76}]},{"cell_type":"code","source":[],"metadata":{"id":"a5BOWwH4Gw-T","executionInfo":{"status":"ok","timestamp":1686736943627,"user_tz":-120,"elapsed":31,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":76,"outputs":[]},{"cell_type":"code","source":["df_gcs2 = df_gcs2.dropna()\n","df_gcs2['gcs'] = df_gcs2['gcs'].round(0).astype(int)\n","df_gcs2.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":336},"id":"lFdKwJcZG0vi","executionInfo":{"status":"ok","timestamp":1686736943628,"user_tz":-120,"elapsed":31,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"13349783-3508-4264-8f1b-5e0845c80312"},"execution_count":77,"outputs":[{"output_type":"stream","name":"stderr","text":["<ipython-input-77-f340b3734cd8>:2: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  df_gcs2['gcs'] = df_gcs2['gcs'].round(0).astype(int)\n"]},{"output_type":"execute_result","data":{"text/plain":["   admissionid  measuredat2  gcs\n","0            0           12   15\n","1            1           23   15\n","2            2            3   15\n","3            2           21   15\n","4            4            2    3"],"text/html":["\n","  <div id=\"df-9be76b33-25e5-42cb-9121-bdb5efe6b16b\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>admissionid</th>\n","      <th>measuredat2</th>\n","      <th>gcs</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>12</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>23</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2</td>\n","      <td>21</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>2</td>\n","      <td>3</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9be76b33-25e5-42cb-9121-bdb5efe6b16b')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-9be76b33-25e5-42cb-9121-bdb5efe6b16b button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-9be76b33-25e5-42cb-9121-bdb5efe6b16b');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":77}]},{"cell_type":"code","source":["import functools\n","dfs = [df_iv2, df_tube_or_tracheostoma2,\n","       df_rr2,df_tidal2,df_minute_vol2, df_peep2, df_peak2,\n","       df_insp_p2, df_map2,\n","       df_sbp2, df_dbp2,df_plt2, df_bilirubin2,df_gcs2,\n","       df_insp_time2, df_spo2_2\n","       ]\n","\n","dfs_apache = [df_a2_heart_rate2, df_a2_temperature2, df_a2_mean_abp2,\n","          df_a2_oxygenation2, df_a2_ph2, df_a2_sodium2,\n","          df_a2_potassium2,df_a2_creatinine2 ,df_a2_ht2]\n","dfs +=dfs_apache\n","\n","df_final = functools.reduce(lambda left, right: pd.merge(left, right, how='outer', on=['admissionid','measuredat2']), tqdm(dfs))\n","df_final=df_final.sort_values(['admissionid', 'measuredat2'])\n","print(df_final.shape)\n","\n","df_final = df_final[[x for x in df_final.columns if not x.endswith('_score')]]\n","\n","df_final.info()"],"metadata":{"id":"PGxBetIMKOz6","executionInfo":{"status":"ok","timestamp":1686741778200,"user_tz":-120,"elapsed":66219,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"3a8b3d2c-e51f-41f1-ad56-85c929f934bf"},"execution_count":115,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 25/25 [01:02<00:00,  2.51s/it]\n"]},{"output_type":"stream","name":"stdout","text":["(2510131, 44)\n","<class 'pandas.core.frame.DataFrame'>\n","Int64Index: 2510131 entries, 2344340 to 2410522\n","Data columns (total 34 columns):\n"," #   Column                   Dtype  \n","---  ------                   -----  \n"," 0   admissionid              Int64  \n"," 1   measuredat2              int64  \n"," 2   is_iv                    object \n"," 3   iv_model                 object \n"," 4   iv_mode                  object \n"," 5   entubated                object \n"," 6   tube                     object \n"," 7   tracheostoma             object \n"," 8   a2_resp_rate             float64\n"," 9   tidal                    float64\n"," 10  minute_vol               float64\n"," 11  peep                     float64\n"," 12  peak                     float64\n"," 13  insp_p                   float64\n"," 14  map                      float64\n"," 15  sbp                      float64\n"," 16  dbp                      float64\n"," 17  plt                      float64\n"," 18  bilirubin                float64\n"," 19  gcs                      float64\n"," 20  insp_time                float64\n"," 21  spo2                     float64\n"," 22  a2_heart_rate            float64\n"," 23  a2_temperature           float64\n"," 24  a2_mean_abp              float64\n"," 25  PaO2                     float64\n"," 26  PaCO2                    float64\n"," 27  FiO2                     float64\n"," 28  AaDO2                    float64\n"," 29  a2_pH                    float64\n"," 30  a2_sodium                float64\n"," 31  a2_potassium             float64\n"," 32  a2_creatinine_mg_per_dl  float64\n"," 33  a2_ht                    float64\n","dtypes: Int64(1), float64(26), int64(1), object(6)\n","memory usage: 672.7+ MB\n"]}]},{"cell_type":"code","source":["STOP"],"metadata":{"id":"vDs-Nnq-IdQu","colab":{"base_uri":"https://localhost:8080/","height":172},"executionInfo":{"status":"error","timestamp":1686737247714,"user_tz":-120,"elapsed":231,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"02c25f30-c132-4c82-f087-24722a842a22"},"execution_count":88,"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-88-ee4decdca3b8>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mSTOP\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;31mNameError\u001b[0m: name 'STOP' is not defined"]}]},{"cell_type":"code","source":["df_final[df_final.is_iv ==True]['spo2'].shape\n","\n","# 1- 1253103 /1300222"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"kPhDnsjOZOJH","executionInfo":{"status":"ok","timestamp":1686741939672,"user_tz":-120,"elapsed":2240,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}},"outputId":"81a0eead-8c6f-42fd-9d52-e93f24ff5403"},"execution_count":126,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1300222,)"]},"metadata":{},"execution_count":126}]},{"cell_type":"code","source":["# !cat drive/MyDrive/datathon23/sql_scripts/*.sql | grep"],"metadata":{"id":"BMF3S2PVRfmA","executionInfo":{"status":"aborted","timestamp":1686737007711,"user_tz":-120,"elapsed":21,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["iv_entubated_admissionids = df_final[df_final.is_iv & df_final.entubated].admissionid.unique()\n","df_final_iv_entubated = df_final[df_final.admissionid.isin(iv_entubated_admissionids)]\n","\n","df_final_iv_entubated.to_csv(f\"{output_directory}/curr_final_v6.csv\", index=None)\n","\n","df_final_iv_entubated.head(10_000).to_csv(f\"{output_directory}/curr_final_v6_10000_lines.csv\", index=None)\n","\n"],"metadata":{"id":"wUMcYkX1MgNT","executionInfo":{"status":"ok","timestamp":1686741823006,"user_tz":-120,"elapsed":44816,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":116,"outputs":[]},{"cell_type":"code","source":["df_final_iv_entubated.describe().T"],"metadata":{"id":"pZCBSvwfPgyl","executionInfo":{"status":"aborted","timestamp":1686737007712,"user_tz":-120,"elapsed":21,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_peak = get_items(\n","    sql = \"\"\"SELECT  admissionid, count(*)\n","FROM `amsterdamumcdb.version1_0_2.numericitems`\n","WHERE itemid = 12281\n","GROUP BY admissionid\"\"\",\n","    # pickle_file = f'{pickles_directory}/a2_gcs.pickle',\n",")"],"metadata":{"id":"ErVPheF4bUWa","executionInfo":{"status":"aborted","timestamp":1686737007712,"user_tz":-120,"elapsed":21,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_flow = get_items(\n","    sql = \"\"\"SELECT  admissionid, count(*)\n","FROM `amsterdamumcdb.version1_0_2.numericitems`\n","WHERE itemid = 8849\n","GROUP BY admissionid\"\"\",\n","    # pickle_file = f'{pickles_directory}/a2_gcs.pickle',\n",")"],"metadata":{"id":"uj1RIUzrsYtL","executionInfo":{"status":"aborted","timestamp":1686737007712,"user_tz":-120,"elapsed":21,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_final_iv_entubated.admissionid.drop_duplicates().shape"],"metadata":{"id":"EkV4DGlrquI8","executionInfo":{"status":"aborted","timestamp":1686737007712,"user_tz":-120,"elapsed":21,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["len(set(df_peak.admissionid).intersection(df_final_iv_entubated.admissionid))"],"metadata":{"id":"c_OND-HlpJoM","executionInfo":{"status":"aborted","timestamp":1686737007713,"user_tz":-120,"elapsed":22,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["len(set(df_flow.admissionid).intersection(df_final_iv_entubated.admissionid))"],"metadata":{"id":"TcX1duVIseMg","executionInfo":{"status":"aborted","timestamp":1686737007713,"user_tz":-120,"elapsed":22,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["STOP"],"metadata":{"id":"mp45ADbQNLTb","executionInfo":{"status":"aborted","timestamp":1686737007713,"user_tz":-120,"elapsed":22,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# STOP"],"metadata":{"id":"bUH4nqm-ZPXo"}},{"cell_type":"code","source":[],"metadata":{"id":"LEOSh8MeZOuA","executionInfo":{"status":"aborted","timestamp":1686737007713,"user_tz":-120,"elapsed":22,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_admissions"],"metadata":{"id":"Bt6TOPZ6NLYX","executionInfo":{"status":"aborted","timestamp":1686737007714,"user_tz":-120,"elapsed":22,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# ! cp drive/MyDrive/datathon23/numericitems.csv numericitems.csv\n","! cp drive/MyDrive/datathon23/admission.pkl admission.pkl\n","import pandas as pd\n","from tqdm import tqdm\n","import pickle"],"metadata":{"id":"GlaPkVOEBaAK","executionInfo":{"status":"aborted","timestamp":1686737007714,"user_tz":-120,"elapsed":22,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# datathon_directory = 'drive/MyDrive/datathon23'\n","pickle_file = f'admission.pkl'\n","df_admissions = pickle.load(open(pickle_file, 'rb'))#.sort_values('admissionid').reset_index(drop=True)\n","df_admissions.columns"],"metadata":{"id":"rFI_SRmREqAI","executionInfo":{"status":"aborted","timestamp":1686737007714,"user_tz":-120,"elapsed":22,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_admissions.weightgroup.unique()"],"metadata":{"id":"Nftu4US4Ef4_","executionInfo":{"status":"aborted","timestamp":1686737007715,"user_tz":-120,"elapsed":23,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["len(set(df_admissions[df_admissions.weightgroup.isna()].admissionid).intersection(asd.admissionid))"],"metadata":{"id":"TGo7ZiukFarB","executionInfo":{"status":"aborted","timestamp":1686737007715,"user_tz":-120,"elapsed":23,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# asd = pd.concat([df.query('itemid == 10439') for df in tqdm(pd.read_csv(f'{datathon_directory}/numericitems.csv', chunksize=5_000_000))])\n","# ! cp drive/MyDrive/datathon23/numericitems.csv numericitems.csv\n","asd = pd.concat([df[df.itemid.isin({12285, 12286})][['admissionid', 'itemid', 'value']] for df in tqdm(pd.read_csv(f'numericitems.csv', chunksize=1_000_000,), total=69)])\n","sum([df[df.itemid.isin({12285, 12286})].shape for df in tqdm(pd.read_csv(f'numericitems.csv', chunksize=1_000_000,), total=69)])\n","asd"],"metadata":{"id":"yhuyjofy-nzl","executionInfo":{"status":"aborted","timestamp":1686737007715,"user_tz":-120,"elapsed":23,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"sNDQGKKjII8t","executionInfo":{"status":"aborted","timestamp":1686737007716,"user_tz":-120,"elapsed":23,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(df_iv.shape)\n","print(df_tube_or_tracheostoma.shape, df_tube_or_tracheostoma2.shape, )\n","\n","print(df_final.shape)\n","\n","\n","asd = df_final[df_final.is_iv & df_final.entubated]\n","print(asd.admissionid.unique().shape)\n","\n","print(asd.shape)\n","\n","asd.head()"],"metadata":{"id":"87O9ngHoGkn2","executionInfo":{"status":"aborted","timestamp":1686737007716,"user_tz":-120,"elapsed":23,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"D9l8k8GurbBs","executionInfo":{"status":"aborted","timestamp":1686737007716,"user_tz":-120,"elapsed":23,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"qIl_5SS3ViT2","executionInfo":{"status":"aborted","timestamp":1686737007717,"user_tz":-120,"elapsed":24,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["STOP"],"metadata":{"id":"6Iixit1SAwdF","executionInfo":{"status":"aborted","timestamp":1686737007717,"user_tz":-120,"elapsed":24,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_admissions"],"metadata":{"id":"3gv-vsT-g0dU","executionInfo":{"status":"aborted","timestamp":1686737007717,"user_tz":-120,"elapsed":24,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"48OABLFqg0iV","executionInfo":{"status":"aborted","timestamp":1686737007717,"user_tz":-120,"elapsed":23,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["STOP"],"metadata":{"id":"M6Jl81ctalHj","executionInfo":{"status":"aborted","timestamp":1686737007718,"user_tz":-120,"elapsed":24,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"7VlUluJzalEs","executionInfo":{"status":"aborted","timestamp":1686737007718,"user_tz":-120,"elapsed":24,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"DtoSRJpjLuOS","executionInfo":{"status":"aborted","timestamp":1686737007718,"user_tz":-120,"elapsed":24,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_tube_or_tracheostoma[df_tube_or_tracheostoma.admissionid == 8838]"],"metadata":{"id":"vFFLsu2WCEj5","executionInfo":{"status":"aborted","timestamp":1686737007719,"user_tz":-120,"elapsed":25,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_iv[df_iv.admissionid == 8838]\n"],"metadata":{"id":"EdTvAzuT7ti6","executionInfo":{"status":"aborted","timestamp":1686737007720,"user_tz":-120,"elapsed":26,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Ug8dDEE8eqD9","executionInfo":{"status":"aborted","timestamp":1686737007720,"user_tz":-120,"elapsed":26,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["def check_dupplicates(df):\n","  df2 = df[['admissionid', 'measuredat', 'item', 'value']].copy()\n","  print(df2.shape[0], 'Orig size',)\n","  df2 = df2.drop_duplicates()\n","  print(df2.shape[0], \"DISTINCT ['admissionid', 'measuredat', 'item', 'value'] size\")\n","\n","  df3 = df2[['admissionid', 'measuredat', 'value']]\n","  df3 = df3.drop_duplicates()\n","  print(df3.shape[0], \"DISTINCT ['admissionid', 'measuredat', 'value'] size\")\n","\n","  df4 = df3[['admissionid', 'measuredat', 'value']]\n","  df4 = df4.drop_duplicates()\n","  print(df4.shape[0], \"DISTINCT ['admissionid', 'measuredat'] size\")\n","\n","  asd = df3.groupby(['admissionid', 'measuredat'])['value'].count()\n","  asd = asd[asd>1]\n","  asd = asd.reset_index()[['admissionid', 'measuredat']]\n","  print(asd.shape[0], '# of dupplicated elements')\n","  asd = pd.merge(asd, df2)\n","  asd = asd.sort_values(list(asd.columns)).reset_index(drop=True)\n","  print(asd.groupby(['admissionid', 'measuredat'])['item'].apply(sorted).apply(tuple).value_counts())\n","  # print(asd.groupby(['admissionid', 'measuredat'])['value'].apply(sorted).apply(tuple).value_counts())\n","  return asd\n","\n","check_dupplicates(df_iv).head()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_JKQL-byi8Q2","executionInfo":{"status":"aborted","timestamp":1686737007721,"user_tz":-120,"elapsed":26,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["xxx=check_dupplicates(df_peep)\n","# pd.merge(df_iv, xxx, on = ['admissionid','measuredat']).item_x.value_counts()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sV59gPGbmZR4","executionInfo":{"status":"aborted","timestamp":1686737007721,"user_tz":-120,"elapsed":26,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["check_dupplicates(df_rr)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"af0gh_4vmgDd","executionInfo":{"status":"aborted","timestamp":1686737007722,"user_tz":-120,"elapsed":27,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["check_dupplicates(df_tidal)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ySlkL0m_oZkk","executionInfo":{"status":"aborted","timestamp":1686737007722,"user_tz":-120,"elapsed":27,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["pd.DataFrame(df_iv.groupby('item')['value'].apply(set))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Yn8dNIVAnLbC","executionInfo":{"status":"aborted","timestamp":1686737007722,"user_tz":-120,"elapsed":27,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["df_iv[['item','value']].drop_duplicates().sort_values(['item','value']).set_index('item')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IpIv24ubvkQP","executionInfo":{"status":"aborted","timestamp":1686737007723,"user_tz":-120,"elapsed":28,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["STOP"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PkrE58ifuVxK","executionInfo":{"status":"aborted","timestamp":1686737007723,"user_tz":-120,"elapsed":28,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["# def calculate_max_vent_days(df_adm):\n","#   days = sorted(set(df_adm.measuredat//24))\n","\n","#   # find max continues ventilation days\n","#   my_list = days\n","#   brks = [i for i in range(1,len(my_list)) if my_list[i] != my_list[i-1]+1]\n","#   my_lists = [my_list[x:y] for x,y in zip([0]+brks,brks+[None])]\n","#   max_days = max([max(l) - min(l) + 1 for l in my_lists])\n","#   return max_days\n","# max_continious_vent_days = df_iv.groupby('admissionid').apply(calculate_max_vent_days)\n","# max_continious_vent_days"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hau8b8jWuWIG","executionInfo":{"status":"aborted","timestamp":1686737007724,"user_tz":-120,"elapsed":28,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["for x in [0,1,2,3,3,4,5,6,7,14,21,30]:\n","  print(f'more than {x} day(s)', (max_continious_vent_days>x).sum())"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"B2od5KtCw4d5","executionInfo":{"status":"aborted","timestamp":1686737007725,"user_tz":-120,"elapsed":29,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["max_continious_vent_days.describe()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"x4kKrxdntemU","executionInfo":{"status":"aborted","timestamp":1686737007726,"user_tz":-120,"elapsed":30,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["STOP"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xPHvu73ZteZw","executionInfo":{"status":"aborted","timestamp":1686737007726,"user_tz":-120,"elapsed":30,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cqnh_PDjteP-","executionInfo":{"status":"aborted","timestamp":1686737007726,"user_tz":-120,"elapsed":30,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"lC4ePUnTteID","executionInfo":{"status":"aborted","timestamp":1686737007727,"user_tz":-120,"elapsed":31,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"A2hAaOiLiebg","executionInfo":{"status":"aborted","timestamp":1686737007727,"user_tz":-120,"elapsed":31,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["pickle_file = f'{datathon_directory}/numericitems.pkl'\n","# df_numericitems = pickle.load(open(pickle_file, 'rb')).sort_values('admissionid').reset_index(drop=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FSZcFo66ieO5","executionInfo":{"status":"aborted","timestamp":1686737007728,"user_tz":-120,"elapsed":32,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["import pandas as pd\n","from tqdm import tqdm"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GONiS3i5ieJ3","executionInfo":{"status":"aborted","timestamp":1686737007728,"user_tz":-120,"elapsed":32,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["asd = pd.concat([df.query('itemid == 8852') for df in tqdm(pd.read_csv(f'{datathon_directory}/numericitems.csv', chunksize=5_000_000))])\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"McadCR8Aa1qO","executionInfo":{"status":"aborted","timestamp":1686737007728,"user_tz":-120,"elapsed":31,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["[df.query('itemid IN (\"8852\")') for df in tqdm(pd.read_csv(f'{datathon_directory}/numericitems.csv', chunksize=5_000_000))]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"UXcJclkvgwNG","executionInfo":{"status":"aborted","timestamp":1686737007728,"user_tz":-120,"elapsed":31,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["# !ls drive/MyDrive/datathon23/numericitems.csv\n","!nohup rsync -av drive/MyDrive/datathon23/numericitems.csv ./"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cEUbmyO2gwQG","executionInfo":{"status":"aborted","timestamp":1686737007729,"user_tz":-120,"elapsed":32,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["!ls"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4wsIJzedIu9j","executionInfo":{"status":"aborted","timestamp":1686737007729,"user_tz":-120,"elapsed":32,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":["asd = adb.get_dictionary()\n","asd[asd.item.str.contains('(?<!PA.)(?<!PBE.|PD1.|PFD.|TMP.|Edi.)(?<!Flow.)(?:peak|piek|max)', flags=re.IGNORECASE)]\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Ws00-bHrIvC9","executionInfo":{"status":"aborted","timestamp":1686737007729,"user_tz":-120,"elapsed":32,"user":{"displayName":"Arif Canakoglu","userId":"14185220478826657705"}}},"outputs":[],"source":[]}],"metadata":{"colab":{"provenance":[{"file_id":"https://github.com/AmsterdamUMC/AmsterdamUMCdb/blob/master/bigquery/getting_started.ipynb","timestamp":1684330739943}],"collapsed_sections":["SEy03x8UOheM","bYQa-iWgOnZp"]},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.4"}},"nbformat":4,"nbformat_minor":0}